{"version":3,"sources":["node_modules/tslib/tslib.es6.js","ng://@igo2/common/lib/entity/shared/entity.enums.ts","ng://@igo2/common/lib/entity/shared/entity.utils.ts","ng://@igo2/common/lib/entity/shared/state.ts","ng://@igo2/common/lib/entity/shared/view.ts","ng://@igo2/common/lib/entity/shared/store.ts","ng://@igo2/common/lib/entity/shared/watcher.ts","ng://@igo2/common/lib/entity/shared/transaction.ts","ng://@igo2/common/lib/entity/entity-selector/entity-selector.component.ts","ng://@igo2/common/lib/entity/entity-table/entity-table.component.ts","ng://@igo2/common/lib/action/shared/action.enums.ts","ng://@igo2/common/lib/action/actionbar/actionbar.component.ts","ng://@igo2/common/lib/action/actionbar/actionbar-item.component.ts","ng://@igo2/common/lib/action/actionbar/actionbar.module.ts","ng://@igo2/common/lib/action/action.module.ts","ng://@igo2/common/lib/backdrop/backdrop.component.ts","ng://@igo2/common/lib/backdrop/backdrop.module.ts","ng://@igo2/common/lib/clickout/clickout.directive.ts","ng://@igo2/common/lib/clickout/clickout.module.ts","ng://@igo2/common/lib/clone/clone.pipe.ts","ng://@igo2/common/lib/clone/clone.module.ts","ng://@igo2/common/lib/collapsible/collapse.directive.ts","ng://@igo2/common/lib/collapsible/collapsible.component.ts","ng://@igo2/common/lib/collapsible/collapsible.module.ts","ng://@igo2/common/lib/confirm-dialog/confirm-dialog.component.ts","ng://@igo2/common/lib/confirm-dialog/confirm-dialog.service.ts","ng://@igo2/common/lib/confirm-dialog/confirm-dialog.module.ts","ng://@igo2/common/lib/context-menu/context-menu.directive.ts","ng://@igo2/common/lib/context-menu/context-menu.module.ts","ng://@igo2/common/lib/custom-html/custom-html.component.ts","ng://@igo2/common/lib/custom-html/custom-html.pipe.ts","ng://@igo2/common/lib/custom-html/custom-html.module.ts","ng://@igo2/common/lib/drag-drop/drag-drop.directive.ts","ng://@igo2/common/lib/drag-drop/drag-drop.module.ts","ng://@igo2/common/lib/dynamic-component/shared/dynamic-component.ts","ng://@igo2/common/lib/dynamic-component/shared/dynamic-component.service.ts","ng://@igo2/common/lib/dynamic-component/dynamic-outlet/dynamic-outlet.component.ts","ng://@igo2/common/lib/dynamic-component/dynamic-outlet/dynamic-outlet.module.ts","ng://@igo2/common/lib/dynamic-component/dynamic-component.module.ts","ng://@igo2/common/lib/flexible/flexible.component.ts","ng://@igo2/common/lib/flexible/flexible.module.ts","ng://@igo2/common/lib/form/shared/form.utils.ts","ng://@igo2/common/lib/form/form/form.component.ts","ng://@igo2/common/lib/form/form/form.module.ts","ng://@igo2/common/lib/form/shared/form-field.service.ts","ng://@igo2/common/lib/form/shared/form.service.ts","ng://@igo2/common/lib/form/shared/form-field-component.ts","ng://@igo2/common/lib/form/form-field/form-field.component.ts","ng://@igo2/common/lib/form/form-field/form-field-select.component.ts","ng://@igo2/common/lib/form/form-field/form-field-text.component.ts","ng://@igo2/common/lib/form/form-field/form-field-textarea.component.ts","ng://@igo2/common/lib/form/form-field/form-field.module.ts","ng://@igo2/common/lib/form/form-group/form-group.component.ts","ng://@igo2/common/lib/form/form-group/form-group.module.ts","ng://@igo2/common/lib/form/form.module.ts","ng://@igo2/common/lib/entity/entity-selector/entity-selector.module.ts","ng://@igo2/common/lib/stop-propagation/stop-drop-propagation.directive.ts","ng://@igo2/common/lib/stop-propagation/stop-propagation.directive.ts","ng://@igo2/common/lib/stop-propagation/stop-propagation.module.ts","ng://@igo2/common/lib/entity/entity-table/entity-table-row.directive.ts","ng://@igo2/common/lib/entity/entity-table/entity-table.module.ts","ng://@igo2/common/lib/entity/entity.module.ts","ng://@igo2/common/lib/image/secure-image.pipe.ts","ng://@igo2/common/lib/image/image.module.ts","ng://@igo2/common/lib/keyvalue/keyvalue.pipe.ts","ng://@igo2/common/lib/keyvalue/keyvalue.module.ts","ng://@igo2/common/lib/json-dialog/json-dialog.component.ts","ng://@igo2/common/lib/json-dialog/json-dialog.service.ts","ng://@igo2/common/lib/json-dialog/json-dialog.module.ts","ng://@igo2/common/lib/list/list-item.directive.ts","ng://@igo2/common/lib/list/list.component.ts","ng://@igo2/common/lib/list/list.module.ts","ng://@igo2/common/lib/panel/panel.component.ts","ng://@igo2/common/lib/panel/panel.module.ts","ng://@igo2/common/lib/sidenav/sidenav-shim.directive.ts","ng://@igo2/common/lib/sidenav/sidenav.module.ts","ng://@igo2/common/lib/spinner/spinner.component.ts","ng://@igo2/common/lib/spinner/spinner-activity.directive.ts","ng://@igo2/common/lib/spinner/spinner.module.ts","ng://@igo2/common/lib/table/table-datasource.ts","ng://@igo2/common/lib/table/table-action-color.enum.ts","ng://@igo2/common/lib/table/table.component.ts","ng://@igo2/common/lib/table/table.module.ts","ng://@igo2/common/lib/tool/shared/tool.service.ts","ng://@igo2/common/lib/action/shared/store.ts","ng://@igo2/common/lib/tool/toolbox/toolbox.animation.ts","ng://@igo2/common/lib/tool/toolbox/toolbox.component.ts","ng://@igo2/common/lib/tool/toolbox/toolbox.module.ts","ng://@igo2/common/lib/tool/tool.module.ts","ng://@igo2/common/lib/widget/widget-outlet/widget-outlet.component.ts","ng://@igo2/common/lib/widget/widget-outlet/widget-outlet.module.ts","ng://@igo2/common/lib/widget/shared/widget.service.ts","ng://@igo2/common/lib/widget/widget.module.ts","ng://@igo2/common/lib/workspace/workspace-selector/workspace-selector.component.ts","ng://@igo2/common/lib/workspace/workspace-selector/workspace-selector.module.ts","ng://@igo2/common/lib/workspace/workspace-widget-outlet/workspace-widget-outlet.component.ts","ng://@igo2/common/lib/workspace/workspace-widget-outlet/workspace-widget-outlet.module.ts","ng://@igo2/common/lib/workspace/workspace.module.ts","ng://@igo2/common/lib/table/table-database.ts","ng://@igo2/common/lib/tool/shared/toolbox.ts","ng://@igo2/common/lib/widget/shared/widget.ts","ng://@igo2/common/lib/workspace/shared/store.ts","ng://@igo2/common/lib/workspace/shared/workspace.ts","ng://@igo2/common/lib/tool/shared/tool-component.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__values","o","m","Symbol","iterator","call","next","value","done","__read","n","e","ar","push","error","__spread","concat","Insert","Update","Delete","Default","HTML","UnsanitizedHTML","Icon","ButtonGroup","Auto","Instant","Smooth","None","All","Some","getEntityProperty","entity","property","t","safeObject","getEntityId","meta","id","idProperty","getEntityTitle","title","titleProperty","EntityStateManager","options","index","Map","change$","ReplaySubject","store","undefined","getKey","clear","size","get","set","state","setMany","entities","_this","forEach","assign","setAll","from","keys","update","changes","exclusive","updateMany","updateManyExclusive","reverse","reverseMany","currentState","reduce","acc","reversedChanges","reverseChanges","updateAll","allKeys","getAllKeys","map","Set","indexOf","entries","bunch","_a","changeKey","storeKeys","EntityView","source$","values$","BehaviorSubject","lifted","joins","filter$","sort$","count$","empty$","all","all$","firstBy","clause","find","firstBy$","pipe","values","manyBy","filter","manyBy$","sort","destroy","values$$","unsubscribe","join","Error","lift","liftJoinedSource","liftSource","combineLatest","skip","debounceTime","subscribe","_values","processValues","setValues","sources$","apply","source","joinData","computeJoinedValue","joinIndex","slice","filterValues","sortValues","v1","v2","ObjectUtils","naturalCompare","valueAccessor","direction","count","empty","EntityStore","entities$","_pristine","getProperty","view","stateView","load","_index","generateIndex","pristine","softClear","updateCount","insert","insertMany","delete","deleteMany","EntityStoreWatcher","cdRef","innerStateIndex","setChangeDetector","setStore","teardownObservers","setupObservers","detectChanges","entities$$","onEntitiesChange","state$$","onStateChange","changesDetected","storeIndex","innerIndex","storeKeys_1","tslib_1.__values","storeKeys_1_1","storeValue","innerValue","objectsAreEquivalent","EntityTransaction","_inCommitPhase","operations","operation","current","existingOperation","getOperationByEntity","removeOperation","doInsert","previous","type","EntityOperationType","doUpdate","doDelete","commit","handler","catchError","of","tap","result","onCommitError","onCommitSuccess","commitAll","getOperationsInCommit","rollback","rollbackOperations","checkInCommitPhase","storesOperations","operations_1","operations_1_1","storeOperations","deletes","_delete","updates","_update","inserts","_insert","mergeTransaction","transaction","addOperation","resolveOperations","added","inCommitPhase","EntitySelectorComponent","selected$","multiText$","multiSelectValue","titleAccessor","emptyText","multi","multiAllText","multiNoneText","selectedChange","EventEmitter","ngOnInit","watcher","selected$$","record","selected","records","onSelectFromStore","ngOnDestroy","onSelectionChange","event","multiSelect","_value","emit","updateMultiToggleWithEntities","Component","args","selector","template","changeDetection","ChangeDetectionStrategy","OnPush","ChangeDetectorRef","Input","Output","EntityTableComponent","entityTableColumnRenderer","EntityTableColumnRenderer","entityTableSelectionState","EntityTableSelectionState","selectionState$","scrollBehavior","EntityTableScrollBehavior","entityClick","entitySelectChange","columns","column","visible","name","selectionCheckbox","selection","selectMany","fixedHeader","selection$$","computeSelectionState","ngOnChanges","currentValue","previousValue","refresh","onSort","active","getValue","onRowClick","onRowSelect","onToggleRows","toggle","onToggleRow","selectedRecords","states","selectionCount","columnIsSortable","sortable","rowIsSelected","getColumnRenderer","renderer","getTableClass","igo-entity-table-with-selection","getHeaderClass","func","headerClassFunc","Function","getRowClass","rowClassFunc","getCellClass","cls","tableFunc","cellClassFunc","columnFunc","onButtonClick","clickFunc","Dock","Overlay","Context","ActionbarComponent","overlay","actionbarMode","ActionbarMode","collapsed","toggleCollapseAction","icon","mode","withToggleButton","horizontal","color","withTitle","withIcon","xPosition","yPosition","_overlayClass","itemClassFunc","defaultItemClassFunc","action","onTriggerAction","HostBinding","ActionbarItemComponent","disabled","trigger","tooltip","onClick","IgoActionbarModule","NgModule","imports","CommonModule","IgoLanguageModule","MatButtonModule","MatIconModule","MatTooltipModule","MatMenuModule","MatListModule","MatCardModule","exports","declarations","IgoActionModule","providers","BackdropComponent","_shown","IgoBackdropModule","forRoot","ngModule","ClickoutDirective","el","clickout","handleMouseClick","nativeElement","contains","Directive","ElementRef","HostListener","IgoClickoutModule","ClonePipe","transform","obj","Pipe","IgoCloneModule","CollapseDirective","_collapsed","_target","collapseTarget","expandTarget","click","addClass","removeClass","Renderer2","CollapsibleComponent","_title","IgoCollapsibleModule","ConfirmDialogComponent","dialogRef","MatDialogRef","ConfirmDialogService","dialog","open","message","disableClose","componentInstance","confirmMessage","afterClosed","Injectable","MatDialog","IgoConfirmDialogModule","MatDialogModule","entryComponents","ContextMenuDirective","viewContainerRef","elementRef","menuPosition","onContextMenu","x","y","close","preventDefault","overlayRef","positionStrategy","position","flexibleConnectedTo","withPositions","originX","originY","overlayX","overlayY","scrollStrategy","scrollStrategies","attach","TemplatePortal","menuContext","$implicit","sub","fromEvent","document","clickTarget","overlayElement","take","dispose","ViewContainerRef","IgoContextMenuModule","CustomHtmlComponent","_html","SanitizeHtmlPipe","_sanitizer","v","bypassSecurityTrustHtml","DomSanitizer","IgoCustomHtmlModule","MatInputModule","DragAndDropDirective","allowedExtensions","filesDropped","filesInvalid","background","onDragOver","evt","stopPropagation","onDragLeave","onDrop","filesObj","validExtensions","valid","invalid","files","dataTransfer","files_1","files_1_1","file","ext","split","lastIndexOf","IgoDrapDropModule","DynamicComponent","componentFactory","subscriptions","inputs","subscribers","setTarget","componentRef","createComponent","updateInputs","updateSubscribers","unsubscribeAll","instance","propName","onUpdateInputs","outputs","emitter_1","subscriber","isArray","_subscriber","s","DynamicComponentService","resolver","componentCls","factory","resolveComponentFactory","providedIn","ComponentFactoryResolver","DynamicOutletComponent","dynamicComponentService","component","eq","inputsAreEquivalents","subscribersAreEquivalents","dynamicComponent","renderComponent","ViewChild","read","IgoDynamicOutletModule","IgoDynamicComponentModule","FlexibleComponent","mediaService","_initial","_expanded","_initialMobile","expanded","_collapsedMobile","_expandedMobile","_direction","_state","sizes","initial","media$","initialMobile","collapsedMobile","expandedMobile","setSize","setTimeout","transitionTime","className","media","main","style","height","width","MediaService","IgoFlexibleModule","formControlIsRequired","control","validator","required","controls","getDefaultErrorMessages","getControlErrorMessage","messages","errors","errorMessages","getAllFormFields","form","groups","group","fields","FormComponent","submitForm","buttons","children","formData","setData","onSubmit","getData","data","field","setValue","updateDataWithFormField","reset","IgoFormFormModule","FormsModule","ReactiveFormsModule","FormFieldService","register","getFieldByType","FormService","formBuilder","addControl","config","setValidators","extendFieldConfig","partial","FormBuilder","FormFieldComponent","compType","FormFieldComponent$1","FormFieldComponent$$1","formFieldService","fieldOptions","placeholder","disableSwitch","formControl","FormFieldSelectComponent","disabled$","Observable","choices$","getErrorMessage","onDisableSwitchClick","toggleDisabled","disable","enable","FormFieldTextComponent","FormFieldTextareaComponent","IgoFormFieldModule","MatFormFieldModule","MatSelectModule","FormGroupComponent","getFieldColSpan","colSpan","cols","Math","min","getFieldNgClass","IgoFormGroupModule","IgoFormModule","IgoEntitySelectorModule","StopDropPropagationDirective","StopPropagationDirective","IgoStopPropagationModule","EntityTableRowDirective","selectOnClick","highlightSelection","_selected","select","toggleSelected","scroll","addCls","selectedCls","highlightedCls","removeCls","scrollIntoView","behavior","block","inline","IgoEntityTableModule","MatTableModule","MatSortModule","MatCheckboxModule","IgoEntityModule","SecureImagePipe","http","url","headers","activityInterceptor","responseType","switchMap","blob","observer","reader","FileReader","readAsDataURL","onloadend","HttpClient","IgoImageModule","KeyValuePipe","keyValues","getOwnPropertyNames","IgoKeyValueModule","JsonDialogComponent","isObject","val","baseKey","JsonDialogService","ignoreKeys","IgoJsonDialogModule","ListItemDirective","_color","_focused","_disabled","beforeSelect","beforeFocus","beforeUnselect","beforeUnfocus","beforeDisable","beforeEnable","focus","unfocus","unselect","toggleSelectedClass","toggleDisabledClass","getOffsetTop","offsetTop","focused","disabledCls","ListComponent","_navigation","_selection","_selectedItem","focusedItem","_focusedItem","handleKeyboardEvent","navigationEnabled","keyCode","navigate","enableNavigation","ngAfterViewInit","listItems","init","listItems$$","items","item","focusNext","toArray","getFocusedIndex","focusPrevious","selectedItem","navigation","disableNavigation","scrollToItem","scrollTop","findSelectedItem","findFocusedItem","item2","handleItemBeforeSelect","handleItemSelect","handleItemBeforeFocus","handleItemFocus","findIndex","ContentChildren","descendants","IgoListModule","PanelComponent","_withHeader","IgoPanelModule","SidenavShimDirective","onOpen","focusedElement","onCloseStart","blurElement","onClose","selectRootElement","blur","MatSidenav","Self","IgoSidenavModule","SpinnerComponent","shown$","show","shown","hide","SpinnerActivityDirective","spinner","activityService","counter$$","counter$","ActivityService","IgoSpinnerModule","MatProgressSpinnerModule","TableDataSource","_database","_model","_sort","_super","_filterChange","tslib_1.__extends","connect","merge","displayDataChanges","dataChange","sortChange","getFilteredData","getSortedData","disconnect","filterable","resolve","toLowerCase","a","propertyA","propertyB","DataSource","primary","accent","warn","TableComponent","_hasFIlterInput","SelectionModel","dataSource","database","model","displayedColumns","displayed","unshift","actions","changed","distinctUntilChanged","change","getActionColor","colorId","TableActionColor","row","isAllSelected","masterToggle","handleClickAction","MatSort","IgoTableModule","CdkTableModule","ToolService","tool","tools","getTool","getTools","ActionStore","updateActionsAvailability","availables","unavailables","conditions","conditionArgs","every","condition","toolSlideInOut","speed","transition","animate","ToolboxComponent","activeTool$","actionStore","animation$","toolbar$","animating$","toolbar$$","toolbox","toolbar","onToolbarChange","activeTool$$","onActiveToolChange","onAnimationStart","onAnimationComplete","getToolInputs","tool-actived","setToolbar","onAnimate","setActiveTool","toolName","_tool","_toolbox","activateTool","callback","unAnimate","animating$$","animation","animations","IgoToolboxModule","IgoToolModule","WidgetOutletComponent","baseSubscribers","cancel","onCancel","complete","onComplete","destroyWidget","getEffectiveSubscribers","baseSubscriber","widget","IgoWidgetOutletModule","WidgetService","widgetCls","IgoWidgetModule","WorkspaceSelectorComponent","getWorkspaceTitle","workspace","onSelectedChange","activateWorkspace","IgoWorkspaceSelectorModule","WorkspaceWidgetOutletComponent","deactivateWidget","widget$","widgetInputs$","widgetSubscribers$","onWidgetCancel","onWidgetComplete","IgoWorkspaceWidgetOutletModule","IgoWorkspaceModule","TableDatabase","add","copiedData","remove","splice","Toolbox","activeToolHistory","initStore","setTools","activatePreviousTool","deactivateTool","clearActiveToolHistory","Widget","WorkspaceStore","activeWorkspace$","deactivate","deactivateWorkspace","activate","Workspace","Subject","isActive","entityStore","activateWidget","titleHtml","titleHtmlProperty","iconProperty","revision"],"mappings":"ouCAgBA,IAAIA,EAAgB,SAASC,EAAGC,GAI5B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,MACpDN,EAAGC,IAG5B,SAAgBO,EAAUR,EAAGC,GAEzB,SAASQ,IAAOC,KAAKC,YAAcX,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEY,UAAkB,OAANX,EAAaC,OAAOW,OAAOZ,IAAMQ,EAAGG,UAAYX,EAAEW,UAAW,IAAIH,GAGnF,SAqBgBK,EAAWC,EAAYC,EAAQC,EAAKC,GAChD,IAA2HlB,EAAvHmB,EAAIC,UAAUC,OAAQC,EAAIH,EAAI,EAAIH,EAAkB,OAATE,EAAgBA,EAAOhB,OAAOqB,yBAAyBP,EAAQC,GAAOC,EACrH,GAAuB,iBAAZM,SAAoD,mBAArBA,QAAQC,SAAyBH,EAAIE,QAAQC,SAASV,EAAYC,EAAQC,EAAKC,QACpH,IAAK,IAAIQ,EAAIX,EAAWM,OAAS,EAAQ,GAALK,EAAQA,KAAS1B,EAAIe,EAAWW,MAAIJ,GAAKH,EAAI,EAAInB,EAAEsB,GAAS,EAAJH,EAAQnB,EAAEgB,EAAQC,EAAKK,GAAKtB,EAAEgB,EAAQC,KAASK,GAChJ,OAAW,EAAJH,GAASG,GAAKpB,OAAOyB,eAAeX,EAAQC,EAAKK,GAAIA,EAGhE,SAiDgBM,EAASC,GACrB,IAAIC,EAAsB,mBAAXC,QAAyBF,EAAEE,OAAOC,UAAWN,EAAI,EAChE,OAAII,EAAUA,EAAEG,KAAKJ,GACd,CACHK,KAAM,WAEF,OADIL,GAAKH,GAAKG,EAAER,SAAQQ,OAAI,GACrB,CAAEM,MAAON,GAAKA,EAAEH,KAAMU,MAAOP,KAKhD,SAAgBQ,EAAOR,EAAGS,GACtB,IAAIR,EAAsB,mBAAXC,QAAyBF,EAAEE,OAAOC,UACjD,IAAKF,EAAG,OAAOD,EACf,IAAmBP,EAAYiB,EAA3Bb,EAAII,EAAEG,KAAKJ,GAAOW,EAAK,GAC3B,IACI,WAAc,IAANF,GAAsB,EAANA,QAAchB,EAAII,EAAEQ,QAAQE,MAAMI,EAAGC,KAAKnB,EAAEa,OAExE,MAAOO,GAASH,EAAI,CAAEG,MAAOA,WAEzB,IACQpB,IAAMA,EAAEc,OAASN,EAAIJ,EAAU,YAAII,EAAEG,KAAKP,WAExC,GAAIa,EAAG,MAAMA,EAAEG,OAE7B,OAAOF,EAGX,SAAgBG,IACZ,IAAK,IAAIH,EAAK,GAAId,EAAI,EAAGA,EAAIN,UAAUC,OAAQK,IAC3Cc,EAAKA,EAAGI,OAAOP,EAAOjB,UAAUM,KACpC,OAAOc,SCxITK,OAAS,SACTC,OAAS,SACTC,OAAS,aAITC,QAAU,UACVC,KAAO,OACPC,gBAAkB,kBAClBC,KAAO,OACPC,YAAc,kBAIdC,KAAO,OACPC,QAAU,UACVC,OAAS,aAITC,KAAO,OACPC,IAAM,MACNC,KAAO,QCRT,SAAgBC,EAAkBC,EAAgBC,GAChD,OAAOC,EAAEF,EAAQC,GAAUE,WAW7B,SAAgBC,EAAYJ,OACpBK,EAAO,EAAgBA,MAAQ,GACrC,OAAOA,EAAKC,GAAKD,EAAKC,GAAKP,EAAkBC,EAAQK,EAAKE,YAAc,MAS1E,SAAgBC,EAAeR,OACvBK,EAAO,EAAgBA,MAAQ,GACrC,OAAOA,EAAKI,MAAQJ,EAAKI,MAAQV,EAAkBC,EAAQK,EAAKK,eAAiB,SC/BnF,iBAmBE,SAAAC,EAAYC,QAAA,IAAAA,IAAAA,EAAA,IAdH9D,KAAA+D,MAAQ,IAAIC,IAKZhE,KAAAiE,QAAU,IAAIC,EAAAA,cAAoB,GAUzClE,KAAKmE,MAAQL,EAAQK,MAAQL,EAAQK,MAAQC,UAC7CpE,KAAKqE,OAASP,EAAQO,OAClBP,EAAQO,OACPrE,KAAKmE,MAAQnE,KAAKmE,MAAME,OAASf,EACtCtD,KAAKwB,OAmLT,OA7KEqC,EAAA3D,UAAAoE,MAAA,WACwB,EAAlBtE,KAAK+D,MAAMQ,OACbvE,KAAK+D,MAAMO,QACXtE,KAAKwB,SASTqC,EAAA3D,UAAAsE,IAAA,SAAItB,GACF,OAAQlD,KAAK+D,MAAMS,IAAIxE,KAAKqE,OAAOnB,KAAY,IAQjDW,EAAA3D,UAAAuE,IAAA,SAAIvB,EAAWwB,GACb1E,KAAK2E,QAAQ,CAACzB,GAASwB,IAQzBb,EAAA3D,UAAAyE,QAAA,SAAQC,EAAeF,GAAvB,IAAAG,EAAA7E,KACE4E,EAASE,QAAO,SAAE5B,GAChB2B,EAAKd,MAAMU,IAAII,EAAKR,OAAOnB,GAAS1D,OAAOuF,OAAO,GAAIL,MAExD1E,KAAKwB,QAQPqC,EAAA3D,UAAA8E,OAAA,SAAON,GAAP,IAAAG,EAAA7E,KACEL,MAAMsF,KAAKjF,KAAK+D,MAAMmB,QAAQJ,QAAO,SAAEvE,GACrCsE,EAAKd,MAAMU,IAAIlE,EAAKf,OAAOuF,OAAO,GAAIL,MAExC1E,KAAKwB,QAQPqC,EAAA3D,UAAAiF,OAAA,SAAOjC,EAAWkC,EAAqBC,QAAA,IAAAA,IAAAA,GAAA,GACrCrF,KAAKsF,WAAW,CAACpC,GAASkC,EAASC,IAQrCxB,EAAA3D,UAAAoF,WAAA,SAAWV,EAAeQ,EAAqBC,GAA/C,IAAAR,EAAA7E,KACE,QAD6C,IAAAqF,IAAAA,GAAA,IAC3B,IAAdA,EACF,OAAOrF,KAAKuF,oBAAoBX,EAAUQ,GAG5CR,EAASE,QAAO,SAAE5B,OACVwB,EAAQlF,OAAOuF,OAAO,GAAIF,EAAKL,IAAItB,GAASkC,GAClDP,EAAKd,MAAMU,IAAII,EAAKR,OAAOnB,GAASwB,KAEtC1E,KAAKwB,QAQPqC,EAAA3D,UAAAsF,QAAA,SAAQtC,EAAWgC,GACjBlF,KAAKyF,YAAY,CAACvC,GAASgC,IAQ7BrB,EAAA3D,UAAAuF,YAAA,SAAYb,EAAeM,GAA3B,IAAAL,EAAA7E,KACE4E,EAASE,QAAO,SAAE5B,OACVwC,EAAeb,EAAKL,IAAItB,GACxBkC,EAAUF,EAAKS,OAAM,SAAEC,EAA+BrF,GAE1D,OADAqF,EAAIrF,GAAOmF,EAAanF,KAAQ,EACzBqF,GACN,IACGC,EAAkBhB,EAAKiB,eAAeV,GACtCV,EAAQlF,OAAOuF,OAAO,GAAIW,EAAcG,GAC9ChB,EAAKd,MAAMU,IAAII,EAAKR,OAAOnB,GAASwB,KAEtC1E,KAAKwB,QAQPqC,EAAA3D,UAAA6F,UAAA,SAAUX,GAAV,IAAAP,EAAA7E,KACQgG,EAAUhG,KAAKiG,aACrBtG,MAAMsF,KAAKe,GAASlB,QAAO,SAAEvE,OACrBmE,EAAQlF,OAAOuF,OAAO,GAAIF,EAAKd,MAAMS,IAAIjE,GAAM6E,GACrDP,EAAKd,MAAMU,IAAIlE,EAAKmE,KAEtB1E,KAAKwB,QAUCqC,EAAA3D,UAAAqF,oBAAR,SAA4BX,EAAeQ,GAA3C,IAAAP,EAAA7E,KACQ8F,EAAiB9F,KAAK8F,eAAeV,GAErCF,EAAON,EAASsB,IAAG,SAAEhD,GAAc,OAAA2B,EAAKR,OAAOnB,KACrC,IAAIiD,IAAIjB,EAAKhD,OAAOvC,MAAMsF,KAAKjF,KAAKiG,gBAC5CnB,QAAO,SAAEvE,OACTmE,EAAQG,EAAKd,MAAMS,IAAIjE,IAAI,GACR,GAArB2E,EAAKkB,QAAQ7F,GACfsE,EAAKd,MAAMU,IAAIlE,EAAKf,OAAOuF,OAAO,GAAIL,EAAOU,IAE7CP,EAAKd,MAAMU,IAAIlE,EAAKf,OAAOuF,OAAO,GAAIL,EAAOoB,MAIjD9F,KAAKwB,QASCqC,EAAA3D,UAAA4F,eAAR,SAAuBV,GACrB,OAAO5F,OAAO6G,QAAQjB,GAASO,OAAM,SAAEG,EAA4BQ,GAC3D,IAAAC,EAAA5E,EAAA2E,EAAA,GAACE,EAAAD,EAAA,GAAW9E,EAAA8E,EAAA,GAIlB,cAHW9E,UAAiB,IAC1BqE,EAAeU,IAAc/E,GAExBqE,GACN,KAOGjC,EAAA3D,UAAA+F,WAAR,eACQQ,EAAYzG,KAAKmE,MAAQxE,MAAMsF,KAAKjF,KAAKmE,MAAMJ,MAAMmB,QAAU,GACrE,OAAO,IAAIiB,IAAIxG,MAAMsF,KAAKjF,KAAK+D,MAAMmB,QAAQhD,OAAOuE,KAM9C5C,EAAA3D,UAAAsB,KAAR,WACExB,KAAKiE,QAAQzC,QAGjBqC,kBCzJE,SAAA6C,EAAoBC,GAAA3G,KAAA2G,QAAAA,EAvCX3G,KAAA4G,QAAU,IAAIC,EAAAA,gBAAqB,IAKpC7G,KAAA8G,QAAS,EAKT9G,KAAA+G,MAA4B,GAK5B/G,KAAAgH,QAAU,IAAIH,EAAAA,gBAAgBzC,WAK9BpE,KAAAiH,MAAQ,IAAIJ,EAAAA,gBAAgBzC,WAU3BpE,KAAAkH,OAAS,IAAIL,EAAAA,gBAAwB,GAMrC7G,KAAAmH,OAAS,IAAIN,EAAAA,iBAAyB,GAoNjD,OAzNErH,OAAAyB,eAAIyF,EAAAxG,UAAA,QAAK,KAAT,WAAsB,OAAOF,KAAKkH,OAAOzF,uCAMzCjC,OAAAyB,eAAIyF,EAAAxG,UAAA,QAAK,KAAT,WAAuB,OAAOF,KAAKmH,OAAO1F,uCAQ1CiF,EAAAxG,UAAAkH,IAAA,WACE,OAAOpH,KAAK4G,QAAQnF,OAOtBiF,EAAAxG,UAAAmH,KAAA,WACE,OAAOrH,KAAK4G,SAOdF,EAAAxG,UAAAoH,QAAA,SAAQC,GACN,OAAOvH,KAAK4G,QAAQnF,MAAM+F,KAAKD,IAOjCb,EAAAxG,UAAAuH,SAAA,SAASF,GACP,OAAOvH,KAAK4G,QAAQc,KAAKxB,EAAAA,IAAG,SAAEyB,GAAgB,OAAAA,EAAOH,KAAKD,OAO5Db,EAAAxG,UAAA0H,OAAA,SAAOL,GACL,OAAOvH,KAAK4G,QAAQnF,MAAMoG,OAAON,IAOnCb,EAAAxG,UAAA4H,QAAA,SAAQP,GACN,OAAOvH,KAAK4G,QAAQc,KAAKxB,EAAAA,IAAG,SAAEyB,GAAgB,OAAAA,EAAOE,OAAON,OAM9Db,EAAAxG,UAAAoE,MAAA,WACEtE,KAAK6H,OAAOzD,WACZpE,KAAK+H,KAAK3D,YAGZsC,EAAAxG,UAAA8H,QAAA,WACMhI,KAAKiI,WAAa7D,WACpBpE,KAAKiI,SAASC,cAEhBlI,KAAKsE,SAQPoC,EAAAxG,UAAAiI,KAAA,SAAKZ,GACH,IAAoB,IAAhBvH,KAAK8G,OACP,MAAM,IAAIsB,MAAM,qEAGlB,OADApI,KAAK+G,MAAMhF,KAAKwF,GACTvH,MAQT0G,EAAAxG,UAAA2H,OAAA,SAAON,GAEL,OADAvH,KAAKgH,QAAQxF,KAAK+F,GACXvH,MAQT0G,EAAAxG,UAAA6H,KAAA,SAAKR,GAEH,OADAvH,KAAKiH,MAAMzF,KAAK+F,GACTvH,MAOT0G,EAAAxG,UAAAmI,KAAA,WAAA,IAAAxD,EAAA7E,KACEA,KAAK8G,QAAS,MACRH,EAA8B,EAApB3G,KAAK+G,MAAMpG,OAAaX,KAAKsI,mBAAqBtI,KAAKuI,aACvEvI,KAAKiI,SAAWO,EAAAA,cAAc7B,EAAS3G,KAAKgH,QAAShH,KAAKiH,OACvDS,KAAKe,EAAAA,KAAK,GAAIC,EAAAA,aAAa,KAC3BC,UAAS,SAAErC,GACJ,IAAAC,EAAA5E,EAAA2E,EAAA,GAACsC,EAAArC,EAAA,GAASsB,EAAAtB,EAAA,GAAQwB,EAAAxB,EAAA,GAClBoB,EAAS9C,EAAKgE,cAAcD,EAASf,EAAQE,GACnDlD,EAAKiE,UAAUnB,MAQbjB,EAAAxG,UAAAqI,WAAR,WACE,OAAOvI,KAAY,SAOb0G,EAAAxG,UAAAoI,iBAAR,WAAA,IAAAzD,EAAA7E,KACQ+I,EAAW,CAAC/I,KAAK2G,QAAS6B,EAAAA,cAAaQ,WAAA,EAAA/G,EACxCjC,KAAK+G,MAAMb,IAAG,SAAEiC,GAA2B,OAAAA,EAAKc,YAGrD,OAAOT,EAAAA,cAAaQ,WAAA,EAAA/G,EAAI8G,IACrBrB,KACCxB,EAAAA,IAAG,SAAEI,GACG,IAAAC,EAAA5E,EAAA2E,EAAA,GAAC1B,EAAA2B,EAAA,GAAU2C,EAAA3C,EAAA,GACjB,OAAO3B,EAASe,OAAM,SAAEgC,EAAazE,OAC7BzB,EAAQoD,EAAKsE,mBAAmBjG,EAAQgG,GAI9C,OAHIzH,IAAU2C,WACZuD,EAAO5F,KAAKN,GAEPkG,GACN,QASHjB,EAAAxG,UAAAiJ,mBAAR,SAA2BjG,EAAWgG,GAGpC,QAFIzH,EAAK,EACL2H,EAAY,EACT3H,IAAU2C,WAAagF,EAAYpJ,KAAK+G,MAAMpG,QACnDc,EAAQzB,KAAK+G,MAAMqC,GAAWzD,OAAOlE,EAAOyH,EAASE,IACrDA,GAAa,EAEf,OAAA,GAUM1C,EAAAxG,UAAA2I,cAAR,SAAsBlB,EAAaE,EAA4BE,GAI7D,OAHAJ,EAASA,EAAO0B,MAAM,GACtB1B,EAAS3H,KAAKsJ,aAAa3B,EAAQE,GACnCF,EAAS3H,KAAKuJ,WAAW5B,EAAQI,IAU3BrB,EAAAxG,UAAAoJ,aAAR,SAAqB3B,EAAaJ,GAChC,OAAIA,IAAWnD,UAAoBuD,EAC5BA,EAAOE,OAAM,SAAEpG,GAAa,OAAA8F,EAAO9F,MASpCiF,EAAAxG,UAAAqJ,WAAR,SAAmB5B,EAAaJ,GAC9B,OAAIA,IAAWnD,UAAoBuD,EAC5BA,EAAOI,KAAI,SAAEyB,EAAOC,GACzB,OAAOC,EAAAA,YAAYC,eACjBpC,EAAOqC,cAAcJ,GACrBjC,EAAOqC,cAAcH,GACrBlC,EAAOsC,cAKLnD,EAAAxG,UAAA4I,UAAR,SAAkBnB,GAChB3H,KAAK4G,QAAQpF,KAAKmG,OACZmC,EAAQnC,EAAOhH,OACfoJ,EAAkB,IAAVD,EACd9J,KAAKkH,OAAO1F,KAAKsI,GACjB9J,KAAKmH,OAAO3F,KAAKuI,IAErBrD,kBCxME,SAAAsD,EAAYpF,EAAed,QAAA,IAAAA,IAAAA,EAAA,IAA3B,IAAAe,EAAA7E,KAnDSA,KAAAiK,UAAY,IAAIpD,EAAAA,gBAAqB,IAKrC7G,KAAAkH,OAAS,IAAIL,EAAAA,gBAAwB,GAMrC7G,KAAAmH,OAAS,IAAIN,EAAAA,iBAAyB,GAsCvC7G,KAAAkK,WAAqB,EAG3BlK,KAAKqE,OAASP,EAAQO,OAASP,EAAQO,OAASf,EAChDtD,KAAKmK,YAAcrG,EAAQqG,YAAcrG,EAAQqG,YAAclH,EAE/DjD,KAAK0E,MAAQ,IAAIb,EAAyB,CAACM,MAAOnE,OAClDA,KAAKoK,KAAO,IAAI1D,EAAc1G,KAAKiK,WACnCjK,KAAKqK,UAAY,IAAI3D,EAAkC1G,KAAKoK,KAAK/C,QAAQc,KAAK,CAC5Ec,OAAQjJ,KAAK0E,MAAMT,QACnB0B,OAAM,SAAGzC,GACP,MAAO,CAACA,OAAMA,EAAEwB,MAAOG,EAAKH,MAAMF,IAAItB,OAI1ClD,KAAKoK,KAAK/B,OACVrI,KAAKqK,UAAUhC,OAEO,EAAlBzD,EAASjE,OACXX,KAAKsK,KAAK1F,GAEV5E,KAAKuK,OAASvK,KAAKwK,cAAc5F,GAgJvC,OAhNEpF,OAAAyB,eAAI+I,EAAA9J,UAAA,QAAK,KAAT,WAAsB,OAAOF,KAAKkH,OAAOzF,uCAMzCjC,OAAAyB,eAAI+I,EAAA9J,UAAA,QAAK,KAAT,WAAuB,OAAOF,KAAKmH,OAAO1F,uCA8B1CjC,OAAAyB,eAAI+I,EAAA9J,UAAA,QAAK,KAAT,WAAiC,OAAOF,KAAKuK,wCAM7C/K,OAAAyB,eAAI+I,EAAA9J,UAAA,WAAQ,KAAZ,WAA0B,OAAOF,KAAKkK,2CA+BtCF,EAAA9J,UAAAsE,IAAA,SAAIjE,GACF,OAAOP,KAAK+D,MAAMS,IAAIjE,IAOxByJ,EAAA9J,UAAAkH,IAAA,WACE,OAAOpH,KAAKiK,UAAUxI,OAOxBuI,EAAA9J,UAAAoK,KAAA,SAAK1F,EAAe6F,QAAA,IAAAA,IAAAA,GAAA,GAClBzK,KAAKuK,OAASvK,KAAKwK,cAAc5F,GACjC5E,KAAKkK,UAAYO,EACjBzK,KAAKwB,QAQPwI,EAAA9J,UAAAwK,UAAA,WACM1K,KAAK+D,OAA2B,EAAlB/D,KAAK+D,MAAMQ,MAC3BvE,KAAK+D,MAAMO,QACXtE,KAAKkK,WAAY,EACjBlK,KAAKwB,QACIxB,KAAK+D,OACd/D,KAAK2K,eAOTX,EAAA9J,UAAAoE,MAAA,WACEtE,KAAKqK,UAAU/F,QACftE,KAAKoK,KAAK9F,QACVtE,KAAK0E,MAAMJ,QACXtE,KAAK0K,aAGPV,EAAA9J,UAAA8H,QAAA,WACEhI,KAAKqK,UAAUrC,UACfhI,KAAKoK,KAAKpC,UACVhI,KAAKsE,SAOP0F,EAAA9J,UAAA0K,OAAA,SAAO1H,GACLlD,KAAK6K,WAAW,CAAC3H,KAOnB8G,EAAA9J,UAAA2K,WAAA,SAAWjG,GAAX,IAAAC,EAAA7E,KACE4E,EAASE,QAAO,SAAE5B,GAAc,OAAA2B,EAAKd,MAAMU,IAAII,EAAKR,OAAOnB,GAASA,KACpElD,KAAKkK,WAAY,EACjBlK,KAAKwB,QAOPwI,EAAA9J,UAAAiF,OAAA,SAAOjC,GACLlD,KAAKsF,WAAW,CAACpC,KAOnB8G,EAAA9J,UAAAoF,WAAA,SAAWV,GAAX,IAAAC,EAAA7E,KACE4E,EAASE,QAAO,SAAE5B,GAAc,OAAA2B,EAAKd,MAAMU,IAAII,EAAKR,OAAOnB,GAASA,KACpElD,KAAKkK,WAAY,EACjBlK,KAAKwB,QAOPwI,EAAA9J,UAAA4K,UAAA,SAAO5H,GACLlD,KAAK+K,WAAW,CAAC7H,KAOnB8G,EAAA9J,UAAA6K,WAAA,SAAWnG,GAAX,IAAAC,EAAA7E,KACE4E,EAASE,QAAO,SAAE5B,GAAc,OAAA2B,EAAKd,MAAM+G,UAAOjG,EAAKR,OAAOnB,MAC9DlD,KAAKkK,WAAY,EACjBlK,KAAKwB,QAQCwI,EAAA9J,UAAAsK,cAAR,SAAsB5F,GAAtB,IAAAC,EAAA7E,KACQqG,EAAUzB,EAASsB,IAAG,SAAEhD,GAAc,MAAA,CAAC2B,EAAKR,OAAOnB,GAASA,KAClE,OAAO,IAAIc,IAAG,IAMRgG,EAAA9J,UAAAsB,KAAR,WACExB,KAAKiK,UAAUzI,KAAK7B,MAAMsF,KAAKjF,KAAK+D,MAAM4D,WAC1C3H,KAAK2K,eAMCX,EAAA9J,UAAAyK,YAAR,eACQb,EAAQ9J,KAAK+D,MAAMQ,KACnBwF,EAAkB,IAAVD,EACd9J,KAAKkH,OAAO1F,KAAKsI,GACjB9J,KAAKmH,OAAO3F,KAAKuI,IAGrBC,kBCrLE,SAAAgB,EAAY7G,EAAwB8G,GAZ5BjL,KAAAkL,gBAAkB,IAAIlH,IAa5BhE,KAAKmL,kBAAkBF,GACvBjL,KAAKoL,SAASjH,GA8GlB,OA3GE6G,EAAA9K,UAAA8H,QAAA,WACEhI,KAAKmL,kBAAkB/G,WACvBpE,KAAKoL,SAAShH,YAOhB4G,EAAA9K,UAAAkL,SAAA,SAASjH,GACP,GAAIA,IAAUC,UAIZ,OAHApE,KAAKqL,oBACLrL,KAAKkL,gBAAgB5G,aACrBtE,KAAKmE,MAAQC,WAIfpE,KAAKoL,SAAShH,WACdpE,KAAKmE,MAAQA,EACbnE,KAAKsL,iBACLtL,KAAKuL,iBAOPP,EAAA9K,UAAAiL,kBAAA,SAAkBF,GAChBjL,KAAKiL,MAAQA,GAOPD,EAAA9K,UAAAoL,eAAR,WAAA,IAAAzG,EAAA7E,KACEA,KAAKqL,oBAELrL,KAAKwL,WAAaxL,KAAKmE,MAAM8F,UAC1BtB,UAAS,SAAE/D,GAAkB,OAAAC,EAAK4G,iBAAiB7G,KAEtD5E,KAAK0L,QAAU1L,KAAKmE,MAAMO,MAAMT,QAC7ByD,KAAKe,EAAAA,KAAK,IACVE,UAAS,WAAO,OAAA9D,EAAK8G,mBAMlBX,EAAA9K,UAAAmL,kBAAR,WACMrL,KAAKwL,aAAepH,WACtBpE,KAAKwL,WAAWtD,cAEdlI,KAAK0L,UAAYtH,WACnBpE,KAAK0L,QAAQxD,cAEflI,KAAKwL,WAAapH,UAClBpE,KAAK0L,QAAUtH,WAMT4G,EAAA9K,UAAAuL,iBAAR,SAAyB7G,GACvB5E,KAAKuL,iBAQCP,EAAA9K,UAAAyL,cAAR,mBACMC,GAAkB,EAChBC,EAAa7L,KAAKmE,MAAMO,MAAMX,MAC9B+H,EAAa9L,KAAKkL,gBAEpBW,EAAWtH,OAASuH,EAAWvH,OACjCqH,EAAkB5L,KAAKuL,qBAGnB9E,EAAY9G,MAAMsF,KAAK4G,EAAW3G,YACxC,IAAkB,IAAA6G,EAAAC,EAAAvF,GAASwF,EAAAF,EAAAvK,QAAAyK,EAAAvK,KAAAuK,EAAAF,EAAAvK,OAAE,CAAxB,IAAMjB,EAAG0L,EAAAxK,MACNyK,EAAaL,EAAWrH,IAAIjE,GAC5B4L,EAAaL,EAAWtH,IAAIjE,IACV,IAApBqL,IACEO,IAAe/H,UACjBwH,EAAkB5L,KAAKuL,gBACb7B,EAAAA,YAAY0C,qBAAqBF,EAAYC,KACvDP,EAAkB5L,KAAKuL,kBAI3BvL,KAAKkL,gBAAgBzG,IAAIlE,EAAKf,OAAOuF,OAAO,GAAImH,2GAO5ClB,EAAA9K,UAAAqL,cAAR,WAIE,OAHIvL,KAAKiL,QAAU7G,WACjBpE,KAAKiL,MAAMM,iBAEN,GAGXP,kBCpHE,SAAAqB,EAAYvI,QAAA,IAAAA,IAAAA,EAAA,IAFJ9D,KAAAsM,gBAAiB,EAGvBtM,KAAKqE,OAASP,EAAQO,OAASP,EAAQO,OAASf,EAChDtD,KAAKuM,WAAa,IAAIvC,EAAmD,GAAI,CAC3E3F,OAAM,SAAGmI,GAA+B,OAAAA,EAAUjM,OAkUxD,OA7UEf,OAAAyB,eAAIoL,EAAAnM,UAAA,QAAK,KAAT,WAAuB,OAAkD,IAA3CF,KAAKuM,WAAWtC,UAAUxI,MAAMd,wCAK9DnB,OAAAyB,eAAIoL,EAAAnM,UAAA,gBAAa,KAAjB,WAA+B,OAAOF,KAAKsM,gDAU3CD,EAAAnM,UAAA8H,QAAA,WACEhI,KAAKuM,WAAWvE,WAWlBqE,EAAAnM,UAAA0K,OAAA,SAAO6B,EAAiBtI,EAA6BZ,OAC7CmJ,EAAoB1M,KAAK2M,qBAAqBF,GAChDC,IAAsBtI,WACxBpE,KAAK4M,gBAAgBF,GAGvB1M,KAAK6M,SAASJ,EAAStI,EAAOZ,IAYhC8I,EAAAnM,UAAAiF,OAAA,SAAO2H,EAAkBL,EAAiBtI,EAA6BZ,OAC/DmJ,EAAoB1M,KAAK2M,qBAAqBF,GAChDC,IAAsBtI,YACxBpE,KAAK4M,gBAAgBF,GACjBA,EAAkBK,OAASC,EAAoB7K,QAMrDnC,KAAKiN,SAASH,EAAUL,EAAStI,EAAOZ,GALpCvD,KAAK6M,SAASJ,EAAStI,EAAOZ,IAgBpC8I,EAAAnM,UAAA4K,UAAA,SAAOgC,EAAkB3I,EAA6BZ,OAC9CmJ,EAAoB1M,KAAK2M,qBAAqBG,GAChDJ,IAAsBtI,YACxBpE,KAAK4M,gBAAgBF,GACjBA,EAAkBK,OAASC,EAAoB7K,QAQrDnC,KAAKkN,SAASJ,EAAU3I,EAAOZ,GAPvBY,IAAUC,WACZD,EAAM2G,UAAOgC,IAoBrBT,EAAAnM,UAAAiN,OAAA,SAAOZ,EAA+Ba,GAAtC,IAAAvI,EAAA7E,KAGE,OAFAA,KAAKsM,gBAAiB,EAEfc,EAAQpN,KAAMuM,GAClB7E,KACC2F,EAAAA,WAAU,WAAO,OAAAC,EAAAA,GAAG,IAAIlF,SACxBmF,EAAAA,IAAG,SAAEC,GACCA,aAAkBpF,MACpBvD,EAAK4I,cAAclB,GAEnB1H,EAAK6I,gBAAgBnB,OAW/BF,EAAAnM,UAAAyN,UAAA,SAAUP,OACFb,EAAavM,KAAK4N,wBACxB,OAAO5N,KAAKmN,OAAOZ,EAAYa,IAMjCf,EAAAnM,UAAA2N,SAAA,WACE7N,KAAK8N,mBAAmB9N,KAAKuM,WAAWnF,QAM1CiF,EAAAnM,UAAA4N,mBAAA,SAAmBvB,WACjBvM,KAAK+N,yBAOCC,EAAmB,IAAIhK,QAK7B,IAAwB,IAAAiK,EAAAjC,EAAAO,GAAU2B,EAAAD,EAAAzM,QAAA0M,EAAAxM,KAAAwM,EAAAD,EAAAzM,OAAE,CAA/B,IAAMgL,EAAS0B,EAAAzM,MACZ0C,EAAQqI,EAAUrI,MACxB,GAAIqI,EAAUrI,QAAUC,UAAxB,KAEI+J,EAAkBH,EAAiBxJ,IAAIL,GACvCgK,IAAoB/J,YACtB+J,EAhB4B,IAAInK,IAAI,CACtC,CAACgJ,EAAoB3K,OAAQ,IAC7B,CAAC2K,EAAoB5K,OAAQ,IAC7B,CAAC4K,EAAoB7K,OAAQ,MAc3B6L,EAAiBvJ,IAAIN,EAAOgK,IAE9BA,EAAgB3J,IAAIgI,EAAUO,MAAMhL,KAAKyK,yGAG3C7M,MAAMsF,KAAK+I,EAAiB9I,QAAQJ,QAAO,SAAEX,OACrCgK,EAAkBH,EAAiBxJ,IAAIL,GAEvCiK,EAAUD,EAAgB3J,IAAIwI,EAAoB3K,QACxD8B,EAAM0G,WAAWuD,EAAQlI,IAAG,SAAEmI,GAA6B,OAAAA,EAAQvB,gBAE7DwB,EAAUH,EAAgB3J,IAAIwI,EAAoB5K,QACxD+B,EAAMmB,WAAWgJ,EAAQpI,IAAG,SAAEqI,GAA6B,OAAAA,EAAQzB,gBAE7D0B,EAAUL,EAAgB3J,IAAIwI,EAAoB7K,QACxDgC,EAAM4G,WAAWyD,EAAQtI,IAAG,SAAEuI,GAA6B,OAAAA,EAAQhC,aAGrEzM,KAAKuM,WAAWxB,WAAWwB,GAC3BvM,KAAKsM,gBAAiB,GAOxBD,EAAAnM,UAAAoE,MAAA,WACEtE,KAAKuM,WAAWjI,QAChBtE,KAAKsM,gBAAiB,GAOxBD,EAAAnM,UAAAwO,iBAAA,SAAiBC,GAAjB,IAAA9J,EAAA7E,KACEA,KAAK+N,qBAEcY,EAAYpC,WAAWnF,MAC/BtC,QAAO,SAAE0H,GAClB3H,EAAK+J,aAAapC,MAUdH,EAAAnM,UAAA2M,SAAR,SAAiBJ,EAAiBtI,EAA6BZ,GAC7DvD,KAAK4O,aAAa,CAChBrO,IAAKP,KAAKqE,OAAOoI,GACjBM,KAAMC,EAAoB7K,OAC1B2K,SAAU1I,UACVqI,QAAOA,EACPtI,MAAKA,EACLZ,KAAIA,IAGFY,IAAUC,WACZD,EAAMyG,OAAO6B,IAWTJ,EAAAnM,UAAA+M,SAAR,SAAiBH,EAAkBL,EAAiBtI,EAA6BZ,GAC/EvD,KAAK4O,aAAa,CAChBrO,IAAKP,KAAKqE,OAAOoI,GACjBM,KAAMC,EAAoB5K,OAC1B0K,SAAQA,EACRL,QAAOA,EACPtI,MAAKA,EACLZ,KAAIA,IAGFY,IAAUC,WACZD,EAAMgB,OAAOsH,IAUTJ,EAAAnM,UAAAgN,SAAR,SAAiBJ,EAAkB3I,EAA6BZ,GAC9DvD,KAAK4O,aAAa,CAChBrO,IAAKP,KAAKqE,OAAOyI,GACjBC,KAAMC,EAAoB3K,OAC1ByK,SAAQA,EACRL,QAASrI,UACTD,MAAKA,EACLZ,KAAIA,IAGFY,IAAUC,WACZD,EAAM2G,UAAOgC,IASTT,EAAAnM,UAAA2O,kBAAR,SAA0BtC,GACxBvM,KAAKuM,WAAWxB,WAAWwB,IAOrBF,EAAAnM,UAAAwN,gBAAR,SAAwBnB,GACtBvM,KAAK6O,kBAAkBtC,GACvBvM,KAAKsM,gBAAiB,GAOhBD,EAAAnM,UAAAuN,cAAR,SAAsBlB,GACpBvM,KAAKsM,gBAAiB,GAOhBD,EAAAnM,UAAA0O,aAAR,SAAqBpC,GACnBxM,KAAK+N,qBAEL/N,KAAKuM,WAAW3B,OAAO4B,GACvBxM,KAAKuM,WAAW7H,MAAMS,OAAOqH,EAAW,CAACsC,OAAO,KAO1CzC,EAAAnM,UAAA0M,gBAAR,SAAwBJ,GACtBxM,KAAK+N,qBAEL/N,KAAKuM,WAAWzB,UAAO0B,GACvBxM,KAAKuM,WAAW7H,MAAMS,OAAOqH,EAAW,CAACsC,OAAO,KAQ1CzC,EAAAnM,UAAAyM,qBAAR,SAA6BzJ,GAC3B,OAAOlD,KAAKuM,WAAW/H,IAAIxE,KAAKqE,OAAOnB,KAOjCmJ,EAAAnM,UAAA0N,sBAAR,WACE,OAAO5N,KAAKuM,WAAWlC,UACpBzC,OAAM,SAAEnG,GACP,OAA6B,IAAtBA,EAAMiD,MAAMoK,QAEpB5I,IAAG,SAAEzE,GAAkE,OAAAA,EAAMyB,UAM1EmJ,EAAAnM,UAAA6N,mBAAR,WACE,IAA2B,IAAvB/N,KAAK+O,cACP,MAAM,IAAI3G,MAAM,6EAGtBiE,KCnXA2C,EAAA,WA6FE,SAAAA,EAAoB/D,GAAAjL,KAAAiL,MAAAA,EA/DpBjL,KAAAiP,UAAY,IAAIpI,EAAAA,gBAAwBzC,WAMxCpE,KAAAkP,WAAa,IAAIrI,EAAAA,gBAAwBzC,WAEhCpE,KAAAmP,iBAAmB,CAAC3L,GAAI,oBAoBxBxD,KAAAoP,cAAoC1L,EAKpC1D,KAAAqP,UAAoBjL,UAKpBpE,KAAAsP,OAAiB,EAKjBtP,KAAAuP,aAAuB,MAKvBvP,KAAAwP,cAAwB,OAUvBxP,KAAAyP,eAAiB,IAAIC,EAAAA,aA6EjC,OAlEEV,EAAA9O,UAAAyP,SAAA,WAAA,IAAA9K,EAAA7E,KACEA,KAAK4P,QAAU,IAAI5E,EAAmBhL,KAAKmE,MAAOnE,KAAKiL,OAEvDjL,KAAK6P,WAAa7P,KAAKmE,MAAMkG,UAC1BvC,QAAO,SAAEgI,GAAiC,OAA0B,IAA1BA,EAAOpL,MAAMqL,WACvDpH,UAAS,SAAEqH,OACJpL,EAAWoL,EAAQ9J,IAAG,SAAE4J,GAAiC,OAAAA,EAAO5M,SACtE2B,EAAKoL,kBAAkBrL,MAQ7BoK,EAAA9O,UAAAgQ,YAAA,WACElQ,KAAK4P,QAAQ5H,UACbhI,KAAK6P,WAAW3H,eAOlB8G,EAAA9O,UAAAiQ,kBAAA,SAAkBC,GAAlB,IAAAvL,EAAA7E,KACQ2H,EAASyI,EAAM3O,iBAAiB9B,MAAQyQ,EAAM3O,MAAQ,CAAC2O,EAAM3O,OAE7D4O,EAAc1I,EAAOH,KAAI,SAAE8I,GAAmB,OAAAA,IAAWzL,EAAKsK,mBAChEvK,EAAW+C,EAAOE,OAAM,SAAEyI,GAAmB,OAAAA,IAAWzL,EAAKsK,mBAC7DkB,IAAgBjM,YACdQ,EAASjE,SAAWX,KAAKmE,MAAM2F,MACjClF,EAAW,GACFA,EAASjE,OAASX,KAAKmE,MAAM2F,QACtClF,EAAW5E,KAAKmE,MAAMiD,QAIF,IAApBxC,EAASjE,OACXX,KAAKmE,MAAMO,MAAMqB,UAAU,CAACgK,UAAU,IAEtC/P,KAAKmE,MAAMO,MAAMY,WAAWV,EAAU,CAACmL,UAAU,IAAO,OAGpDtO,EAAQzB,KAAKsP,MAAQ1K,EAAWwL,EAAM3O,MAC5CzB,KAAKyP,eAAec,KAAK,CAACR,UAAU,EAAMtO,MAAKA,KAGzCuN,EAAA9O,UAAA+P,kBAAR,SAA0BrL,GACxB,IAAmB,IAAf5E,KAAKsP,MACPtP,KAAKiP,UAAUzN,KAAKoD,OACf,KACC1B,EAA2B,EAAlB0B,EAASjE,OAAaiE,EAAS,GAAKR,UACnDpE,KAAKiP,UAAUzN,KAAK0B,GAGtBlD,KAAKwQ,8BAA8B5L,IAG7BoK,EAAA9O,UAAAsQ,8BAAR,SAAsC5L,GAChCA,EAASjE,SAAWX,KAAKmE,MAAM2F,OAAS9J,KAAKkP,WAAWzN,QAAUzB,KAAKwP,cACzExP,KAAKkP,WAAW1N,KAAKxB,KAAKwP,eACjB5K,EAASjE,OAASX,KAAKmE,MAAM2F,OAAS9J,KAAKkP,WAAWzN,QAAUzB,KAAKuP,cAC9EvP,KAAKkP,WAAW1N,KAAKxB,KAAKuP,mCA/I/BkB,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,sBACVC,SAAA,8nBAEAC,gBAAiBC,EAAAA,wBAAwBC,0FAhBzCC,EAAAA,oDA+CCC,EAAAA,6BAKAA,EAAAA,yBAKAA,EAAAA,qBAKAA,EAAAA,4BAKAA,EAAAA,6BAKAA,EAAAA,2BAKAA,EAAAA,8BAKAC,EAAAA,UA6EHlC,EArKA,GCAAmC,EAAA,WAwIE,SAAAA,EAAoBlG,GAAAjL,KAAAiL,MAAAA,EAlGpBjL,KAAAoR,0BAA4BC,EAM5BrR,KAAAsR,0BAA4BC,EAM5BvR,KAAAwR,gBAA8D,IAAI3K,EAAAA,gBAAgBzC,WA0BlFpE,KAAAyR,eAA4CC,EAA0B/O,KAK5D3C,KAAA2R,YAAc,IAAIjC,EAAAA,aAKlB1P,KAAA4R,mBAAqB,IAAIlC,EAAAA,aA2TrC,OAnTElQ,OAAAyB,eAAIkQ,EAAAjR,UAAA,UAAO,KAAX,eACM2R,EAAU7R,KAAK4Q,SAASiB,QACzBhK,OAAM,SAAEiK,GAA8B,OAAmB,IAAnBA,EAAOC,UAC7C7L,IAAG,SAAE4L,GAA8B,OAAAA,EAAOE,OAM7C,OAJ+B,IAA3BhS,KAAKiS,oBACPJ,EAAU,CAAC,qBAAqB3P,OAAO2P,IAGlCA,mCAOTrS,OAAAyB,eAAIkQ,EAAAjR,UAAA,aAAU,KAAd,WAA8C,OAAOF,KAAKmE,MAAMiG,KAAK/C,wCAMrE7H,OAAAyB,eAAIkQ,EAAAjR,UAAA,YAAS,KAAb,WAA2B,OAAOF,KAAK4Q,SAASsB,YAAa,mCAM7D1S,OAAAyB,eAAIkQ,EAAAjR,UAAA,oBAAiB,KAArB,WAAmC,OAAOF,KAAK4Q,SAASqB,oBAAqB,mCAM7EzS,OAAAyB,eAAIkQ,EAAAjR,UAAA,aAAU,KAAd,WAA4B,OAAOF,KAAK4Q,SAASuB,aAAc,mCAM/D3S,OAAAyB,eAAIkQ,EAAAjR,UAAA,cAAW,KAAf,WAA6B,OAAOF,KAAK4Q,SAASwB,cAAgBhO,WAAmBpE,KAAK4Q,SAASwB,6CAQnGjB,EAAAjR,UAAAyP,SAAA,WAAA,IAAA9K,EAAA7E,KACEA,KAAKqS,YAAcrS,KAAKmE,MAAMkG,UAC3BvC,QAAO,SAAEgI,GAAiC,OAA0B,IAA1BA,EAAOpL,MAAMqL,WACvDpH,UAAS,SAAEqH,GACVnL,EAAK2M,gBAAgBhQ,KAAKqD,EAAKyN,sBAAsBtC,OAQ3DmB,EAAAjR,UAAAqS,YAAA,SAAYnN,OACJjB,EAAQiB,EAAQjB,MAClBA,GAASA,EAAMqO,eAAiBrO,EAAMsO,gBACpCzS,KAAK4P,UAAYxL,WACnBpE,KAAK4P,QAAQ5H,UAEfhI,KAAK4P,QAAU,IAAI5E,EAAmBhL,KAAKmE,MAAOnE,KAAKiL,SAQ3DkG,EAAAjR,UAAAgQ,YAAA,WACMlQ,KAAK4P,UAAYxL,WACnBpE,KAAK4P,QAAQ5H,UAEfhI,KAAKqS,YAAYnK,eASnBiJ,EAAAjR,UAAAwS,QAAA,WACE1S,KAAKiL,MAAMM,iBAQb4F,EAAAjR,UAAAyS,OAAA,SAAOvC,GAAP,IAAAvL,EAAA7E,KACQ6J,EAAYuG,EAAMvG,UAClBiI,EAAS9R,KAAK4Q,SAASiB,QAC1BrK,KAAI,SAAE/G,GAAyB,OAAAA,EAAEuR,OAAS5B,EAAMwC,SAEjC,QAAd/I,GAAqC,SAAdA,EACzB7J,KAAKmE,MAAMiG,KAAKrC,KAAK,CACnB6B,cAAa,SAAG1G,GAAmB,OAAA2B,EAAKgO,SAAS3P,EAAQ4O,IACzDjI,UAASA,IAGX7J,KAAKmE,MAAMiG,KAAKrC,KAAK3D,YASzB+M,EAAAjR,UAAA4S,WAAA,SAAW5P,GACTlD,KAAK2R,YAAYpB,KAAKrN,IAUxBiO,EAAAjR,UAAA6S,YAAA,SAAY7P,IACa,IAAnBlD,KAAKkS,YAGTlS,KAAKmE,MAAMO,MAAMS,OAAOjC,EAAQ,CAAC6M,UAAU,IAAO,GAClD/P,KAAK4R,mBAAmBrB,KAAK,CAACzB,MAAO,CAAC5L,OAQxCiO,EAAAjR,UAAA8S,aAAA,SAAaC,IACY,IAAnBjT,KAAKkS,YAETlS,KAAKmE,MAAMO,MAAMqB,UAAU,CAACgK,SAAUkD,KACvB,IAAXA,GACFjT,KAAK4R,mBAAmBrB,KAAK,CAACzB,MAAO,CAAC9O,KAAKmE,MAAMiG,KAAKhD,WAW1D+J,EAAAjR,UAAAgT,YAAA,SAAYD,EAAiB/P,GAC3B,IAAuB,IAAnBlD,KAAKkS,UAAT,KAEM7M,GAAuB,IAAX4N,IAAoBjT,KAAKmS,WAC3CnS,KAAKmE,MAAMO,MAAMS,OAAOjC,EAAQ,CAAC6M,SAAUkD,GAAS5N,IACrC,IAAX4N,GACFjT,KAAK4R,mBAAmBrB,KAAK,CAACzB,MAAO,CAAC5L,OASlCiO,EAAAjR,UAAAoS,sBAAR,SAA8Ba,OACtBC,EAAS7B,EACT8B,EAAiBF,EAAgBxS,OACvC,OAA0B,IAAnB0S,EACLD,EAAOtQ,KACNuQ,IAAmBrT,KAAKmE,MAAMiG,KAAKN,MAAQsJ,EAAOrQ,IAAMqQ,EAAOpQ,MASpEmO,EAAAjR,UAAAoT,iBAAA,SAAiBxB,OACXyB,EAAWzB,EAAO/J,KAItB,OAHIwL,IAAanP,YACfmP,EAAWvT,KAAK4Q,SAAS7I,OAAS3D,WAAoBpE,KAAK4Q,SAAS7I,MAE/DwL,GASTpC,EAAAjR,UAAAsT,cAAA,SAActQ,OACNwB,EAAQ1E,KAAKmE,MAAMO,MAAMF,IAAItB,GACnC,QAAOwB,EAAMqL,UAAWrL,EAAMqL,UAUhCoB,EAAAjR,UAAA2S,SAAA,SAAS3P,EAAgB4O,GACvB,OAAIA,EAAOlI,gBAAkBxF,UACpB0N,EAAOlI,cAAc1G,GAE1BlD,KAAK4Q,SAAShH,gBAAkBxF,UAC3BpE,KAAK4Q,SAAShH,cAAc1G,EAAQ4O,EAAOE,MAE7ChS,KAAKmE,MAAMgG,YAAYjH,EAAQ4O,EAAOE,OAS/Cb,EAAAjR,UAAAuT,kBAAA,SAAkB3B,GAChB,OAAIA,EAAO4B,WAAatP,UACf0N,EAAO4B,SAETrC,EAA0B/O,SAQnC6O,EAAAjR,UAAAyT,cAAA,WACE,MAAO,CACLC,kCAAmC5T,KAAKkS,YAS5Cf,EAAAjR,UAAA2T,eAAA,eACQC,EAAO9T,KAAK4Q,SAASmD,gBAC3B,OAAID,aAAgBE,SACXF,IAEF,IAST3C,EAAAjR,UAAA+T,YAAA,SAAY/Q,OACJ4Q,EAAO9T,KAAK4Q,SAASsD,aAC3B,OAAIJ,aAAgBE,SACXF,EAAK5Q,GAEP,IAUTiO,EAAAjR,UAAAiU,aAAA,SAAajR,EAAgB4O,OACrBsC,EAAM,GAENC,EAAYrU,KAAK4Q,SAAS0D,cAC5BD,aAAqBL,UACvBxU,OAAOuF,OAAOqP,EAAKC,EAAUnR,EAAQ4O,QAGjCyC,EAAazC,EAAOwC,cAK1B,OAJIC,aAAsBP,UACxBxU,OAAOuF,OAAOqP,EAAKG,EAAWrR,IAGzBkR,GASTjD,EAAAjR,UAAAsU,cAAA,SAAcC,EAAqCvR,GACxB,mBAAduR,GACTA,EAAUvR,wBAnXfuN,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,mBACVC,SAAA,klJAEAC,gBAAiBC,EAAAA,wBAAwBC,wnBAxBzCC,EAAAA,oDA2DCC,EAAAA,wBAKAA,EAAAA,8BAKAA,EAAAA,2BAMAC,EAAAA,mCAKAA,EAAAA,UA2THC,EAjZA,MCCEuD,KAAO,OACPC,QAAU,UACVC,QAAU,WCkBZC,EAAA,WAgIE,SAAAA,EAAoB5J,EAAiC6J,GAArD,IAAAjQ,EAAA7E,KAAoBA,KAAAiL,MAAAA,EAAiCjL,KAAA8U,QAAAA,EArHrD9U,KAAA+U,cAAgBC,EAMhBhV,KAAAiV,WAAY,EAMZjV,KAAAkV,qBAAuB,CACrB1R,GAAI,mBACJ2R,KAAM,gBACN/H,QAAO,WACLvI,EAAKoQ,WAAapQ,EAAKoQ,YAkBlBjV,KAAAoV,KAAsBJ,EAAcN,KAKpC1U,KAAAqV,kBAAmB,EAKnBrV,KAAAsV,YAAa,EAKbtV,KAAAuV,MAAQ,UAKRvV,KAAAwV,WAAY,EAKZxV,KAAAyV,UAAW,EAKXzV,KAAA0V,UAAY,SAKZ1V,KAAA2V,UAAY,QAYb3V,KAAA4V,cAAgB,GAKf5V,KAAA6V,cACPhB,EAAmBiB,qBA4DvB,OAzEEtW,OAAAyB,eACI4T,EAAA3U,UAAA,eAAY,KAGhB,WACE,MAAO,CAACF,KAAK4V,cAAe,yBAAyBzN,KAAK,UAL5D,SACiB1G,GACfzB,KAAK4V,cAAgBnU,mCAgBvBjC,OAAAyB,eACI4T,EAAA3U,UAAA,iBAAc,KADlB,WAEE,OAAOF,KAAKwV,2CAMdhW,OAAAyB,eACI4T,EAAA3U,UAAA,gBAAa,KADjB,WAEE,OAAOF,KAAKyV,0CAMdjW,OAAAyB,eACI4T,EAAA3U,UAAA,kBAAe,KADnB,WAEE,OAAOF,KAAKsV,4CAGPT,EAAAiB,qBAAP,SAA4BC,GAC1B,MAAO,IAQTlB,EAAA3U,UAAAqS,YAAA,SAAYnN,OACJjB,EAAQiB,EAAQjB,MAClBA,GAASA,EAAMqO,eAAiBrO,EAAMsO,gBACpCzS,KAAK4P,UAAYxL,WACnBpE,KAAK4P,QAAQ5H,UAEfhI,KAAK4P,QAAU,IAAI5E,EAAmBhL,KAAKmE,MAAOnE,KAAKiL,SAO3D4J,EAAA3U,UAAAgQ,YAAA,WACElQ,KAAK4P,QAAQ5H,WAOf6M,EAAA3U,UAAA8V,gBAAA,SAAgBD,OACRrF,EAAOqF,EAAOrF,MAAQ,GAC5BqF,EAAO3I,QAAOpE,MAAd+M,EAAM9T,EAAYyO,yBA5JrBD,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,gBACVC,SAAA,23EAEAC,gBAAiBC,EAAAA,wBAAwBC,+hCArBzCC,EAAAA,yBAWO2D,EAAAA,0CA8CN1D,EAAAA,oBAKAA,EAAAA,gCAKAA,EAAAA,0BAKAA,EAAAA,qBAKAA,EAAAA,yBAKAA,EAAAA,wBAKAA,EAAAA,yBAKAA,EAAAA,yBAKAA,EAAAA,4BAKAA,EAAAA,6BAYAA,EAAAA,8BAMAgF,EAAAA,YAAWvF,KAAA,CAAC,2CAQZuF,EAAAA,YAAWvF,KAAA,CAAC,4CAQZuF,EAAAA,YAAWvF,KAAA,CAAC,uBAuCfmE,EA9JA,GCRAqB,EAAA,WAqDE,SAAAA,IArCSlW,KAAAuV,MAAQ,UAKRvV,KAAAwV,WAAY,EAKZxV,KAAAyV,UAAW,EAKXzV,KAAAmW,UAAW,EAKVnW,KAAAoW,QAAgC,IAAI1G,EAAAA,aA8BhD,OAzBElQ,OAAAyB,eAAIiV,EAAAhW,UAAA,QAAK,KAAT,WAAsB,OAAOF,KAAK+V,OAAOpS,uCAKzCnE,OAAAyB,eAAIiV,EAAAhW,UAAA,UAAO,KAAX,WAAwB,OAAOF,KAAK+V,OAAOM,SAAWrW,KAAK2D,uCAK3DnE,OAAAyB,eAAIiV,EAAAhW,UAAA,OAAI,KAAR,WAAqB,OAAOF,KAAK+V,OAAOZ,sCASxCe,EAAAhW,UAAAoW,QAAA,YACwB,IAAlBtW,KAAKmW,UAGTnW,KAAKoW,QAAQ7F,KAAKvQ,KAAK+V,6BAhE1BtF,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,qBACVC,SAAA,kgBAEAC,gBAAiBC,EAAAA,wBAAwBC,sLAOxCE,EAAAA,qBAKAA,EAAAA,yBAKAA,EAAAA,wBAKAA,EAAAA,wBAKAA,EAAAA,uBAKAC,EAAAA,UA8BHgF,EAlEA,GCOAK,EAAA,WAAA,SAAAA,KAciC,2BAdhCC,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAC,EAAAA,kBACAC,EAAAA,gBACAC,EAAAA,cACAC,EAAAA,iBACAC,EAAAA,cACAC,EAAAA,cACAC,EAAAA,eAEFC,QAAS,CAACrC,GACVsC,aAAc,CAACtC,EAAoBqB,OAEJK,EAdjC,GCpBAa,EAAA,WAKA,SAAAA,KAW8B,2BAX7BZ,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAH,GAEFW,QAAS,CACPX,GAEFY,aAAc,GACdE,UAAW,OAEiBD,EAhB9B,GCAAE,EAAA,WAiBE,SAAAA,KACF,OAVE9X,OAAAyB,eACIqW,EAAApX,UAAA,QAAK,KADT,WAEE,OAAOF,KAAKuX,YAEd,SAAU9V,GACRzB,KAAKuX,OAAS9V,uDAXjBgP,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,eACVC,SAAA,qTAICK,EAAAA,SAUHqG,EAlBA,GCAAE,EAAA,WAKA,SAAAA,KAYA,OANSA,EAAAC,QAAP,WACE,MAAO,CACLC,SAAUF,EACVH,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CAACC,EAAAA,cACVS,aAAc,CAACG,GACfJ,QAAS,CAACI,OASZE,EAjBA,GCAAG,EAAA,WAyBE,SAAAA,EAAoBC,GAAA5X,KAAA4X,GAAAA,EAbV5X,KAAA6X,SAAW,IAAInI,EAAAA,aAc3B,OAXEiI,EAAAzX,UAAA4X,iBADA,SACiB1H,EAAmB9P,GAC7BA,IAIAN,KAAK4X,GAAGG,cAAcC,SAAS1X,IAClCN,KAAK6X,SAAStH,KAAKH,yBAbxB6H,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,6DAPVuH,EAAAA,gDAUChH,EAAAA,iCAEAiH,EAAAA,aAAYzH,KAAA,CAAC,iBAAkB,CAAC,SAAU,qBAY7CiH,EA1BA,GCAAS,EAAA,WAGA,SAAAA,KAYA,OANSA,EAAAX,QAAP,WACE,MAAO,CACLC,SAAUU,EACVf,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAACQ,GACfT,QAAS,CAACS,OASZS,EAfA,GCAAC,EAAA,WAEA,SAAAA,KAeA,OAXEA,EAAAnY,UAAAoY,UAAA,SAAU7W,EAAYiP,GACpB,OAAIjP,IAAU2C,UACL3C,EAGLA,aAAiB9B,MACZ8B,EAAMyE,IAAG,SAACqS,GAAO,OAAA/Y,OAAOuF,OAAOvF,OAAOW,OAAOoY,GAAMA,KAEnD/Y,OAAOuF,OAAOvF,OAAOW,OAAOsB,GAAQA,wBAZhD+W,EAAAA,KAAI9H,KAAA,CAAC,CACJsB,KAAM,YAcRqG,EAjBA,GCAAI,EAAA,WAGA,SAAAA,KAYA,OANSA,EAAAhB,QAAP,WACE,MAAO,CACLC,SAAUe,EACVpB,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAACkB,GACfnB,QAAS,CAACmB,OASZI,EAfA,GCAAC,EAAA,WAyCE,SAAAA,EAAoBhF,EAA6BkE,GAA7B5X,KAAA0T,SAAAA,EAA6B1T,KAAA4X,GAAAA,EATzC5X,KAAA2Y,YAAa,EAEX3Y,KAAAiT,OAAgC,IAAIvD,EAAAA,aAkBhD,OAtCElQ,OAAAyB,eACIyX,EAAAxY,UAAA,SAAM,KADV,WAEE,OAAOF,KAAK4Y,aAEd,SAAWnX,GACTzB,KAAK4Y,QAAUnX,mCAIjBjC,OAAAyB,eACIyX,EAAAxY,UAAA,YAAS,KADb,WAEE,OAAOF,KAAK2Y,gBAEd,SAAc1D,GACZA,EAAYjV,KAAK6Y,iBAAmB7Y,KAAK8Y,eACzC9Y,KAAK2Y,WAAa1D,EAClBjV,KAAKiT,OAAO1C,KAAK0E,oCAOnByD,EAAAxY,UAAA6Y,MADA,WAEE/Y,KAAKiV,WAAajV,KAAKiV,WAKjByD,EAAAxY,UAAA2Y,eAAR,WACE7Y,KAAK0T,SAASsF,SAAShZ,KAAKM,OAAQ,iBACpCN,KAAK0T,SAASsF,SAAShZ,KAAK4X,GAAGG,cAAe,cAGxCW,EAAAxY,UAAA4Y,aAAR,WACE9Y,KAAK0T,SAASuF,YAAYjZ,KAAKM,OAAQ,iBACvCN,KAAK0T,SAASuF,YAAYjZ,KAAK4X,GAAGG,cAAe,kCAxCpDE,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,6DAJVuI,EAAAA,iBADAhB,EAAAA,8CAQCjH,EAAAA,yBASAA,EAAAA,sBAWAC,EAAAA,sBAEAiH,EAAAA,aAAYzH,KAAA,CAAC,YAgBhBgI,EApDA,GCAAS,EAAA,WA0BE,SAAAA,IAXQnZ,KAAAoZ,OAAS,GASTpZ,KAAA2Y,YAAa,EAGvB,OAnBEnZ,OAAAyB,eACIkY,EAAAjZ,UAAA,QAAK,KADT,WAEE,OAAOF,KAAKoZ,YAEd,SAAU3X,GACRzB,KAAKoZ,OAAS3X,mCAIhBjC,OAAAyB,eACIkY,EAAAjZ,UAAA,YAAS,KADb,WAEE,OAAOF,KAAK2Y,gBAEd,SAAclX,GACZzB,KAAK2Y,WAAalX,uDApBrBgP,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,kBACVC,SAAA,0gBAICK,EAAAA,yBASAA,EAAAA,SAUHkI,EA3BA,GCAAE,EAAA,WAMA,SAAAA,KAYA,OANSA,EAAA5B,QAAP,WACE,MAAO,CACLC,SAAU2B,EACVhC,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CAACI,EAAAA,cAAeG,EAAAA,eACzBG,aAAc,CAACgC,EAAsBT,GACrCxB,QAAS,CAACiC,EAAsBT,OASlCW,EAlBA,GCAAC,EAAA,WAWE,SAAAA,EAAmBC,GAAAvZ,KAAAuZ,UAAAA,EACrB,2BATC9I,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,qBACVC,SAAA,6kBAJO4I,EAAAA,gBAWTF,EAZA,GCAAG,EAAA,WASE,SAAAA,EAAoBC,GAAA1Z,KAAA0Z,OAAAA,EAUtB,OARSD,EAAAvZ,UAAAyZ,KAAP,SAAYC,OACJL,EAAYvZ,KAAK0Z,OAAOC,KAAKL,EAAwB,CACzDO,cAAc,IAIhB,OAFAN,EAAUO,kBAAkBC,eAAiBH,EAEtCL,EAAUS,mCAVpBC,EAAAA,sDANQC,EAAAA,aAkBTT,EAnBA,GCAAU,EAAA,WAQA,SAAAA,KAcA,OANSA,EAAA1C,QAAP,WACE,MAAO,CACLC,SAAUyC,EACV9C,UAAW,yBAXhBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CAACG,EAAAA,gBAAiBwD,EAAAA,gBAAiBzD,EAAAA,mBAC5CQ,aAAc,CAACmC,GACfpC,QAAS,CAACoC,GACVjC,UAAW,CAACoC,GACZY,gBAAiB,CAACf,OASpBa,EAtBA,GCAAG,GAAA,WA0BE,SAAAA,EACSxF,EACAyF,EACCC,GAFDxa,KAAA8U,QAAAA,EACA9U,KAAAua,iBAAAA,EACCva,KAAAwa,WAAAA,EALAxa,KAAAya,aAAe,IAAI/K,EAAAA,aAyE/B,OAhES4K,EAAApa,UAAAwa,cADP,SACqBnU,GADrB,IAAA1B,EAAA7E,KACuB2a,EAAApU,EAAAoU,EAAGC,EAAArU,EAAAqU,EACxB5a,KAAK6a,QACLzK,MAAM0K,iBACN9a,KAAKya,aAAalK,KAAK,CAAEoK,EAACA,EAAEC,EAACA,IAC7B5a,KAAK+a,WAAa,SACZC,EAAmBhb,KAAK8U,QAC3BmG,WACAC,oBAAoB,CAAEP,EAACA,EAAEC,EAACA,IAC1BO,cAAc,CACb,CACEC,QAAS,MACTC,QAAS,SACTC,SAAU,QACVC,SAAU,SAGhBvb,KAAK+a,WAAa/a,KAAK8U,QAAQ3U,OAAO,CACpC6a,iBAAgBA,EAChBQ,eAAgBxb,KAAK8U,QAAQ2G,iBAAiBZ,UAEhD7a,KAAK+a,WAAWW,OACd,IAAIC,EAAAA,eAAe3b,KAAK4b,YAAa5b,KAAKua,iBAAkB,CAC1DsB,UAAWzX,aAIfpE,KAAK8b,IAAMC,EAAAA,UAAsBC,SAAU,SACxCtU,KACCG,EAAAA,OAAM,SAACuI,OACC6L,EAAc7L,EAAY,OAEhC,OADAvL,EAAKgW,UAEDhW,EAAKkW,aACNlW,EAAKkW,WAAWmB,eAAelE,SAASiE,KAG7CE,EAAAA,KAAK,IAENxT,UAAS,WAAO,OAAA9D,EAAKgW,UAExB7a,KAAK8b,IAAMC,EAAAA,UAAsBC,SAAU,eACxCtU,KACCG,EAAAA,OAAM,SAACuI,OACC6L,EAAc7L,EAAY,OAChC,GACE6L,IACCpX,EAAK2V,WAAWzC,cAAcC,SAASiE,KACvCpX,EAAKkW,WAAWmB,eAAelE,SAASiE,GAEzC,OAAO,EAEP7L,EAAM0K,mBAGVqB,EAAAA,KAAK,IAENxT,UAAS,WAAO,OAAA9D,EAAKgW,WAE1BP,EAAApa,UAAA2a,MAAA,WACM7a,KAAK+a,aACP/a,KAAK+a,WAAWqB,UAChBpc,KAAK+a,WAAa,2BA9EvB9C,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,gEAHHgE,EAAAA,eANP0H,EAAAA,wBANAnE,EAAAA,mDAqBCjH,EAAAA,MAAKP,KAAA,CAAC,wCACNQ,EAAAA,8BAQAiH,EAAAA,aAAYzH,KAAA,CAAC,cAAe,CAAC,cAiEhC4J,EAjGA,GCAAgC,GAAA,WAGA,SAAAA,KAYA,OANSA,EAAA7E,QAAP,WACE,MAAO,CACLC,SAAU4E,EACVjF,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAACmD,IACfpD,QAAS,CAACoD,QASZgC,EAfA,GCAAC,GAAA,WAiBE,SAAAA,IAFQvc,KAAAwc,MAAQ,GAGlB,OAVEhd,OAAAyB,eACIsb,EAAArc,UAAA,OAAI,KADR,WAEE,OAAOF,KAAKwc,WAEd,SAAS/a,GACPzB,KAAKwc,MAAQ/a,uDAXhBgP,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,kBACVC,SAAA,uLAICK,EAAAA,SAUHsL,EAlBA,GCAAE,GAAA,WAKE,SAAAA,EAAoBC,GAAA1c,KAAA0c,WAAAA,EAKtB,OAHED,EAAAvc,UAAAoY,UAAA,SAAUqE,GACR,OAAO3c,KAAK0c,WAAWE,wBAAwBD,wBALlDnE,EAAAA,KAAI9H,KAAA,CAAC,CAAEsB,KAAM,4DAFL6K,EAAAA,gBASTJ,EAVA,GCAAK,GAAA,WAcA,SAAAA,KAkBA,OALSA,EAAArF,QAAP,WACE,MAAO,CACLC,SAAUoF,wBAfftG,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAG,EAAAA,cACAC,EAAAA,iBACAiG,EAAAA,eACAnG,EAAAA,gBACAD,EAAAA,mBAEFO,QAAS,CAACuF,GAAkBF,IAC5BpF,aAAc,CAACsF,GAAkBF,QAQnCO,EAhCA,iBCSA,SAAAE,IAKWhd,KAAAid,kBAAmC,GAExBjd,KAAAkd,aAAqC,IAAIxN,EAAAA,aAEzC1P,KAAAmd,aAAqC,IAAIzN,EAAAA,aAEpB1P,KAAAod,WAAa,UAuDxD,OApDSJ,EAAA9c,UAAAmd,WADP,SACkBC,GAChBA,EAAIxC,iBACJwC,EAAIC,kBACJvd,KAAKod,WAAa,QAIbJ,EAAA9c,UAAAsd,YADP,SACmBF,GACjBA,EAAIxC,iBACJwC,EAAIC,kBACJvd,KAAKod,WAAa,WAIbJ,EAAA9c,UAAAud,OADP,SACcH,GACZA,EAAIxC,iBACJwC,EAAIC,kBACJvd,KAAKod,WAAa,cACZM,EAAW1d,KAAK2d,gBAAgBL,GAClCI,EAASE,MAAMjd,QACjBX,KAAKkd,aAAa3M,KAAKmN,EAASE,OAE9BF,EAASG,QAAQld,QACnBX,KAAKmd,aAAa5M,KAAKmN,EAASG,UAI5Bb,EAAA9c,UAAAyd,gBAAR,SAAwBL,WAChBQ,EAAQR,EAAIS,aAAaD,MACzBJ,EAAW,CACfE,MAAO,GACPC,QAAS,IAEX,GAAmB,EAAfC,EAAMnd,WACR,IAAmB,IAAAqd,EAAAhS,EAAA8R,GAAKG,EAAAD,EAAAxc,QAAAyc,EAAAvc,KAAAuc,EAAAD,EAAAxc,OAAE,CAArB,IAAM0c,EAAID,EAAAxc,MACP0c,EAAMD,EAAKlM,KAAKoM,MAAM,KAAKF,EAAKlM,KAAKoM,MAAM,KAAKzd,OAAS,GAE3B,IAAlCX,KAAKid,kBAAkBtc,SAEwB,IAA7CX,KAAKid,kBAAkBoB,YAAYF,IACrB,IAAdD,EAAK3Z,KAGPmZ,EAASE,MAAM7b,KAAKmc,GAEpBR,EAASG,QAAQ9b,KAAKmc,wGAK5B,OAAOR,uBAhEVzF,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,kEAITM,EAAAA,4BAEAC,EAAAA,6BAEAA,EAAAA,2BAEA+E,EAAAA,YAAWvF,KAAA,CAAC,wCAEZyH,EAAAA,aAAYzH,KAAA,CAAC,WAAY,CAAC,gCAO1ByH,EAAAA,aAAYzH,KAAA,CAAC,YAAa,CAAC,2BAO3ByH,EAAAA,aAAYzH,KAAA,CAAC,OAAQ,CAAC,cAuCzBsM,KC3EAsB,GAAA,WAGA,SAAAA,KAYA,OANSA,EAAA7G,QAAP,WACE,MAAO,CACLC,SAAU4G,EACVjH,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAAC6F,IACf9F,QAAS,CAAC8F,QASZsB,EAfA,iBC0CE,SAAAC,EAAoBC,GAAAxe,KAAAwe,iBAAAA,EAjBZxe,KAAAye,cAAgC,GAUhCze,KAAA0e,OAA+B,GAK/B1e,KAAA2e,YAAqD,GA2F/D,OAlFEJ,EAAAre,UAAA0e,UAAA,SAAUte,GACRN,KAAKM,OAASA,EACdN,KAAK6e,aAAeve,EAAOwe,gBAAgB9e,KAAKwe,kBAChDxe,KAAK+e,aAAa/e,KAAK0e,QACvB1e,KAAKgf,kBAAkBhf,KAAK2e,cAO9BJ,EAAAre,UAAA8H,QAAA,WACMhI,KAAKM,SAAW8D,WAClBpE,KAAKM,OAAOgE,QAEVtE,KAAK6e,eAAiBza,YACxBpE,KAAK6e,aAAa7W,UAClBhI,KAAK6e,aAAeza,WAEtBpE,KAAKif,kBAOPV,EAAAre,UAAA6e,aAAA,SAAaL,GAEX,GADA1e,KAAK0e,OAASA,EACV1e,KAAK6e,eAAiBza,UAA1B,KAIM8a,EAAWlf,KAAK6e,aAAaK,SACblf,KAAKwe,iBAAiBE,OAC9B5Z,QAAO,SAAErD,OACflB,EAAMkB,EAAM0d,SACdT,EAAO7e,eAAeU,KACxB2e,EAAS3e,GAAOme,EAAOne,MAIqB,mBAArC,EAAkB6e,gBAC3B,EAAkBA,mBAQtBb,EAAAre,UAAA8e,kBAAA,SAAkBL,GAAlB,IAAA9Z,EAAA7E,KAEE,GADAA,KAAK2e,YAAcA,EACf3e,KAAK6e,eAAiBza,UAA1B,KAIM8a,EAAWlf,KAAK6e,aAAaK,SACRlf,KAAKwe,iBAAiBa,QAC9Bva,QAAO,SAAErD,OACpBlB,EAAMkB,EAAM0d,SAClB,GAAIR,EAAY9e,eAAeU,GAAM,KAC7B+e,EAAUJ,EAAS3e,GACnBgf,EAAaZ,EAAYpe,GAC3BZ,MAAM6f,QAAQD,GAChBA,EAAWza,QAAO,SAAE2a,GAClB5a,EAAK4Z,cAAc1c,KAAKud,EAAQ3W,UAAU8W,MAG5C5a,EAAK4Z,cAAc1c,KAAKud,EAAQ3W,UAAU4W,SAS1ChB,EAAAre,UAAA+e,eAAR,WACEjf,KAAKye,cAAc3Z,QAAO,SAAE4a,GAAoB,OAAAA,EAAExX,gBAClDlI,KAAKye,cAAgB,IAGzBF,KCzHAoB,GAAA,WAKE,SAAAA,EAAoBC,GAAA5f,KAAA4f,SAAAA,SAOpBD,EAAAzf,UAAAC,OAAA,SAAO0f,OACCC,EAAU9f,KAAK4f,SAASG,wBAAuB,GACrD,OAAO,IAAIxB,GAAsCuB,wBAdpD7F,EAAAA,WAAUvJ,KAAA,CAAC,CACVsP,WAAY,oDAVZC,EAAAA,uKASF,GCVAC,GAAA,WAmDE,SAAAA,EACUC,EACAlV,GADAjL,KAAAmgB,wBAAAA,EACAngB,KAAAiL,MAAAA,EArBDjL,KAAA0e,OAAiC,GAKjC1e,KAAA2e,YAAuD,GAuGlE,OA9EEuB,EAAAhgB,UAAAqS,YAAA,SAAYnN,OACJgb,EAAYhb,EAAQgb,UACpB1B,EAAStZ,EAAQsZ,OACjBC,EAAcvZ,EAAQuZ,YACtB0B,EAAK3W,EAAAA,YAAY0C,qBAEvB,GAAIgU,GAAaA,EAAU5N,eAAiB4N,EAAU3N,cACpDzS,KAAK8e,gBAAgBsB,EAAU5N,kBAC1B,KACC8N,EACJ5B,GAAU2B,EAAG3B,EAAOlM,cAAgB,GAAIkM,EAAOjM,eAAiB,IAC5D8N,EACJ5B,GACA0B,EAAG1B,EAAYnM,cAAgB,GAAImM,EAAYlM,eAAiB,KAErC,IAAzB6N,GACFtgB,KAAK+e,gBAG2B,IAA9BwB,GACFvgB,KAAKgf,oBAGThf,KAAKiL,MAAMM,iBAOb2U,EAAAhgB,UAAAgQ,YAAA,WACMlQ,KAAKwgB,kBACPxgB,KAAKwgB,iBAAiBxY,WAQlBkY,EAAAhgB,UAAA4e,gBAAR,SAAwBsB,GAClBpgB,KAAKwgB,mBAAqBpc,WAC5BpE,KAAKwgB,iBAAiBxY,UAExBhI,KAAKwgB,iBACHJ,aAAqB7B,GACjB6B,EACApgB,KAAKmgB,wBAAwBhgB,OAAOigB,GAC1CpgB,KAAKygB,mBAOCP,EAAAhgB,UAAAugB,gBAAR,WACEzgB,KAAK+e,eACL/e,KAAKgf,oBACLhf,KAAKwgB,iBAAiB5B,UAAU5e,KAAKM,SAQ/B4f,EAAAhgB,UAAA6e,aAAR,WACE/e,KAAKwgB,iBAAiBzB,aAAa/e,KAAK0e,SAQlCwB,EAAAhgB,UAAA8e,kBAAR,WACEhf,KAAKwgB,iBAAiBxB,kBAAkBhf,KAAK2e,kCAzHhDlO,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,qBACVC,SAAA,0CAEAC,gBAAiBC,EAAAA,wBAAwBC,2GANlC4O,UAbP3O,EAAAA,wDAyBCC,EAAAA,sBAKAA,EAAAA,2BAKAA,EAAAA,sBAWAyP,EAAAA,UAAShQ,KAAA,CAAC,SAAU,CAAEiQ,KAAMtE,EAAAA,sBA4F/B6D,EA5IA,GCQAU,GAAA,WAAA,SAAAA,KAWqC,2BAXpCpK,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,cAEFQ,QAAS,CACPgJ,IAEF/I,aAAc,CACZ+I,QAGiCU,EAXrC,GCRAC,GAAA,WAMA,SAAAA,KAYwC,2BAZvCrK,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAkK,IAEF1J,QAAS,CACP0J,IAEFvJ,UAAW,CACTsI,QAGoCkB,EAlBxC,GCAAC,GAAA,WA6GE,SAAAA,EAAoBlJ,EAAwBmJ,GAAxB/gB,KAAA4X,GAAAA,EAAwB5X,KAAA+gB,aAAAA,EAtFpC/gB,KAAAghB,SAAW,IASXhhB,KAAA2Y,WAAa,IASb3Y,KAAAihB,UAAY,OASZjhB,KAAAkhB,eAAyBlhB,KAAKmhB,SAS9BnhB,KAAAohB,iBAA2BphB,KAAKiV,UAShCjV,KAAAqhB,gBAA0BrhB,KAAKmhB,SAS/BnhB,KAAAshB,WAAgC,SA8BhCthB,KAAAuhB,OAAwB,UAuBlC,OAlHE/hB,OAAAyB,eACI6f,EAAA5gB,UAAA,UAAO,KADX,WAEE,OAAOF,KAAKghB,cAEd,SAAYvf,GACVzB,KAAKghB,SAAWvf,mCAIlBjC,OAAAyB,eACI6f,EAAA5gB,UAAA,YAAS,KADb,WAEE,OAAOF,KAAK2Y,gBAEd,SAAclX,GACZzB,KAAK2Y,WAAalX,mCAIpBjC,OAAAyB,eACI6f,EAAA5gB,UAAA,WAAQ,KADZ,WAEE,OAAOF,KAAKihB,eAEd,SAAaxf,GACXzB,KAAKihB,UAAYxf,mCAInBjC,OAAAyB,eACI6f,EAAA5gB,UAAA,gBAAa,KADjB,WAEE,OAAOF,KAAKkhB,oBAEd,SAAkBzf,GAChBzB,KAAKkhB,eAAiBzf,mCAIxBjC,OAAAyB,eACI6f,EAAA5gB,UAAA,kBAAe,KADnB,WAEE,OAAOF,KAAKohB,sBAEd,SAAoB3f,GAClBzB,KAAKohB,iBAAmB3f,mCAI1BjC,OAAAyB,eACI6f,EAAA5gB,UAAA,iBAAc,KADlB,WAEE,OAAOF,KAAKqhB,qBAEd,SAAmB5f,GACjBzB,KAAKqhB,gBAAkB5f,mCAIzBjC,OAAAyB,eACI6f,EAAA5gB,UAAA,YAAS,KADb,WAEE,OAAOF,KAAKshB,gBAEd,SAAc7f,GACZzB,KAAKshB,WAAa7f,mCAIpBjC,OAAAyB,eACI6f,EAAA5gB,UAAA,QAAK,KADT,WAEE,OAAOF,KAAKuhB,YAEd,SAAU9f,GAAV,IAAAoD,EAAA7E,KACQwhB,EAAQ,CACZC,QAASzhB,KAAKyhB,QACdxM,UAAWjV,KAAKiV,UAChBkM,SAAUnhB,KAAKmhB,UAIH,WADAnhB,KAAK+gB,aAAaW,OAAOjgB,OAErCjC,OAAOuF,OAAOyc,EAAO,CACnBC,QAASzhB,KAAK2hB,cACd1M,UAAWjV,KAAK4hB,gBAChBT,SAAUnhB,KAAK6hB,qBAIbtd,EAAOid,EAAM/f,GACf8C,IAASH,YACXpE,KAAK8hB,QAAQvd,GACbwd,WAAU,WACRld,EAAK0c,OAAS9f,GACbqf,EAAkBkB,kDAOzBlB,EAAA5gB,UAAAyP,SAAA,WAAA,IAAA9K,EAAA7E,KACEA,KAAK4X,GAAGG,cAAckK,WAAajiB,KAAK6J,UAIxC7J,KAAK+gB,aAAaW,OAAO/Y,UAAS,SAC/BuZ,GAAiB,OAACrd,EAAKH,MAAQG,EAAKH,SAIjCoc,EAAA5gB,UAAA4hB,QAAR,SAAgBvd,GACdvE,KAAKuhB,OAAS,aAES,WAAnBvhB,KAAK6J,UACP7J,KAAKmiB,KAAKpK,cAAcqK,MAAMC,OAAS9d,EACX,QAAnBvE,KAAK6J,YACd7J,KAAKmiB,KAAKpK,cAAcqK,MAAME,MAAQ/d,IAnHnCuc,EAAAkB,eAAiB,wBANzBvR,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,eACVC,SAAA,4/BAR4CsH,EAAAA,kBAE9BqK,EAAAA,8CAYb7B,EAAAA,UAAShQ,KAAA,CAAC,iCAEVO,EAAAA,yBASAA,EAAAA,wBASAA,EAAAA,6BASAA,EAAAA,+BASAA,EAAAA,8BASAA,EAAAA,yBASAA,EAAAA,qBASAA,EAAAA,SAmDH6P,EAlIA,GCAA0B,GAAA,WAGA,SAAAA,KAYA,OANSA,EAAA/K,QAAP,WACE,MAAO,CACLC,SAAU8K,EACVnL,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAAC2J,IACf5J,QAAS,CAAC4J,QASZ0B,EAfA,GCIA,SAAgBC,GAAsBC,GACpC,GAAIA,EAAQC,UAAW,KACfA,EAAYD,EAAQC,UAAS,IACnC,GAAIA,GAAaA,EAAUC,SACzB,OAAO,EAIX,QAAI,EAAiBC,UACKrjB,OAAO0F,KAAK,EAAiB2d,UAAUrb,KAAI,SAAEjH,GACnE,OAAOkiB,GAAsB,EAAiBI,SAAStiB,QAE9B6D,UAM/B,SAAgB0e,KACd,MAAO,CACLF,SAAU,mCAId,SAAgBG,GAAuBL,EAA0BM,OACzDC,EAASP,EAAQO,QAAU,GAE3BC,EADY1jB,OAAO0F,KAAK+d,GAE3B/c,IAAG,SAAE3F,GAAgB,OAAAyiB,EAASziB,KAC9BsH,OAAM,SAAE+R,GAAoB,OAAAA,IAAYxV,YAC3C,OAA8B,EAAvB8e,EAAcviB,OAAauiB,EAAc,GAAK,GAGvD,SAAgBC,GAAiBC,GAC/B,OAAOA,EAAKC,OAAO1d,OAAM,SAAEC,EAAkB0d,GAC3C,OAAO1d,EAAI1D,OAAOohB,EAAMC,SACvB,GAAGrhB,OAAOkhB,EAAKG,SCpBpB,IAAAC,GAAA,WA6BE,SAAAA,IARUxjB,KAAAyjB,WAAa,IAAI/T,EAAAA,aAoE7B,OAhEElQ,OAAAyB,eAAIuiB,EAAAtjB,UAAA,aAAU,KAAd,WACE,OAAsD,IAA/CF,KAAK0jB,QAAQ3L,cAAc4L,SAAShjB,wCAS7C6iB,EAAAtjB,UAAAqS,YAAA,SAAYnN,OACJwe,EAAWxe,EAAQwe,SACrBA,GAAYA,EAASpR,eAAiBoR,EAASnR,gBAC7CmR,EAASpR,eAAiBpO,UAC5BpE,KAAKsE,QAELtE,KAAK6jB,QAAQD,EAASpR,gBAU5BgR,EAAAtjB,UAAA4jB,SAAA,WACE9jB,KAAKyjB,WAAWlT,KAAKvQ,KAAK+jB,YAGpBP,EAAAtjB,UAAA2jB,QAAR,SAAgBG,GACdhkB,KAAKojB,KAAKG,OAAOze,QAAO,SAAEmf,GACxBA,EAAMvB,QAAQwB,SAAS9gB,EAAE4gB,EAAMC,EAAMjS,MAAM3O,cAG7CrD,KAAKojB,KAAKC,OAAOve,QAAO,SAAEwe,GACxBA,EAAMC,OAAOze,QAAO,SAAEmf,GACpBA,EAAMvB,QAAQwB,SAAS9gB,EAAE4gB,EAAMC,EAAMjS,MAAM3O,iBAKzCmgB,EAAAtjB,UAAA6jB,QAAR,WAAA,IAAAlf,EAAA7E,KACQgkB,EAAO,GAIb,OAHAb,GAAiBnjB,KAAKojB,MAAMte,QAAO,SAAEmf,GACnCpf,EAAKsf,wBAAwBH,EAAMC,KAE9BD,GAGDR,EAAAtjB,UAAAikB,wBAAR,SAAgCH,EAA6BC,OACrDvB,EAAUuB,EAAMvB,QACjBA,EAAQvM,WACX6N,EAAKC,EAAMjS,MAAQ0Q,EAAQjhB,QAOvB+hB,EAAAtjB,UAAAoE,MAAR,WACEtE,KAAKojB,KAAKV,QAAQ0B,6BAtFrB3T,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,WACVC,SAAA,6YAEAC,gBAAiBC,EAAAA,wBAAwBC,8RAOxCE,EAAAA,wBAKAA,EAAAA,0BAKAC,EAAAA,wBAEAwP,EAAAA,UAAShQ,KAAA,CAAC,cAkEb8S,EAzFA,GCXAa,GAAA,WAAA,SAAAA,KAegC,2BAf/B7N,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACA4N,EAAAA,YACAC,EAAAA,qBAEFrN,QAAS,CACPsM,GACAc,EAAAA,YACAC,EAAAA,qBAEFpN,aAAc,CACZqM,QAG4Ba,EAfhC,GCJAG,GAAA,WAWE,SAAAA,YAJOA,EAAAC,SAAP,SAAgB1X,EAAcqT,GAC5BoE,EAAiBjB,OAAOxW,GAAQqT,GAUlCoE,EAAAtkB,UAAAwkB,eAAA,SAAe3X,GACb,OAAOyX,EAAiBjB,OAAOxW,IAd1ByX,EAAAjB,OAA+B,uBALvCtJ,EAAAA,WAAUvJ,KAAA,CAAC,CACVsP,WAAY,sJADd,GCLA2E,GAAA,WAgBE,SAAAA,EAAoBC,GAAA5kB,KAAA4kB,YAAAA,SAEpBD,EAAAzkB,UAAAkjB,KAAA,SAAKG,EAAqBF,OAClBX,EAAU1iB,KAAK4kB,YAAYtB,MAAM,IAQvC,OAPAC,EAAOze,QAAO,SAAEmf,GACdvB,EAAQmC,WAAWZ,EAAMjS,KAAMiS,EAAMvB,WAEvCW,EAAOve,QAAO,SAAEwe,GACdZ,EAAQmC,WAAWvB,EAAMtR,KAAMsR,EAAMZ,WAGhC,CAACa,OAAMA,EAAEF,OAAMA,EAAEX,QAAOA,IAGjCiC,EAAAzkB,UAAAojB,MAAA,SAAMwB,EAA8BvB,OAC5Bzf,EAAUghB,EAAOhhB,SAAW,GAC5B4e,EAAU1iB,KAAK4kB,YAAYtB,MAAM,IAMvC,OALAC,EAAOze,QAAO,SAAEmf,GACdvB,EAAQmC,WAAWZ,EAAMjS,KAAMiS,EAAMvB,WAEvCA,EAAQqC,cAAcjhB,EAAQ6e,WAEvBnjB,OAAOuF,OAAO,GAAI+f,EAAQ,CAACvB,OAAMA,EAAEb,QAAOA,KAGnDiC,EAAAzkB,UAAA+jB,MAAA,SAAMa,OACEhhB,EAAUghB,EAAOhhB,SAAW,GAC5BY,EAAQlF,OAAOuF,OAAO,CAACtD,MAAO,IAAK,CACvC0U,SAAUrS,EAAQqS,WAEduM,EAAU1iB,KAAK4kB,YAAYlC,QAAQhe,GAGzC,OAFAge,EAAQqC,cAAcjhB,EAAQ6e,WAEvBnjB,OAAOuF,OAAO,CAACgI,KAAM,QAAS+X,EAAQ,CAACpC,QAAOA,KAGvDiC,EAAAzkB,UAAA8kB,kBAAA,SAAkBF,EAAyBG,OACnCnhB,EAAUtE,OAAOuF,OAAO,GAAI+f,EAAOhhB,SAAW,GAAImhB,EAAQnhB,SAAW,IACrE4a,EAASlf,OAAOuF,OAAO,GAAI+f,EAAOpG,QAAU,GAAIuG,EAAQvG,QAAU,IAClEC,EAAcnf,OAAOuF,OAAO,GAAI+f,EAAOnG,aAAe,GAAIsG,EAAQtG,aAAe,IACvF,OAAOnf,OAAOuF,OAAO,GAAI+f,EAAQ,CAAChhB,QAAOA,EAAE4a,OAAMA,EAAEC,YAAWA,yBA7CjE1E,EAAAA,WAAUvJ,KAAA,CAAC,CACVsP,WAAY,oDAXLkF,EAAAA,6IADT,GCEA,SAAgBC,GAAmBpY,GACjC,OAAA,SAAQqY,GACNZ,GAAiBC,SAAS1X,EAAMqY,ICUpC,IAAAC,GAAA,WAiBE,SAAAC,EAAoBC,GAAAvlB,KAAAulB,iBAAAA,EAwBtB,OA5BE/lB,OAAAyB,eAAIkkB,EAAAA,UAAAA,eAAY,KAAhB,WACE,OAAOnlB,KAAKikB,MAAMngB,SAAW,oCAK/BqhB,EAAAA,UAAAA,kBAAA,WACE,OAAOnlB,KAAKulB,iBAAiBb,eAAe1kB,KAAKikB,MAAMlX,MAAQ,SAGjEoY,EAAAA,UAAAA,eAAA,eACQlC,EAASjjB,KAAKwlB,aAAavC,QAAU,GAC3C,OAAOzjB,OAAOuF,OACZ,CACE0gB,YAAazlB,KAAKikB,MAAMtgB,MACxB+hB,cAAe1lB,KAAKwlB,aAAaE,gBAAiB,GAEpDlmB,OAAOuF,OAAO,GAAI/E,KAAKikB,MAAMvF,QAAU,IACvC,CACEiH,YAAa3lB,KAAKikB,MAAMvB,QACxBO,OAAQzjB,OAAOuF,OAAO,GNxBrB,CACL6d,SAAU,mCMuB+CK,MAK3DkC,EAAAA,UAAAA,oBAAA,WACE,OAAO3lB,OAAOuF,OAAO,GAAI/E,KAAKikB,MAAMtF,aAAe,yBAvCtDlO,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,iBACVC,SAAA,0PAEAC,gBAAiBC,EAAAA,wBAAwBC,wJAXlCyT,qCAkBNvT,EAAAA,SA8BHqU,EAzCA,iBCGA,SAAAM,IAUE5lB,KAAA6lB,UAAsC,IAAIhf,EAAAA,iBAAgB,GAgCjD7G,KAAA0lB,eAAyB,EAkCpC,OAnDElmB,OAAAyB,eACI2kB,EAAA1lB,UAAA,UAAO,KADX,SACYuB,GACNA,aAAiBqkB,EAAAA,WACnB9lB,KAAK+lB,SAAWtkB,EAEhBzB,KAAK+lB,SAAWzY,EAAAA,GAAG7L,oCAiBvBjC,OAAAyB,eAAI2kB,EAAA1lB,UAAA,WAAQ,KAAZ,WACE,OAAOuiB,GAAsBziB,KAAK2lB,8CAGpCC,EAAA1lB,UAAAyP,SAAA,WACE3P,KAAK6lB,UAAUrkB,KAAKxB,KAAK2lB,YAAYxP,WAMvCyP,EAAA1lB,UAAA8lB,gBAAA,WACE,OAAOjD,GAAuB/iB,KAAK2lB,YAAa3lB,KAAKijB,SAGvD2C,EAAA1lB,UAAA+lB,qBAAA,WACEjmB,KAAKkmB,kBAGCN,EAAA1lB,UAAAgmB,eAAR,eACQ/P,GAAYnW,KAAK6lB,UAAUpkB,OAChB,IAAb0U,EACFnW,KAAK2lB,YAAYQ,UAEjBnmB,KAAK2lB,YAAYS,SAEnBpmB,KAAK6lB,UAAUrkB,KAAK2U,wBAxEvB1F,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,wBACVC,SAAA,iqBACAC,gBAAiBC,EAAAA,wBAAwBC,gDAWxCE,EAAAA,2BAKAA,EAAAA,uBAKAA,EAAAA,sBAYAA,EAAAA,6BAKAA,EAAAA,SApCU2U,EAAwBxlB,EAAA,CANpC+kB,GAAmB,WAMPS,oBCJb,SAAAS,IAQErmB,KAAA6lB,UAAsC,IAAIhf,EAAAA,iBAAgB,GAoBjD7G,KAAA0lB,eAAyB,EAkCpC,OA7BElmB,OAAAyB,eAAIolB,EAAAnmB,UAAA,WAAQ,KAAZ,WACE,OAAOuiB,GAAsBziB,KAAK2lB,8CAGpCU,EAAAnmB,UAAAyP,SAAA,WACE3P,KAAK6lB,UAAUrkB,KAAKxB,KAAK2lB,YAAYxP,WAMvCkQ,EAAAnmB,UAAA8lB,gBAAA,WACE,OAAOjD,GAAuB/iB,KAAK2lB,YAAa3lB,KAAKijB,SAGvDoD,EAAAnmB,UAAA+lB,qBAAA,WACEjmB,KAAKkmB,kBAGCG,EAAAnmB,UAAAgmB,eAAR,eACQ/P,GAAYnW,KAAK6lB,UAAUpkB,OAChB,IAAb0U,EACFnW,KAAK2lB,YAAYQ,UAEjBnmB,KAAK2lB,YAAYS,SAEnBpmB,KAAK6lB,UAAUrkB,KAAK2U,wBA1DvB1F,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,sBACVC,SAAA,uhBACAC,gBAAiBC,EAAAA,wBAAwBC,gDASxCE,EAAAA,2BAKAA,EAAAA,sBAKAA,EAAAA,6BAKAA,EAAAA,SAtBUoV,EAAsBjmB,EAAA,CANlC+kB,GAAmB,SAMPkB,oBCTb,SAAAC,IAQEtmB,KAAA6lB,UAAsC,IAAIhf,EAAAA,iBAAgB,GAoBjD7G,KAAA0lB,eAAyB,EAkCpC,OA7BElmB,OAAAyB,eAAIqlB,EAAApmB,UAAA,WAAQ,KAAZ,WACE,OAAOuiB,GAAsBziB,KAAK2lB,8CAGpCW,EAAApmB,UAAAyP,SAAA,WACE3P,KAAK6lB,UAAUrkB,KAAKxB,KAAK2lB,YAAYxP,WAMvCmQ,EAAApmB,UAAA8lB,gBAAA,WACE,OAAOjD,GAAuB/iB,KAAK2lB,YAAa3lB,KAAKijB,SAGvDqD,EAAApmB,UAAA+lB,qBAAA,WACEjmB,KAAKkmB,kBAGCI,EAAApmB,UAAAgmB,eAAR,eACQ/P,GAAYnW,KAAK6lB,UAAUpkB,OAChB,IAAb0U,EACFnW,KAAK2lB,YAAYQ,UAEjBnmB,KAAK2lB,YAAYS,SAEnBpmB,KAAK6lB,UAAUrkB,KAAK2U,wBA1DvB1F,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,0BACVC,SAAA,2iBACAC,gBAAiBC,EAAAA,wBAAwBC,gDASxCE,EAAAA,2BAKAA,EAAAA,sBAKAA,EAAAA,6BAKAA,EAAAA,SAtBUqV,EAA0BlmB,EAAA,CANtC+kB,GAAmB,aAMPmB,MCDbC,GAAA,WAAA,SAAAA,KAyBiC,2BAzBhC/P,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACA4N,EAAAA,YACAC,EAAAA,oBACA1N,EAAAA,cACA2P,EAAAA,mBACAzJ,EAAAA,eACA0J,EAAAA,gBACA9P,EAAAA,kBACAiK,IAEF1J,QAAS,CACPiO,GACAS,GACAS,GACAC,IAEFnP,aAAc,CACZgO,GACAS,GACAS,GACAC,QAG6BC,EAzBjC,GCNAG,GAAA,WAuBE,SAAAA,KAuCF,OAzCElnB,OAAAyB,eAAIylB,EAAAxmB,UAAA,cAAW,KAAf,WAA+B,OAAOF,KAAKsjB,MAAMZ,yCAWjDgE,EAAAxmB,UAAAymB,gBAAA,SAAgB1C,OACV2C,EAAU,EACR9iB,EAAUmgB,EAAMngB,SAAW,GAKjC,OAJIA,EAAQ+iB,MAAuB,EAAf/iB,EAAQ+iB,OAC1BD,EAAUE,KAAKC,IAAIjjB,EAAQ+iB,KAAM,IAG5BD,GAUTF,EAAAxmB,UAAA8mB,gBAAA,SAAgB/C,SAEd,OAAA1d,EAAA,IAAS,0BADOvG,KAAK2mB,gBAAgB1C,KACU,EAAI1d,GAMrDmgB,EAAAxmB,UAAA8lB,gBAAA,eACQliB,EAAU9D,KAAKsjB,MAAMxf,SAAW,GACtC,OAAOif,GAAuB/iB,KAAK2lB,YAAa7hB,EAAQmf,QAAU,yBA3DrExS,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,iBACVC,SAAA,ueAEAC,gBAAiBC,EAAAA,wBAAwBC,0SAOxCE,EAAAA,sBAKAA,EAAAA,SA8CHyV,EA9DA,GCHAO,GAAA,WAAA,SAAAA,KAciC,2BAdhCzQ,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACA8P,EAAAA,mBACA7P,EAAAA,kBACA4P,IAEFrP,QAAS,CACPwP,IAEFvP,aAAc,CACZuP,QAG6BO,EAdjC,GCGAC,GAAA,WAAA,SAAAA,KAsB4B,2BAtB3B1Q,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAuQ,GACAV,IAEFrP,QAAS,CACPmN,GACA4C,GACAV,IAEFpP,aAAc,GACdE,UAAW,CACTsN,GACAH,IAEFnK,gBAAiB,CACfuL,GACAS,GACAC,QAGwBY,EAtB5B,GCJAC,GAAA,WAAA,SAAAA,KASsC,2BATrC3Q,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACA4N,EAAAA,YACAmC,EAAAA,iBAEFvP,QAAS,CAAClI,GACVmI,aAAc,CAACnI,OAEqBmY,EATtC,GCXAC,GAAA,WAEA,SAAAA,KASA,OAJSA,EAAAlnB,UAAAud,OADP,SACcrN,GACZA,EAAM0K,iBACN1K,EAAMmN,uCAPTtF,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,+DAGTwH,EAAAA,aAAYzH,KAAA,CAAC,OAAQ,CAAC,cAKzB0W,EAXA,GCAAC,GAAA,WAEA,SAAAA,KAQA,OAHSA,EAAAnnB,UAAAoW,QADP,SACelG,GACbA,EAAMmN,uCANTtF,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,4DAGTwH,EAAAA,aAAYzH,KAAA,CAAC,QAAS,CAAC,cAI1B2W,EAVA,GCAAC,GAAA,WAIA,SAAAA,KAYA,OANSA,EAAA7P,QAAP,WACE,MAAO,CACLC,SAAU4P,EACVjQ,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAACiQ,GAA8BC,IAC7CnQ,QAAS,CAACkQ,GAA8BC,QAS1CC,EAhBA,GCeAC,GAAA,WAwEE,SAAAA,EAAoB7T,EAA6BkE,GAA7B5X,KAAA0T,SAAAA,EAA6B1T,KAAA4X,GAAAA,EAtDxC5X,KAAAkS,WAAY,EAKZlS,KAAAwnB,eAAyB,EAMlCxnB,KAAAynB,oBAA8B,EAgBtBznB,KAAA0nB,WAAY,EAMpB1nB,KAAAyR,eAA4CC,EAA0B/O,KAK5D3C,KAAA2nB,OAAS,IAAIjY,EAAAA,aA6DzB,OAnFElQ,OAAAyB,eACIsmB,EAAArnB,UAAA,WAAQ,KAOZ,WACE,OAAOF,KAAK0nB,eATd,SACajmB,IACY,IAAnBzB,KAAKkS,WACLzQ,IAAUzB,KAAK0nB,YAEnB1nB,KAAK4nB,eAAenmB,GACpBzB,KAAK6nB,2CAuBPN,EAAArnB,UAAAoW,QADA,YAEyB,IAAnBtW,KAAKkS,YAA8C,IAAvBlS,KAAKwnB,gBAIrCxnB,KAAK4nB,gBAAe,GACpB5nB,KAAK2nB,OAAOpX,KAAKvQ,QASXunB,EAAArnB,UAAA0nB,eAAR,SAAuB7X,IAEJ,KADjB/P,KAAK0nB,UAAY3X,IAEf/P,KAAK8nB,OAAOP,EAAwBQ,cACJ,IAA5B/nB,KAAKynB,oBACPznB,KAAK8nB,OAAOP,EAAwBS,kBAGtChoB,KAAKioB,UAAUV,EAAwBQ,aACvC/nB,KAAKioB,UAAUV,EAAwBS,kBAOnCT,EAAArnB,UAAA2nB,OAAR,YACyB,IAAnB7nB,KAAK0nB,WACP1nB,KAAK4X,GAAGG,cAAcmQ,eAAe,CACnCC,SAAUnoB,KAAKyR,eACf2W,MAAO,SACPC,OAAQ,YAQNd,EAAArnB,UAAA4nB,OAAR,SAAe1T,GACbpU,KAAK0T,SAASsF,SAAShZ,KAAK4X,GAAGG,cAAe3D,IAMxCmT,EAAArnB,UAAA+nB,UAAR,SAAkB7T,GAChBpU,KAAK0T,SAASuF,YAAYjZ,KAAK4X,GAAGG,cAAe3D,IA3G5CmT,EAAAQ,YAAc,gCAKdR,EAAAS,eAAiB,uDAbzB/P,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,mEAZVuI,EAAAA,iBADAhB,EAAAA,iDA8BCjH,EAAAA,6BAKAA,EAAAA,kCAKAA,EAAAA,wBAMAA,EAAAA,8BAgBAA,EAAAA,sBAMAC,EAAAA,wBAMAiH,EAAAA,aAAYzH,KAAA,CAAC,YAuDhB6W,EArHA,GCGAe,GAAA,WAAA,SAAAA,KAmBmC,2BAnBlC9R,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACA6R,EAAAA,eACAC,EAAAA,cACA3R,EAAAA,cACAD,EAAAA,gBACA6R,EAAAA,kBACAnB,GACAxK,IAEF5F,QAAS,CACP/F,GAEFgG,aAAc,CACZhG,EACAoW,QAG+Be,EAnBnC,GClBAI,GAAA,WAMA,SAAAA,KAU8B,2BAV7BlS,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,cAEFQ,QAAS,CACPiQ,GACAmB,IAEFnR,aAAc,OAEcuR,EAhB9B,GCAAC,GAAA,WAUE,SAAAA,EAAoBC,GAAA5oB,KAAA4oB,KAAAA,EAsBtB,OApBED,EAAAzoB,UAAAoY,UAAA,SAAUuQ,GACR,OAAO7oB,KAAK4oB,KACTpkB,IAAIqkB,EAAK,CACRC,QAAS,CACPC,oBAAqB,SAEvBC,aAAc,SAEfthB,KACCuhB,EAAAA,UAAS,SAACC,GACR,OAAO,IAAIpD,EAAAA,WAAU,SAACqD,OACdC,EAAS,IAAIC,WACnBD,EAAOE,cAAcJ,GACrBE,EAAOG,UAAS,WACdJ,EAAS3nB,KAAK4nB,EAAO5b,mCApBlCgL,EAAAA,KAAI9H,KAAA,CAAC,CACJsB,KAAM,2DANCwX,EAAAA,cA+BTb,EAhCA,GCAAc,GAAA,WAGA,SAAAA,KAYA,OANSA,EAAAhS,QAAP,WACE,MAAO,CACLC,SAAU+R,EACVpS,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAACwR,IACfzR,QAAS,CAACyR,QASZc,EAfA,GCAAC,GAAA,WAEA,SAAAA,KAYA,OAREA,EAAAxpB,UAAAoY,UAAA,SAAU7W,EAAYiP,OACdiZ,EAAY,GAKlB,OAJAnqB,OAAOoqB,oBAAoBnoB,GAAOqD,QAAO,SAAEvE,GACzC,OAAAopB,EAAU5nB,KAAK,CAAExB,IAAGA,EAAEkB,MAAOA,EAAMlB,OAG9BopB,uBAVVnR,EAAAA,KAAI9H,KAAA,CAAC,CACJsB,KAAM,eAWR0X,EAdA,GCAAG,GAAA,WAGA,SAAAA,KAYA,OANSA,EAAApS,QAAP,WACE,MAAO,CACLC,SAAUmS,EACVxS,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAACuS,IACfxS,QAAS,CAACwS,QASZG,EAfA,GCAAC,GAAA,WAYE,SAAAA,EAAmBvQ,GAAAvZ,KAAAuZ,UAAAA,EASrB,OAPEuQ,EAAA5pB,UAAA6pB,SAAA,SAASC,GACP,MAAsB,iBAARA,IAAqBrqB,MAAM6f,QAAQwK,IAGnDF,EAAA5pB,UAAAmE,OAAA,SAAO4lB,EAAS1pB,GACd,OAAQ0pB,EAAUA,EAAU,IAAM,IAAM1pB,uBAhB3CkQ,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,kBACVC,SAAA,0mCAJO4I,EAAAA,gBAoBTsQ,EArBA,GCAAI,GAAA,WASE,SAAAA,EAAoBxQ,GAAA1Z,KAAA0Z,OAAAA,EAYtB,OAVSwQ,EAAAhqB,UAAAyZ,KAAP,SAAYhW,EAAYqgB,EAAMmG,OACtB5Q,EAAYvZ,KAAK0Z,OAAOC,KAAKmQ,GAAqB,CACtDjQ,cAAc,IAMhB,OAJAN,EAAUO,kBAAkBkK,KAAOA,EACnCzK,EAAUO,kBAAkBnW,MAAQA,EACpC4V,EAAUO,kBAAkBqQ,WAAaA,EAElC5Q,EAAUS,mCAZpBC,EAAAA,sDANQC,EAAAA,aAoBTgQ,EArBA,GCAAE,GAAA,WASA,SAAAA,KAaA,OALSA,EAAA3S,QAAP,WACE,MAAO,CACLC,SAAU0S,wBAVf5T,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CAACC,EAAAA,aAAcE,EAAAA,gBAAiBwD,EAAAA,gBAAiByP,IAC1D3S,QAAS,CAAC4S,IACV3S,aAAc,CAAC2S,IACfzP,gBAAiB,CAACyP,IAClBzS,UAAW,CAAC6S,QAQdE,EAtBA,GCAAC,GAAA,WA8GE,SAAAA,EAAmB3W,EAA6BkE,GAA7B5X,KAAA0T,SAAAA,EAA6B1T,KAAA4X,GAAAA,EArFxC5X,KAAAsqB,OAAS,UAqBTtqB,KAAAuqB,UAAW,EAsBXvqB,KAAA0nB,WAAY,EAsBZ1nB,KAAAwqB,WAAY,EAEVxqB,KAAAyqB,aAAe,IAAI/a,EAAAA,aACnB1P,KAAA0qB,YAAc,IAAIhb,EAAAA,aAClB1P,KAAA2qB,eAAiB,IAAIjb,EAAAA,aACrB1P,KAAA4qB,cAAgB,IAAIlb,EAAAA,aACpB1P,KAAA6qB,cAAgB,IAAInb,EAAAA,aACpB1P,KAAA8qB,aAAe,IAAIpb,EAAAA,aACnB1P,KAAA+qB,MAAQ,IAAIrb,EAAAA,aACZ1P,KAAAgrB,QAAU,IAAItb,EAAAA,aACd1P,KAAA2nB,OAAS,IAAIjY,EAAAA,aACb1P,KAAAirB,SAAW,IAAIvb,EAAAA,aACf1P,KAAAmmB,QAAU,IAAIzW,EAAAA,aACd1P,KAAAomB,OAAS,IAAI1W,EAAAA,aAsCzB,OA3HElQ,OAAAyB,eACIopB,EAAAnqB,UAAA,QAAK,KADT,WAEE,OAAOF,KAAKsqB,YAEd,SAAU7oB,GACRzB,KAAKsqB,OAAS7oB,mCAIhBjC,OAAAyB,eACIopB,EAAAnqB,UAAA,UAAO,KADX,WAEE,OAAOF,KAAKuqB,cAEd,SAAY9oB,GACNA,IAAUzB,KAAKuqB,WAGfvqB,KAAKmW,WAIT1U,EAAQzB,KAAK0qB,YAAYna,KAAKvQ,MAAQA,KAAK4qB,cAAcra,KAAKvQ,MAE9DA,KAAKuqB,SAAW9oB,EAChBzB,KAAKkrB,sBAELzpB,EAAQzB,KAAK+qB,MAAMxa,KAAKvQ,MAAQA,KAAKgrB,QAAQza,KAAKvQ,yCAIpDR,OAAAyB,eACIopB,EAAAnqB,UAAA,WAAQ,KADZ,WAEE,OAAOF,KAAK0nB,eAEd,SAAajmB,GACPA,IAAUzB,KAAK0nB,YAGf1nB,KAAKmW,WAIT1U,EAAQzB,KAAKyqB,aAAala,KAAKvQ,MAAQA,KAAK2qB,eAAepa,KAAKvQ,MAEhEA,KAAK0nB,UAAYjmB,EACjBzB,KAAKuqB,SAAW9oB,EAChBzB,KAAKkrB,sBAELzpB,EAAQzB,KAAK2nB,OAAOpX,KAAKvQ,MAAQA,KAAKirB,SAAS1a,KAAKvQ,yCAItDR,OAAAyB,eACIopB,EAAAnqB,UAAA,WAAQ,KADZ,WAEE,OAAOF,KAAKwqB,eAEd,SAAa/oB,GACPA,IAAUzB,KAAKwqB,aAIL,IAAV/oB,IACFzB,KAAK+P,UAAW,GAGlBtO,EAAQzB,KAAK6qB,cAActa,KAAKvQ,MAAQA,KAAK8qB,aAAava,KAAKvQ,MAE/DA,KAAKwqB,UAAY/oB,EACjBzB,KAAKmrB,sBAEL1pB,EAAQzB,KAAKmmB,QAAQ5V,KAAKvQ,MAAQA,KAAKomB,OAAO7V,KAAKvQ,wCAkBrDqqB,EAAAnqB,UAAAoW,QADA,WAEEtW,KAAK+P,UAAW,GAKlBsa,EAAAnqB,UAAAkrB,aAAA,WAGE,OAAOprB,KAAK4X,GAAGG,cAAcsT,UAFb,GAKVhB,EAAAnqB,UAAAgrB,oBAAR,WACMlrB,KAAKsrB,SAAWtrB,KAAK+P,SACvB/P,KAAK8nB,OAAOuC,EAAkBtC,aAE9B/nB,KAAKioB,UAAUoC,EAAkBtC,cAI7BsC,EAAAnqB,UAAAirB,oBAAR,WACMnrB,KAAKmW,SACPnW,KAAK8nB,OAAOuC,EAAkBkB,aAE9BvrB,KAAKioB,UAAUoC,EAAkBkB,cAI7BlB,EAAAnqB,UAAA4nB,OAAR,SAAe1T,GACbpU,KAAK0T,SAASsF,SAAShZ,KAAK4X,GAAGG,cAAe3D,IAGxCiW,EAAAnqB,UAAA+nB,UAAR,SAAkB7T,GAChBpU,KAAK0T,SAASuF,YAAYjZ,KAAK4X,GAAGG,cAAe3D,IA5H5CiW,EAAAtC,YAAc,yBACdsC,EAAAkB,YAAc,6CANtBtT,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,6DANVuI,EAAAA,iBADAhB,EAAAA,6CAcCjH,EAAAA,uBASAA,EAAAA,wBAqBAA,EAAAA,wBAsBAA,EAAAA,4BAsBAC,EAAAA,4BACAA,EAAAA,+BACAA,EAAAA,8BACAA,EAAAA,8BACAA,EAAAA,6BACAA,EAAAA,sBACAA,EAAAA,wBACAA,EAAAA,uBACAA,EAAAA,yBACAA,EAAAA,wBACAA,EAAAA,uBACAA,EAAAA,wBAEAiH,EAAAA,aAAYzH,KAAA,CAAC,YAoChB2Z,EA7IA,GCAAmB,GAAA,WA8EE,SAAAA,EAAoB5T,GAAA5X,KAAA4X,GAAAA,EAlDZ5X,KAAAyrB,aAAc,EASdzrB,KAAA0rB,YAAa,EAqBb1rB,KAAAye,cAAgC,GAiO1C,OAtQEjf,OAAAyB,eACIuqB,EAAAtrB,UAAA,aAAU,KADd,WAEE,OAAOF,KAAKyrB,iBAEd,SAAehqB,GACbzB,KAAKyrB,YAAchqB,mCAIrBjC,OAAAyB,eACIuqB,EAAAtrB,UAAA,YAAS,KADb,WAEE,OAAOF,KAAK0rB,gBAEd,SAAcjqB,GACZzB,KAAK0rB,WAAajqB,mCAIpBjC,OAAAyB,eAAIuqB,EAAAtrB,UAAA,eAAY,KAAhB,WACE,OAAOF,KAAK2rB,mBAEd,SAAiBlqB,GACfzB,KAAK4rB,YAAcnqB,EACnBzB,KAAK2rB,cAAgBlqB,mCAIvBjC,OAAAyB,eAAIuqB,EAAAtrB,UAAA,cAAW,KAAf,WACE,OAAOF,KAAK6rB,kBAEd,SAAgBpqB,GACdzB,KAAK6rB,aAAepqB,mCAYtB+pB,EAAAtrB,UAAA4rB,oBADA,SACoB1b,GAIdpQ,KAAK+rB,oBACe,KAAlB3b,EAAM4b,SAAoC,KAAlB5b,EAAM4b,SAChC5b,EAAM0K,iBACN9a,KAAKisB,SAAS7b,EAAM4b,UACO,KAAlB5b,EAAM4b,SACfhsB,KAAK2nB,OAAO3nB,KAAK4rB,eAOvBJ,EAAAtrB,UAAAyP,SAAA,WACE3P,KAAKksB,oBAGPV,EAAAtrB,UAAAisB,gBAAA,WAAA,IAAAtnB,EAAA7E,KACMA,KAAKosB,UAAUzrB,QACjBX,KAAKqsB,OAGPrsB,KAAKssB,YAActsB,KAAKosB,UAAUhnB,QAAQuD,UAAS,SAChD4jB,GAA+B,OAAA1nB,EAAKwnB,UAIzCb,EAAAtrB,UAAAgQ,YAAA,WACElQ,KAAKssB,YAAYpkB,eAGnBsjB,EAAAtrB,UAAA6qB,MAAA,SAAMyB,GACCxsB,KAAKkS,YAIVlS,KAAKgrB,UAIDwB,IAASpoB,YACXooB,EAAKlB,SAAU,KAInBE,EAAAtrB,UAAA8qB,QAAA,WACMhrB,KAAK4rB,cAAgBxnB,YACvBpE,KAAK4rB,YAAYN,SAAU,GAG7BtrB,KAAK4rB,YAAcxnB,WAGrBonB,EAAAtrB,UAAAusB,UAAA,eAEMD,EADED,EAAQvsB,KAAKosB,UAAUM,UAEzBvW,GAAW,EACXpS,EAAQ/D,KAAK2sB,kBAKjB,IAJI5oB,IAAUK,YACZL,GAAS,GAGJoS,GAAYpS,EAAQwoB,EAAM5rB,OAAS,GAGxCwV,GADAqW,EAAOD,EADPxoB,GAAS,IAEOoS,SAGdqW,IAASpoB,WACXpE,KAAK+qB,MAAMyB,IAIfhB,EAAAtrB,UAAA0sB,cAAA,WAME,QAJIJ,EADED,EAAQvsB,KAAKosB,UAAUM,UAEzBvW,GAAW,EACXpS,EAAQ/D,KAAK2sB,kBAEVxW,GAAoB,EAARpS,GAGjBoS,GADAqW,EAAOD,EADPxoB,GAAS,IAEOoS,SAGdqW,IAASpoB,WACXpE,KAAK+qB,MAAMyB,IAIfhB,EAAAtrB,UAAAynB,OAAA,SAAO6E,GACAxsB,KAAKkS,YAIVlS,KAAKirB,WAEDuB,IAASpoB,YACXooB,EAAKzc,UAAW,KAIpByb,EAAAtrB,UAAA+qB,SAAA,WACEjrB,KAAKgrB,UAEDhrB,KAAK6sB,eAAiBzoB,YACxBpE,KAAK6sB,aAAa9c,UAAW,GAG/B/P,KAAK6sB,aAAezoB,WAGtBonB,EAAAtrB,UAAAgsB,iBAAA,WACMlsB,KAAK8sB,aACP9sB,KAAK+rB,mBAAoB,IAI7BP,EAAAtrB,UAAA6sB,kBAAA,WACE/sB,KAAK+rB,mBAAoB,GAG3BP,EAAAtrB,UAAA8sB,aAAA,SAAaR,GACXxsB,KAAK4X,GAAGG,cAAckV,UAAYT,EAAKpB,gBAGjCI,EAAAtrB,UAAAmsB,KAAR,WACErsB,KAAK2I,YAEL3I,KAAK6sB,aAAe7sB,KAAKktB,mBACzBltB,KAAK4rB,YAAc5rB,KAAKmtB,kBAExBntB,KAAKksB,oBAGCV,EAAAtrB,UAAAyI,UAAR,WAAA,IAAA9D,EAAA7E,KACEA,KAAKkI,cAELlI,KAAKosB,UAAUM,UAAU5nB,QAAO,SAAC0nB,GAC/B3nB,EAAK4Z,cAAc1c,KACjByqB,EAAK/B,aAAa9hB,UAAS,SAAEykB,GAC3B,OAAAvoB,EAAKwoB,uBAAuBD,MAIhCvoB,EAAK4Z,cAAc1c,KACjByqB,EAAK7E,OAAOhf,UAAS,SAAEykB,GACrB,OAAAvoB,EAAKyoB,iBAAiBF,MAI1BvoB,EAAK4Z,cAAc1c,KACjByqB,EAAK9B,YAAY/hB,UAAS,SAAEykB,GAC1B,OAAAvoB,EAAK0oB,sBAAsBH,MAI/BvoB,EAAK4Z,cAAc1c,KACjByqB,EAAKzB,MAAMpiB,UAAS,SAAEykB,GACpB,OAAAvoB,EAAK2oB,gBAAgBJ,OAGxBptB,OAGGwrB,EAAAtrB,UAAAgI,YAAR,WACElI,KAAKye,cAAc3Z,QAAO,SAAEgX,GAAsB,OAAAA,EAAI5T,gBACtDlI,KAAKye,cAAgB,IAGf+M,EAAAtrB,UAAAqtB,sBAAR,SAA8Bf,GACxBA,IAASxsB,KAAK4rB,aAChB5rB,KAAKirB,YAIDO,EAAAtrB,UAAAstB,gBAAR,SAAwBhB,GACtBxsB,KAAK4rB,YAAcY,GAGbhB,EAAAtrB,UAAAmtB,uBAAR,SAA+Bb,GACzBA,IAASxsB,KAAK4rB,aAChB5rB,KAAKirB,YAIDO,EAAAtrB,UAAAotB,iBAAR,SAAyBd,GACvBxsB,KAAK6sB,aAAeL,GAGdhB,EAAAtrB,UAAAgtB,iBAAR,WACE,OAAOltB,KAAKosB,UAAUM,UAAUllB,KAAI,SAACglB,GAAQ,OAAAA,EAAKzc,YAG5Cyb,EAAAtrB,UAAAitB,gBAAR,WACE,OAAOntB,KAAKosB,UAAUM,UAAUllB,KAAI,SAACglB,GAAQ,OAAAA,EAAKlB,WAG5CE,EAAAtrB,UAAAysB,gBAAR,WAAA,IAAA9nB,EAAA7E,KACE,OAAOA,KAAKosB,UACTM,UACAe,UAAS,SAACjB,GAAQ,OAAAA,IAAS3nB,EAAK+mB,eAG7BJ,EAAAtrB,UAAA+rB,SAAR,SAAiB1rB,GACf,OAAQA,GACN,KAAK,GACHP,KAAK4sB,gBACL,MACF,KAAK,GACH5sB,KAAKysB,kCAtQZhc,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,WACVC,SAAA,ogCARAsH,EAAAA,kDAYCjH,EAAAA,yBASAA,EAAAA,yBA8BAyc,EAAAA,gBAAehd,KAAA,CAAC2Z,GAAmB,CAAEsD,aAAa,iCAGlDxV,EAAAA,aAAYzH,KAAA,CAAC,mBAAoB,CAAC,cA4NrC8a,EA3RA,GCAAoC,GAAA,WASA,SAAAA,KAYA,OANSA,EAAAnW,QAAP,WACE,MAAO,CACLC,SAAUkW,EACVvW,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CAACC,EAAAA,aAAcG,EAAAA,cAAeG,EAAAA,cAAeoB,GACtDjB,aAAc,CAACkT,GAAmBmB,IAClCtU,QAAS,CAACmT,GAAmBmB,QAS/BoC,EArBA,GCAAC,GAAA,WAkCE,SAAAA,IAFQ7tB,KAAA8tB,aAAc,EAGxB,OApBEtuB,OAAAyB,eACI4sB,EAAA3tB,UAAA,QAAK,KADT,WAEE,OAAOF,KAAKoZ,YAEd,SAAU3X,GACRzB,KAAKoZ,OAAS3X,mCAIhBjC,OAAAyB,eAEI4sB,EAAA3tB,UAAA,aAAU,KAFd,WAGE,OAAOF,KAAK8tB,iBAEd,SAAersB,GACbzB,KAAK8tB,YAAcrsB,uDAvBtBgP,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,YACVC,SAAA,8aAEAC,gBAAiBC,EAAAA,wBAAwBC,iqBAIxCE,EAAAA,0BASAA,EAAAA,OAAK,CAAAlE,KACLkJ,EAAAA,YAAWvF,KAAA,CAAC,kCAUfmd,EAnCA,GCAAE,GAAA,WAIA,SAAAA,KAW6B,2BAX5BvX,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,cAEFQ,QAAS,CACP2W,IAEF1W,aAAc,CACZ0W,QAGyBE,EAf7B,GCSAC,GAAA,WAgCE,SAAAA,EAAoB5N,EAA+B1M,GAAA1T,KAAA0T,SAAAA,EACrD,OAzBEsa,EAAA9tB,UAAA+tB,OADA,WAEEjuB,KAAKkuB,eAAiBlS,SAAsB,eAI9CgS,EAAA9tB,UAAAiuB,aADA,WAEyBnS,SAAsB,gBACtBhc,KAAKkuB,eAC1BluB,KAAKouB,YAAcpuB,KAAKkuB,eAExBluB,KAAKouB,YAAchqB,WAKvB4pB,EAAA9tB,UAAAmuB,QADA,WAEMruB,KAAKouB,aACPpuB,KAAK0T,SAAS4a,kBAAkBtuB,KAAKouB,aAAaG,OAGpDvuB,KAAKouB,YAAchqB,UACnBpE,KAAKkuB,eAAiB9pB,+BA7BzB6T,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,gEATH6d,EAAAA,WAAUnuB,WAAA,CAAA,CAAA0M,KAwCJ0hB,EAAAA,cAzCyBvV,EAAAA,6CAgBrCf,EAAAA,aAAYzH,KAAA,CAAC,OAAQ,CAAC,iCAKtByH,EAAAA,aAAYzH,KAAA,CAAC,cAAe,CAAC,4BAU7ByH,EAAAA,aAAYzH,KAAA,CAAC,QAAS,CAAC,cAW1Bsd,EAjCA,GCTAU,GAAA,WAGA,SAAAA,KAYA,OANSA,EAAAjX,QAAP,WACE,MAAO,CACLC,SAAUgX,EACVrX,UAAW,yBAThBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,GACTU,aAAc,CAAC6W,IACf9W,QAAS,CAAC8W,QASZU,EAfA,GCAAC,GAAA,WAiBE,SAAAA,IANO3uB,KAAA4uB,OAAmC,IAAI/nB,EAAAA,iBAAgB,GAehE,OAbErH,OAAAyB,eACI0tB,EAAAzuB,UAAA,QAAK,KACT,WAAuB,OAAOF,KAAK4uB,OAAOntB,WAF1C,SACUA,GAAkBzB,KAAK4uB,OAAOptB,KAAKC,oCAK7CktB,EAAAzuB,UAAA2uB,KAAA,WACE7uB,KAAK8uB,OAAQ,GAGfH,EAAAzuB,UAAA6uB,KAAA,WACE/uB,KAAK8uB,OAAQ,uBApBhBre,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,cACVC,SAAA,onBAOCK,EAAAA,SAaH0d,EA1BA,GCaAK,GAAA,WAUE,SAAAA,EACkBC,EACRC,GADQlvB,KAAAivB,QAAAA,EACRjvB,KAAAkvB,gBAAAA,EAuBZ,OAfEF,EAAA9uB,UAAAyP,SAAA,WAAA,IAAA9K,EAAA7E,KACEA,KAAKmvB,UAAYnvB,KAAKkvB,gBAAgBE,SACnC1nB,KAAKgB,EAAAA,aAAa,KAClBC,UAAS,SAAEmB,GACF,EAARA,EAAYjF,EAAKoqB,QAAQJ,OAAShqB,EAAKoqB,QAAQF,UAQrDC,EAAA9uB,UAAAgQ,YAAA,WACElQ,KAAKmvB,UAAUjnB,mCAjClB+P,EAAAA,UAASvH,KAAA,CAAC,CACTC,SAAU,uBACV0G,UAAW,CAACsX,iDAVLA,GAAgBtuB,WAAA,CAAA,CAAA0M,KAmBpB0hB,EAAAA,cApBIY,EAAAA,mBA4CTL,EAnCA,GCbAM,GAAA,WAOA,SAAAA,KAK+B,2BAL9B9Y,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CAACC,EAAAA,aAAc6Y,EAAAA,0BACxBpY,aAAc,CAAC6X,GAA0BL,IACzCzX,QAAS,CAAC8X,GAA0BL,QAEPW,EAZ/B,kBCmBE,SAAAE,EACUC,EACAC,EACAC,GAHV,IAAA9qB,EAKE+qB,EAAAruB,KAAAvB,OAAOA,YAJC6E,EAAA4qB,UAAAA,EACA5qB,EAAA6qB,OAAAA,EACA7qB,EAAA8qB,MAAAA,EALF9qB,EAAAgrB,cAAgB,IAAIhpB,EAAAA,gBAAgB,MAuE9C,OA9EqCipB,EAAAA,EAAAA,GACnCtwB,OAAAyB,eAAIuuB,EAAAtvB,UAAA,SAAM,KAAV,WACE,OAAOF,KAAK6vB,cAAcpuB,WAE5B,SAAWoG,GACT7H,KAAK6vB,cAAcruB,KAAKqG,oCAc1B2nB,EAAAtvB,UAAA6vB,QAAA,WAAA,IAAAlrB,EAAA7E,KACE,IAAKA,KAAKyvB,UACR,OAAOO,EAAAA,MAAM,QAETC,EAAqB,CACzBjwB,KAAKyvB,UAAUS,WACflwB,KAAK6vB,cACL7vB,KAAK2vB,MAAMQ,YAGb,OAAOH,EAAAA,MAAKhnB,WAAA,EAAA/G,EAAIguB,IAAoBvoB,KAClCxB,EAAAA,IAAG,WACD,OAAOrB,EAAKurB,gBAAgBvrB,EAAK4qB,UAAUzL,QAE7C9d,EAAAA,IAAG,SAAC8d,GACF,OAAOnf,EAAKwrB,cAAcrM,OAKhCwL,EAAAtvB,UAAAowB,WAAA,aAEAd,EAAAtvB,UAAAkwB,gBAAA,SAAgBpM,GAAhB,IAAAnf,EAAA7E,KACE,OAAKA,KAAK6H,OAGHmc,EAAK3a,QAAQxB,OAAM,SAAE2kB,GAO1B,OAAyD,IAN/B3nB,EAAK6qB,OAAO7d,QACnChK,OAAM,SAACpH,GAAK,OAAAA,EAAE8vB,aACdrqB,IAAG,SAACzF,GAAK,OAAAiJ,EAAAA,YAAY8mB,QAAQhE,EAAM/rB,EAAEuR,QACrC7J,KAAK,KACLsoB,cAEcrqB,QAAQvB,EAAKgD,OAAO4oB,iBAT9BzM,GAaXwL,EAAAtvB,UAAAmwB,cAAA,SAAcrM,GAAd,IAAAnf,EAAA7E,KACE,OAAKA,KAAK2vB,MAAM/c,QAAmC,KAAzB5S,KAAK2vB,MAAM9lB,UAI9Bma,EAAKjc,KAAI,SAAE2oB,EAAGnxB,OACboxB,EAA6BjnB,EAAAA,YAAY8mB,QAC7CE,EACA7rB,EAAK8qB,MAAM/c,QAEPge,EAA6BlnB,EAAAA,YAAY8mB,QAC7CjxB,EACAsF,EAAK8qB,MAAM/c,QAGb,OAAOlJ,EAAAA,YAAYC,eACjBinB,EACAD,EACA9rB,EAAK8qB,MAAM9lB,aAhBNma,GAoBbwL,GA9EqCqB,EAAAA,gBCTnCC,QAAA,EACAC,OAAA,EACAC,KAAA,sECHF,IAAAC,GAAA,WAwBA,SAAAA,IA+BUjxB,KAAAkxB,iBAAkB,EAInBlxB,KAAAkS,UAAY,IAAIif,EAAAA,gBAAoB,EAAM,IAGjDnxB,KAAA2nB,OAAS,IAAIjY,EAAAA,aAiFf,OAjHElQ,OAAAyB,eACIgwB,EAAA/wB,UAAA,WAAQ,KADZ,WAEE,OAAOF,KAAKyvB,eAEd,SAAahuB,GACXzB,KAAKyvB,UAAYhuB,mCAInBjC,OAAAyB,eACIgwB,EAAA/wB,UAAA,QAAK,KADT,WAEE,OAAOF,KAAK0vB,YAEd,SAAUjuB,GACRzB,KAAK0vB,OAASjuB,mCAIhBjC,OAAAyB,eACIgwB,EAAA/wB,UAAA,iBAAc,KADlB,WAEE,OAAOF,KAAKkxB,qBAEd,SAAmBzvB,GACjBzB,KAAKkxB,gBAAkBzvB,mCAkBzBwvB,EAAA/wB,UAAAyP,SAAA,WAAA,IAAA9K,EAAA7E,KACEA,KAAKoxB,WAAa,IAAI5B,GAAgBxvB,KAAKqxB,SAAUrxB,KAAKsxB,MAAOtxB,KAAK+H,MAElE/H,KAAKsxB,QACPtxB,KAAKuxB,iBAAmBvxB,KAAKsxB,MAAMzf,QAChChK,OAAM,SAACpH,GAAK,OAAgB,IAAhBA,EAAE+wB,YACdtrB,IAAG,SAACzF,GAAK,OAAAA,EAAEuR,OAEVhS,KAAKsxB,MAAMrf,mBACbjS,KAAKuxB,iBAAiBE,QAAQ,qBAE5BzxB,KAAKsxB,MAAMI,SAAW1xB,KAAKsxB,MAAMI,QAAQ/wB,QAC3CX,KAAKuxB,iBAAiBxvB,KAAK,WAI/B/B,KAAKkS,UAAUyf,QAAQhpB,UAAS,SAAC9G,GAAK,OAAAgD,EAAK8iB,OAAOpX,KAAK1O,MAGzDovB,EAAA/wB,UAAAisB,gBAAA,WAAA,IAAAtnB,EAAA7E,KACMA,KAAK6H,QACPkU,EAAAA,UAAU/b,KAAK6H,OAAOkQ,cAAe,SAClCrQ,KACCgB,EAAAA,aAAa,KACbkpB,EAAAA,wBAEDjpB,UAAS,WACH9D,EAAKusB,aAGVvsB,EAAKusB,WAAWvpB,OAAShD,EAAKgD,OAAOkQ,cAActW,UAK3DwvB,EAAA/wB,UAAAqS,YAAA,SAAYsf,GACNA,EAAOR,WACTrxB,KAAKoxB,WAAa,IAAI5B,GACpBxvB,KAAKqxB,SACLrxB,KAAKsxB,MACLtxB,KAAK+H,MAEP/H,KAAKkS,UAAU5N,UAInB2sB,EAAA/wB,UAAA4xB,eAAA,SAAeC,GACb,OAAOC,GAAiBD,IAG1Bd,EAAA/wB,UAAA2S,SAAA,SAASof,EAAK1xB,GACZ,OAAOmJ,EAAAA,YAAY8mB,QAAQyB,EAAK1xB,IAIlC0wB,EAAA/wB,UAAAgyB,cAAA,WAGE,OAFoBlyB,KAAKkS,UAAUnC,SAASpP,SAC5BX,KAAKqxB,SAASrN,KAAKrjB,QAKrCswB,EAAA/wB,UAAAiyB,aAAA,WAAA,IAAAttB,EAAA7E,KACEA,KAAKkyB,gBACDlyB,KAAKkS,UAAU5N,QACftE,KAAKqxB,SAASrN,KAAKlf,QAAO,SAACmtB,GAAO,OAAAptB,EAAKqN,UAAUyV,OAAOsK,MAG9DhB,EAAA/wB,UAAAkyB,kBAAA,SAAkBhiB,EAAO2F,EAAQkc,GAC/B7hB,EAAMmN,kBACNxH,EAAOgD,MAAMkZ,wBArHhBxhB,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,YACVC,SAAA,ukHAICK,EAAAA,qBASAA,EAAAA,8BASAA,EAAAA,sBAaAC,EAAAA,uBAOAwP,EAAAA,UAAShQ,KAAA,CAAC,wBACVgQ,EAAAA,UAAShQ,KAAA,CAAC2hB,EAAAA,YA0EbpB,EA/IA,GCAAqB,GAAA,WAkBA,SAAAA,KAwBA,OANSA,EAAA7a,QAAP,WACE,MAAO,CACLC,SAAU4a,EACVjb,UAAW,yBArBhBb,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACA4N,EAAAA,YACAiO,EAAAA,eACA1b,EAAAA,cACAD,EAAAA,gBACA2R,EAAAA,eACA/B,EAAAA,mBACAzJ,EAAAA,eACAyL,EAAAA,cACAC,EAAAA,kBACA9R,EAAAA,mBAEFQ,aAAc,CAAC8Z,IACf/Z,QAAS,CAAC+Z,QASZqB,EA1CA,GCOAE,GAAA,WAWE,SAAAA,YAJOA,EAAA/N,SAAP,SAAgBgO,GACdD,EAAYE,MAAMD,EAAKzgB,MAAQygB,GAUjCD,EAAAtyB,UAAAyyB,QAAA,SAAQ3gB,GACN,OAAOwgB,EAAYE,MAAM1gB,IAO3BwgB,EAAAtyB,UAAA0yB,SAAA,WACE,OAAOpzB,OAAOmI,OAAO6qB,EAAYE,QAtB5BF,EAAAE,MAA+B,uBALvCzY,EAAAA,WAAUvJ,KAAA,CAAC,CACVsP,WAAY,sJADd,kBCAA,SAAA6S,mDAiCA,OAjCiC/C,EAAAA,EAAAA,GAM/B+C,EAAA3yB,UAAA4yB,0BAAA,eACQC,EAAa,GACbC,EAAe,GAErBhzB,KAAKiK,UAAUxI,MAAMqD,QAAO,SAAEiR,OACtBkd,EAAald,EAAOkd,YAAc,GAClCviB,EAAOqF,EAAOmd,eAAiB,GACnBD,EAAWE,MAAK,SAAEC,GAClC,OAAOA,EAASpqB,WAAA,EAAA/G,EAAIyO,MAEVqiB,EAAWhxB,KAAKgU,GAAUid,EAAajxB,KAAKgU,KAGhC,EAAtBid,EAAaryB,QACfX,KAAK0E,MAAMY,WAAW0tB,EAAc,CAClC7c,UAAU,EACVvD,QAAQ,IAIY,EAApBmgB,EAAWpyB,QACbX,KAAK0E,MAAMY,WAAWytB,EAAY,CAChC5c,UAAU,KAKlB0c,GAjCiC7oB,GCEjC,SAAgBqpB,GACdC,EACAvmB,GAEA,YAHA,IAAAumB,IAAAA,EAAA,cACA,IAAAvmB,IAAAA,EAAA,eAEOqJ,EAAAA,QAAQ,iBAAkB,CAC/B1R,EAAAA,MACE,QACA0d,EAAAA,MAAM,CACJ9J,UAAW,0BAGfib,EAAAA,WAAW,gBAAiBC,EAAAA,QAAQF,EAAQ,IAAMvmB,MCpBtD,IAAA0mB,GAAA,WAeA,SAAAA,IAWEzzB,KAAA0zB,YAAqC,IAAI7sB,EAAAA,gBAAgBzC,WAKzDpE,KAAA2zB,YAA2B,IAAId,GAAY,IAK3C7yB,KAAA4zB,WAAsC,IAAI/sB,EAAAA,gBAAgB,QAK1D7G,KAAA6zB,SAAsC,IAAIhtB,EAAAA,gBAAgB,IAiBlD7G,KAAA8zB,WAAa,IAAIjtB,EAAAA,iBAAyB,GAezC7G,KAAAwzB,SAAmB,EAiK9B,OA5JEh0B,OAAAyB,eAAIwyB,EAAAvzB,UAAA,mBAAgB,KAApB,WACE,OAAOF,KAAK0zB,YAAYjyB,QAAU2C,2CAOpCqvB,EAAAvzB,UAAAyP,SAAA,WAAA,IAAA9K,EAAA7E,KACEA,KAAK+zB,UAAY/zB,KAAKg0B,QAAQH,SAASlrB,UAAS,SAAEsrB,GAChD,OAAApvB,EAAKqvB,gBAAgBD,KAEvBj0B,KAAKm0B,aAAen0B,KAAKg0B,QAAQN,YAAY/qB,UAAS,SAAE8pB,GACtD,OAAA5tB,EAAKuvB,mBAAmB3B,MAQ5BgB,EAAAvzB,UAAAgQ,YAAA,WACElQ,KAAK+zB,UAAU7rB,cACflI,KAAKm0B,aAAajsB,cAClBlI,KAAK2zB,YAAY3rB,WAOnByrB,EAAAvzB,UAAAm0B,iBAAA,WACEr0B,KAAK8zB,WAAWtyB,MAAK,IAOvBiyB,EAAAvzB,UAAAo0B,oBAAA,WACEt0B,KAAK8zB,WAAWtyB,MAAK,IASvBiyB,EAAAvzB,UAAAq0B,cAAA,SAAc9B,GACZ,OAAOA,EAAK3uB,SAAW,IAOzBtE,OAAAyB,eAAIwyB,EAAAvzB,UAAA,yBAAsB,KAA1B,WAAA,IAAA2E,EAAA7E,KACE,OAAA,SAAQyyB,GACN,GAAK5tB,EAAKmvB,QAAQN,YAAYjyB,MAG9B,MAAO,CAAE+yB,eAAgB/B,EAAKjvB,KAAOqB,EAAKmvB,QAAQN,YAAYjyB,MAAMuQ,wCAQhEyhB,EAAAvzB,UAAAg0B,gBAAR,SAAwBD,GACtBj0B,KAAKy0B,WAAWR,IAOVR,EAAAvzB,UAAAk0B,mBAAR,SAA2B3B,GAA3B,IAAA5tB,EAAA7E,KACOA,KAAKwzB,QAIVxzB,KAAK00B,UAAS,WAAO,OAAA7vB,EAAK8vB,cAAclC,KAHtCzyB,KAAK20B,cAAclC,IAUfgB,EAAAvzB,UAAAy0B,cAAR,SAAsBlC,GACpB,GAAIA,IAASruB,UACXpE,KAAK2zB,YAAYjvB,MAAMqB,UAAU,CAAE6M,QAAQ,QACtC,KACCmD,EAAS/V,KAAK2zB,YAAYnvB,IAAIiuB,EAAKzgB,MACrC+D,IAAW3R,WACbpE,KAAK2zB,YAAYjvB,MAAMS,OAAO4Q,EAAQ,CAAEnD,QAAQ,IAAQ,GAI5D5S,KAAK0zB,YAAYlyB,KAAKixB,GAClBzyB,KAAKwzB,SACPxzB,KAAK4zB,WAAWpyB,KAAK,UAOjBiyB,EAAAvzB,UAAAu0B,WAAR,SAAmBR,GAAnB,IAAApvB,EAAA7E,KACQ0xB,EAAUuC,EAAQtuB,OAAM,SAAEC,EAAegvB,OACvCnC,EAAO5tB,EAAKmvB,QAAQrB,QAAQiC,GAClC,OAAInC,IAASruB,WAIbwB,EAAI7D,KAAK,CACPyB,GAAIivB,EAAKzgB,KACTrO,MAAO8uB,EAAK9uB,MACZwR,KAAMsd,EAAKtd,KAEXkB,QAASoc,EAAKpc,QACd3F,KAAM,CAAC+hB,EAAM5tB,EAAKmvB,SAClB5mB,QAAO,SAAGynB,EAAaC,GACrBA,EAASC,aAAaF,EAAM7iB,SAXvBpM,GAeR,IACH5F,KAAK2zB,YAAYrpB,KAAKonB,GACtB1xB,KAAK6zB,SAASryB,KAAKyyB,IAQbR,EAAAvzB,UAAAw0B,UAAR,SAAkBM,GAAlB,IAAAnwB,EAAA7E,KACEA,KAAKi1B,YACLj1B,KAAKk1B,YAAcl1B,KAAK8zB,WAAWnrB,UAAS,SAAEwsB,GACvCA,IACHH,EAASzzB,KAAKsD,GACdA,EAAKowB,gBAQHxB,EAAAvzB,UAAA+0B,UAAR,WACMj1B,KAAKk1B,aACPl1B,KAAKk1B,YAAYhtB,mCAxNtBuI,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,cACVC,SAAA,uuBAEAwkB,WAAY,CAAC/B,MACbxiB,gBAAiBC,EAAAA,wBAAwBC,0qBAgDxCE,EAAAA,uBAKAA,EAAAA,SAiKHwiB,EA1OA,GCaA4B,GAAA,WAAA,SAAAA,KAa+B,2BAb9B7e,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAU,EACAyJ,IAEF3J,QAAS,CACPuc,IAEFtc,aAAc,CACZsc,QAG2B4B,EAb/B,GCbAC,GAAA,WAMA,SAAAA,KAkBA,OARSA,EAAA7d,QAAP,WACE,MAAO,CACLC,SAAU4d,EACVje,UAAW,CACTmb,0BAdPhc,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,cAEFQ,QAAS,CACPme,IAEFle,aAAc,OAWhBme,EAxBA,GCkBAC,GAAA,WA0CE,SAAAA,IAAA,IAAA1wB,EAAA7E,KA9BQA,KAAAw1B,gBAAkB,CACxBC,OAAM,SAAGrlB,GAAe,OAAAvL,EAAK6wB,SAAStlB,IACtCulB,SAAQ,SAAGvlB,GAAe,OAAAvL,EAAK+wB,WAAWxlB,KAgBnCpQ,KAAA2e,YAAqD,GAKpD3e,KAAA21B,SAAW,IAAIjmB,EAAAA,aAKf1P,KAAAy1B,OAAS,IAAI/lB,EAAAA,aAiEzB,OAzDE6lB,EAAAr1B,UAAAgQ,YAAA,WACElQ,KAAK61B,iBASPN,EAAAr1B,UAAA41B,wBAAA,WAAA,IAAAjxB,EAAA7E,KACQ2e,EAAcnf,OAAOuF,OAAO,GAAI/E,KAAK2e,aAgB3C,OAbAnf,OAAO0F,KAAKlF,KAAKw1B,iBAAiB1wB,QAAO,SAAEvE,OACnCgf,EAAaZ,EAAYpe,GACzBw1B,EAAiBlxB,EAAK2wB,gBAAgBj1B,GACxCgf,IAAenb,UACjBua,EAAYpe,GAAI,SAAI6P,GAClBmP,EAAWnP,GACX2lB,EAAe3lB,IAGjBuO,EAAYpe,GAAOw1B,IAIhBpX,GAOD4W,EAAAr1B,UAAAw1B,SAAR,SAAiBtlB,GACfpQ,KAAKy1B,OAAOllB,KAAKH,GACjBpQ,KAAK61B,iBAOCN,EAAAr1B,UAAA01B,WAAR,SAAmBxlB,GACjBpQ,KAAK21B,SAASplB,KAAKH,GACnBpQ,KAAK61B,iBAMCN,EAAAr1B,UAAA21B,cAAR,WACM71B,KAAKg2B,SAAW5xB,WAClBpE,KAAKg2B,OAAOhuB,UAEdhI,KAAKg2B,OAAS5xB,+BAvGjBqM,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,oBACVC,SAAA,wKAEAC,gBAAiBC,EAAAA,wBAAwBC,4HAgBxCE,EAAAA,sBAKAA,EAAAA,2BAKAA,EAAAA,wBAKAC,EAAAA,uBAKAA,EAAAA,UAiEHqkB,EAzGA,GCNAU,GAAA,WAAA,SAAAA,KAYoC,2BAZnCzf,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAmK,IAEF3J,QAAS,CACPqe,IAEFpe,aAAc,CACZoe,QAGgCU,EAZpC,GCZAC,GAAA,WAYE,SAAAA,EAAoB/V,GAAAngB,KAAAmgB,wBAAAA,SAEpB+V,EAAAh2B,UAAAC,OAAA,SAAOg2B,GACL,OAAOn2B,KAAKmgB,wBAAwBhgB,OAAM,wBAR7C8Z,EAAAA,WAAUvJ,KAAA,CAAC,CACVsP,WAAY,oDANLL,yHAFT,GCAAyW,GAAA,WAMA,SAAAA,KAa8B,2BAb7B5f,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAuf,IAEF/e,QAAS,CACP+e,IAEF9e,aAAc,GACdE,UAAW,CACT6e,QAG0BE,EAnB9B,GCeAC,GAAA,WAAA,SAAAA,IAgBYr2B,KAAAyP,eAAiB,IAAIC,EAAAA,aAwBjC,OAhBE2mB,EAAAn2B,UAAAo2B,kBAAA,SAAkBC,GAChB,OAAO7yB,EAAe6yB,IASxBF,EAAAn2B,UAAAs2B,iBAAA,SAAiBpmB,OACTmmB,EAAYnmB,EAAM3O,MACxBzB,KAAKmE,MAAMsyB,kBAAkBF,GAC7Bv2B,KAAKyP,eAAec,KAAK,CAACR,UAAU,EAAMtO,MAAO80B,yBArCpD9lB,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,yBACVC,SAAA,0LAEAC,gBAAiBC,EAAAA,wBAAwBC,8NAOxCE,EAAAA,8BAKAC,EAAAA,UAwBHmlB,EAxCA,GCNAK,GAAA,WAAA,SAAAA,KAYyC,2BAZxClgB,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAyQ,IAEFjQ,QAAS,CACPmf,IAEFlf,aAAc,CACZkf,QAGqCK,EAZzC,GCSAC,GAAA,WAyCE,SAAAA,IAxBU32B,KAAA42B,iBAAmB,IAAIlnB,EAAAA,aAgDnC,OA1CElQ,OAAAyB,eAAI01B,EAAAz2B,UAAA,UAAO,KAAX,WAAyC,OAAOF,KAAKu2B,UAAUM,yCAM/Dr3B,OAAAyB,eAAI01B,EAAAz2B,UAAA,gBAAa,KAAjB,WACE,OAAOF,KAAKu2B,UAAUO,+CAOxBt3B,OAAAyB,eAAI01B,EAAAz2B,UAAA,qBAAkB,KAAtB,WACE,OAAOF,KAAKu2B,UAAUQ,oDAWxBJ,EAAAz2B,UAAA82B,eAAA,SAAehB,GACbh2B,KAAKu2B,UAAUK,mBACf52B,KAAK42B,iBAAiBrmB,KAAKylB,IAS7BW,EAAAz2B,UAAA+2B,iBAAA,SAAiBjB,GACfh2B,KAAKu2B,UAAUK,mBACf52B,KAAK42B,iBAAiBrmB,KAAKylB,wBA9D9BvlB,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,8BACVC,SAAA,sUAEAC,gBAAiBC,EAAAA,wBAAwBC,8HAOxCE,EAAAA,gCAMAC,EAAAA,UAgDHylB,EAjEA,GCRAO,GAAA,WAAA,SAAAA,KAY6C,2BAZ5C1gB,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,aACAuf,IAEF/e,QAAS,CACPyf,IAEFxf,aAAc,CACZwf,QAGyCO,EAZ7C,GCVAC,GAAA,WAMA,SAAAA,KAUiC,2BAVhC3gB,EAAAA,SAAQ9F,KAAA,CAAC,CACR+F,QAAS,CACPC,EAAAA,cAEFQ,QAAS,CACPwf,GACAQ,IAEF/f,aAAc,OAEiBggB,EAhBjC,GCAAC,GAAA,WASE,SAAAA,EAAYpT,GALZhkB,KAAAkwB,WAAqC,IAAIrpB,EAAAA,gBAAuB,IAM1Dmd,GACFhkB,KAAKkwB,WAAW1uB,KAAKwiB,GAoB3B,OA1BExkB,OAAAyB,eAAIm2B,EAAAl3B,UAAA,OAAI,KAAR,WACE,OAAOF,KAAKkwB,WAAWzuB,uCASzB21B,EAAAl3B,UAAAuE,IAAA,SAAIuf,GACFhkB,KAAKkwB,WAAW1uB,KAAKwiB,IAGvBoT,EAAAl3B,UAAAm3B,IAAA,SAAI7K,OACI8K,EAAat3B,KAAKgkB,KAAK3a,QAC7BiuB,EAAWv1B,KAAKyqB,GAChBxsB,KAAKyE,IAAI6yB,IAGXF,EAAAl3B,UAAAq3B,OAAA,SAAO/K,OACC8K,EAAat3B,KAAKgkB,KAAK3a,QACvBtF,EAAQuzB,EAAWlxB,QAAQomB,GACjC8K,EAAWE,OAAOzzB,EAAO,GACzB/D,KAAKyE,IAAI6yB,IAEbF,EA/BA,GCOA,kBAgCE,SAAAK,EAAoB3zB,QAAA,IAAAA,IAAAA,EAAA,IAAA9D,KAAA8D,QAAAA,EA5BpB9D,KAAA0zB,YAAqC,IAAI7sB,EAAAA,gBAAgBzC,WAKzDpE,KAAA6zB,SAAsC,IAAIhtB,EAAAA,gBAAgB,IAUlD7G,KAAA03B,kBAA8B,GAK9B13B,KAAAmE,MAAQ,IAAI6F,EAAkB,GAAI,CACxC3F,OAAM,SAAGouB,GAAe,OAAAA,EAAKzgB,QAQ7BhS,KAAKy0B,WAAW3wB,EAAQmwB,SACxBj0B,KAAK23B,YA6HT,OAnIEn4B,OAAAyB,eAAIw2B,EAAAv3B,UAAA,SAAM,KAAV,WACE,OAAOF,KAAKmE,MAAM8F,2CAWpBwtB,EAAAv3B,UAAA8H,QAAA,WACEhI,KAAKm0B,aAAajsB,cAClBlI,KAAKmE,MAAM6D,WAQbyvB,EAAAv3B,UAAAyyB,QAAA,SAAQ3gB,GACN,OAAOhS,KAAKmE,MAAMK,IAAIwN,IAOxBylB,EAAAv3B,UAAA0yB,SAAA,WACE,OAAO5yB,KAAKmE,MAAMiD,OAOpBqwB,EAAAv3B,UAAA03B,SAAA,SAASlF,GACP1yB,KAAKmE,MAAMmG,KAAKooB,IAOlB+E,EAAAv3B,UAAAu0B,WAAA,SAAWR,GACTj0B,KAAK6zB,SAASryB,KAAKyyB,GAAW,KAQhCwD,EAAAv3B,UAAA60B,aAAA,SAAa/iB,EAAclO,QAAA,IAAAA,IAAAA,EAAA,QACnB2uB,EAAOzyB,KAAK2yB,QAAQ3gB,GACtBygB,IAASruB,WAIbpE,KAAKmE,MAAMO,MAAMS,OAAOstB,EAAM,CAAE7f,QAAQ,EAAM9O,QAAOA,IAAI,IAM3D2zB,EAAAv3B,UAAA23B,qBAAA,WACE,GAAI73B,KAAK03B,kBAAkB/2B,QAAU,EACnCX,KAAK83B,qBADP,CAIM,IAAAvxB,EAAA5E,EAAA3B,KAAA03B,kBAAAF,QAAA,EAAA,GAAA,GAAC1qB,EAAAvG,EAAA,GAAUA,EAAA,GACjBvG,KAAK+0B,aAAajoB,KAMpB2qB,EAAAv3B,UAAA43B,eAAA,WACE93B,KAAK+3B,yBACL/3B,KAAKmE,MAAMO,MAAMqB,UAAU,CAAE6M,QAAQ,KAM/B6kB,EAAAv3B,UAAAy3B,UAAR,WAAA,IAAA9yB,EAAA7E,KACEA,KAAKmE,MAAQ,IAAI6F,EAAkB,GAAI,CACrC3F,OAAM,SAAGnB,GAAiB,OAAAA,EAAO8O,QAGnChS,KAAKm0B,aAAen0B,KAAKmE,MAAMkG,UAC5B5C,SAAQ,SAAEqI,GAA+B,OAAwB,IAAxBA,EAAOpL,MAAMkO,SACtDjK,UAAS,SAAEmH,GACV,GAAIA,IAAW1L,UAAf,KAKMquB,EAAO3iB,EAAO5M,OACdY,EAAUtE,OAAOuF,OACrB,GACA0tB,EAAK3uB,SAAW,GAChBgM,EAAOpL,MAAMZ,SAAW,IAE1Be,EAAK8vB,cAAcn1B,OAAOuF,OAAO,GAAI0tB,EAAM,CAAE3uB,QAAOA,UAVlDe,EAAK8vB,cAAcvwB,cAkBnBqzB,EAAAv3B,UAAAy0B,cAAR,SAAsBlC,GACpBzyB,KAAK0zB,YAAYlyB,KAAKixB,GAClBA,IAASruB,UACXpE,KAAK+3B,yBAEL/3B,KAAK03B,kBAAoB13B,KAAK03B,kBAC3B7vB,OAAM,SAAEmK,GAAiB,OAAAA,IAASygB,EAAKzgB,OACvC9P,OAAO,CAACuwB,EAAKzgB,QAOZylB,EAAAv3B,UAAA63B,uBAAR,WACE/3B,KAAK03B,kBAAoB,IAE7BD,oBCnKA,SAAAO,mDAA+D,OAAnClI,EAAAA,EAAAA,GAAmCkI,GAAnCzZ,mBCK5B,SAAA0Z,IAAA,IAAApzB,EAAA,OAAA+qB,GAAAA,EAAA5mB,MAAAhJ,KAAAU,YAAAV,YAEE6E,EAAAqzB,iBAA+C,IAAIrxB,EAAAA,gBAAgBzC,aAgCrE,OAlCoC0rB,EAAAA,EAAAA,GAQlCmI,EAAA/3B,UAAAu2B,kBAAA,SAAkBF,OACV3jB,EAAS5S,KAAKk4B,iBAAiBz2B,MACjCmR,IAAWxO,WACbwO,EAAOulB,aAGTn4B,KAAKo4B,sBACD7B,IAAcnyB,YAChBpE,KAAK0E,MAAMS,OAAOoxB,EAAW,CAAC3jB,QAAQ,EAAM7C,UAAU,IAAO,GAC7D/P,KAAKk4B,iBAAiB12B,KAAK+0B,GAC3BA,EAAU8B,aAQdJ,EAAA/3B,UAAAk4B,oBAAA,eACQxlB,EAAS5S,KAAKk4B,iBAAiBz2B,MACjCmR,IAAWxO,YACbwO,EAAOulB,aACPn4B,KAAKk4B,iBAAiB12B,KAAK4C,aAIjC6zB,GAlCoCjuB,iBC8ElC,SAAAsuB,EAAsBx0B,GAAA9D,KAAA8D,QAAAA,EAnEb9D,KAAA62B,QAAU,IAAIhwB,EAAAA,gBAAwBzC,WAKtCpE,KAAA82B,cAAgB,IAAIjwB,EAAAA,gBAAsC,IAK1D7G,KAAA+2B,mBAAqB,IAAIlwB,EAAAA,gBAAuD,IAUjF7G,KAAA4S,QAAkB,EAKlB5S,KAAA6xB,OAAwB,IAAI0G,EAAAA,QA0HtC,OAhHE/4B,OAAAyB,eAAIq3B,EAAAp4B,UAAA,KAAE,KAAN,WAAmB,OAAOF,KAAK8D,QAAQN,oCAKvChE,OAAAyB,eAAIq3B,EAAAp4B,UAAA,QAAK,KAAT,WAAsB,OAAOF,KAAK8D,QAAQH,uCAK1CnE,OAAAyB,eAAIq3B,EAAAp4B,UAAA,OAAI,KAAR,WAAmC,OAAOF,KAAK8D,QAAQP,MAAQ,oCAK/D/D,OAAAyB,eAAIq3B,EAAAp4B,UAAA,cAAW,KAAf,WAAoC,OAAOF,KAAK8D,QAAmB,6CAKnEtE,OAAAyB,eAAIq3B,EAAAp4B,UAAA,cAAW,KAAf,WAAiC,OAAOF,KAAK8D,QAAQ6vB,6CAKrDn0B,OAAAyB,eAAIq3B,EAAAp4B,UAAA,SAAM,KAAV,WAAuB,OAAOF,KAAK62B,QAAQp1B,uCAK3CjC,OAAAyB,eAAIq3B,EAAAp4B,UAAA,YAAS,KAAb,WAA2B,OAAOF,KAAKg2B,SAAW5xB,2CAOlDk0B,EAAAp4B,UAAAs4B,SAAA,WAAsB,OAAOx4B,KAAK4S,QAOlC0lB,EAAAp4B,UAAAm4B,SAAA,WAAA,IAAAxzB,EAAA7E,MACsB,IAAhBA,KAAK4S,QACP5S,KAAKm4B,aAEPn4B,KAAK4S,QAAS,EAEV5S,KAAKy4B,cAAgBr0B,YACvBpE,KAAKwL,WAAaxL,KAAKy4B,YAAYpuB,UAAUhD,OAC1CsB,UAAS,WAAO,OAAA9D,EAAK8G,mBAGtB3L,KAAK2zB,cAAgBvvB,YACvBpE,KAAKiE,QAAUjE,KAAK6xB,OACjBnqB,KAAKgB,EAAAA,aAAa,KAClBC,UAAS,WAAO,OAAA9D,EAAK8uB,YAAYb,+BAGtC9yB,KAAK6xB,OAAOrwB,QAMd82B,EAAAp4B,UAAAi4B,WAAA,WACEn4B,KAAK4S,QAAS,EACd5S,KAAK42B,mBAED52B,KAAKwL,aAAepH,WACtBpE,KAAKwL,WAAWtD,cAEdlI,KAAKiE,UAAYG,WACnBpE,KAAKiE,QAAQiE,eAWjBowB,EAAAp4B,UAAAw4B,eAAA,SACE1C,EACAtX,EACAC,QADA,IAAAD,IAAAA,EAAA,SACA,IAAAC,IAAAA,EAAA,IAEA3e,KAAK62B,QAAQr1B,KAAKw0B,GAClBh2B,KAAK82B,cAAct1B,KAAKkd,GACxB1e,KAAK+2B,mBAAmBv1B,KAAKmd,GAC7B3e,KAAK6xB,OAAOrwB,QAMd82B,EAAAp4B,UAAA02B,iBAAA,WACE52B,KAAK62B,QAAQr1B,KAAK4C,WAClBpE,KAAK6xB,OAAOrwB,QAMN82B,EAAAp4B,UAAAyL,cAAR,WACE3L,KAAK6xB,OAAOrwB,QAGhB82B,kiDpGrHA,SAAmCp1B,OAC3BK,EAAO,EAAgBA,MAAQ,GACrC,OAAOA,EAAKo1B,UAAYp1B,EAAKo1B,UAAY11B,EAAkBC,EAAQK,EAAKq1B,mBAAqB,8BAS/F,SAA8B11B,OACtBK,EAAO,EAAgBA,MAAQ,GACrC,OAAOA,EAAK4R,KAAO5R,EAAK4R,KAAOlS,EAAkBC,EAAQK,EAAKs1B,cAAgB,6BAQhF,SAAkC31B,GAEhC,OADa,EAAgBK,MAAQ,IACzBu1B,UAAY,wkBqGrE1B,SAA8BrG,GAC5B,OAAA,SAAQrN,GACNoN,GAAY/N,SAASjlB,OAAOuF,OAAO,GAAI0tB,EAAI,CACzCrS,UAAWgF","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export enum EntityOperationType {\r\n  Insert = 'Insert',\r\n  Update = 'Update',\r\n  Delete = 'Delete'\r\n}\r\n\r\nexport enum EntityTableColumnRenderer {\r\n  Default = 'Default',\r\n  HTML = 'HTML',\r\n  UnsanitizedHTML = 'UnsanitizedHTML',\r\n  Icon = 'Icon',\r\n  ButtonGroup = 'ButtonGroup'\r\n}\r\n\r\nexport enum EntityTableScrollBehavior {\r\n  Auto = 'auto',\r\n  Instant = 'instant',\r\n  Smooth = 'smooth'\r\n}\r\n\r\nexport enum EntityTableSelectionState {\r\n  None = 'None',\r\n  All = 'All',\r\n  Some = 'Some'\r\n}\r\n","import t from 'typy';\r\n\r\nimport { EntityKey } from './entity.interfaces';\r\n\r\n/**\r\n * Get an entity's named property. Nested properties are supported\r\n * with the dotted notation. (i.e 'author.name')\r\n *\r\n * Note: this method is a 'best attempt' at getting an entity's property.\r\n * It fits the most common cases but you might need to explicitely define\r\n * a property getter when using an EntityStore, for example.\r\n * @param entity Entity\r\n * @param property Property name\r\n * @returns Property value\r\n */\r\nexport function getEntityProperty(entity: object, property: string): any {\r\n  return t(entity, property).safeObject;\r\n}\r\n\r\n/**\r\n * Get an entity's id. An entity's id can be one of:\r\n * 'entity.meta.id', 'entity.meta.idProperty' or 'entity.id'.\r\n *\r\n * Note: See the note in the 'getEntityProperty' documentation.\r\n * @param entity Entity\r\n * @returns Entity id\r\n */\r\nexport function getEntityId(entity: object): EntityKey {\r\n  const meta = (entity as any).meta || {};\r\n  return meta.id ? meta.id : getEntityProperty(entity, meta.idProperty || 'id');\r\n}\r\n\r\n/**\r\n * Get an entity's title. An entity's title can be one of:\r\n * 'entity.meta.title', 'entity.meta.titleProperty' or 'entity.title'.\r\n * @param entity Entity\r\n * @returns Entity title\r\n */\r\nexport function getEntityTitle(entity: object): string {\r\n  const meta = (entity as any).meta || {};\r\n  return meta.title ? meta.title : getEntityProperty(entity, meta.titleProperty || 'title');\r\n}\r\n\r\n/**\r\n * Get an entity's HTML title. An entity's HTML title can be one of:\r\n * 'entity.meta.titleHtml', 'entity.meta.titleHtmlProperty' or 'entity.titleHtml'.\r\n * @param entity Entity\r\n * @returns Entity HTML title\r\n */\r\nexport function getEntityTitleHtml(entity: object): string {\r\n  const meta = (entity as any).meta || {};\r\n  return meta.titleHtml ? meta.titleHtml : getEntityProperty(entity, meta.titleHtmlProperty || 'titleHtml');\r\n}\r\n\r\n/**\r\n * Get an entity's icon. An entity's icon can be one of:\r\n * 'entity.meta.icon', 'entity.meta.iconProperty' or 'entity.icon'.\r\n * @param entity Entity\r\n * @returns Entity icon\r\n */\r\nexport function getEntityIcon(entity: object): string {\r\n  const meta = (entity as any).meta || {};\r\n  return meta.icon ? meta.icon : getEntityProperty(entity, meta.iconProperty || 'icon');\r\n}\r\n\r\n/**\r\n * Get an entity's revision.\r\n * @param entity Entity\r\n * @returns Entity revision\r\n */\r\nexport function getEntityRevision(entity: object): number {\r\n  const meta = (entity as any).meta || {};\r\n  return meta.revision || 0;\r\n}\r\n","import { ReplaySubject } from 'rxjs';\r\n\r\nimport { EntityKey, EntityState, EntityStateManagerOptions } from './entity.interfaces';\r\nimport { getEntityId } from './entity.utils';\r\nimport { EntityStore } from './store';\r\n\r\n/**\r\n * This class is used to track a store's entities state\r\n */\r\nexport class EntityStateManager<E extends object, S extends EntityState = EntityState> {\r\n\r\n  /**\r\n   * State index\r\n   */\r\n  readonly index = new Map<EntityKey, S>();\r\n\r\n  /**\r\n   * Change emitter\r\n   */\r\n  readonly change$ = new ReplaySubject<void>(1);\r\n\r\n  /**\r\n   * Method to get an entity's id\r\n   */\r\n  readonly getKey: (E) => EntityKey;\r\n\r\n  private store: EntityStore<object> | undefined;\r\n\r\n  constructor(options: EntityStateManagerOptions = {}) {\r\n    this.store = options.store ? options.store : undefined;\r\n    this.getKey = options.getKey\r\n      ? options.getKey\r\n      : (this.store ? this.store.getKey : getEntityId);\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Clear state\r\n   */\r\n  clear() {\r\n    if (this.index.size > 0) {\r\n      this.index.clear();\r\n      this.next();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get an entity's state\r\n   * @param entity Entity\r\n   * @returns State\r\n   */\r\n  get(entity: E): S {\r\n    return (this.index.get(this.getKey(entity)) || {}) as S;\r\n  }\r\n\r\n  /**\r\n   * Set an entity's state\r\n   * @param entity Entity\r\n   * @param state State\r\n   */\r\n  set(entity: E, state: S) {\r\n    this.setMany([entity], state);\r\n  }\r\n\r\n  /**\r\n   * Set many entitie's state\r\n   * @param entitie Entities\r\n   * @param state State\r\n   */\r\n  setMany(entities: E[], state: S) {\r\n    entities.forEach((entity: E) => {\r\n      this.index.set(this.getKey(entity), Object.assign({}, state));\r\n    });\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Set state of all entities that already have a state. This is not\r\n   * the same as setting the state of all the store's entities.\r\n   * @param state State\r\n   */\r\n  setAll(state: S) {\r\n    Array.from(this.index.keys()).forEach((key: EntityKey) => {\r\n      this.index.set(key, Object.assign({}, state));\r\n    });\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Update an entity's state\r\n   * @param entity Entity\r\n   * @param changes State changes\r\n   */\r\n  update(entity: E, changes: Partial<S>, exclusive = false) {\r\n    this.updateMany([entity], changes, exclusive);\r\n  }\r\n\r\n  /**\r\n   * Update many entitie's state\r\n   * @param entitie Entities\r\n   * @param changes State changes\r\n   */\r\n  updateMany(entities: E[], changes: Partial<S>, exclusive = false) {\r\n    if (exclusive === true) {\r\n      return this.updateManyExclusive(entities, changes);\r\n    }\r\n\r\n    entities.forEach((entity: E) => {\r\n      const state = Object.assign({}, this.get(entity), changes);\r\n      this.index.set(this.getKey(entity), state);\r\n    });\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Reversee an entity's state\r\n   * @param entity Entity\r\n   * @param keys State keys to reverse\r\n   */\r\n  reverse(entity: E, keys: string[]) {\r\n    this.reverseMany([entity], keys);\r\n  }\r\n\r\n  /**\r\n   * Reverse many entitie's state\r\n   * @param entitie Entities\r\n   * @param keys State keys to reverse\r\n   */\r\n  reverseMany(entities: E[], keys: string[]) {\r\n    entities.forEach((entity: E) => {\r\n      const currentState = this.get(entity);\r\n      const changes = keys.reduce((acc: {[key: string]: boolean}, key: string) => {\r\n        acc[key] = currentState[key] || false;\r\n        return acc;\r\n      }, {});\r\n      const reversedChanges = this.reverseChanges(changes);\r\n      const state = Object.assign({}, currentState, reversedChanges);\r\n      this.index.set(this.getKey(entity), state);\r\n    });\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Update state of all entities that already have a state. This is not\r\n   * the same as updating the state of all the store's entities.\r\n   * @param changes State\r\n   */\r\n  updateAll(changes: Partial<S>) {\r\n    const allKeys = this.getAllKeys();\r\n    Array.from(allKeys).forEach((key: EntityKey) => {\r\n      const state = Object.assign({}, this.index.get(key), changes);\r\n      this.index.set(key, state);\r\n    });\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * When some state changes are flagged as 'exclusive', reverse\r\n   * the state of all other entities. Changes are reversable when\r\n   * they are boolean.\r\n   * @param entitie Entities\r\n   * @param changes State changes\r\n   */\r\n  private updateManyExclusive(entities: E[], changes: Partial<S>) {\r\n    const reverseChanges = this.reverseChanges(changes);\r\n\r\n    const keys = entities.map((entity: E) => this.getKey(entity));\r\n    const allKeys = new Set(keys.concat(Array.from(this.getAllKeys())));\r\n    allKeys.forEach((key: EntityKey) => {\r\n      const state = this.index.get(key) || {} as S;\r\n      if (keys.indexOf(key) >= 0) {\r\n        this.index.set(key, Object.assign({}, state, changes));\r\n      } else {\r\n        this.index.set(key, Object.assign({}, state, reverseChanges));\r\n      }\r\n    });\r\n\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Compute a 'reversed' version of some state changes.\r\n   * Changes are reversable when they are boolean.\r\n   * @param changes State changes\r\n   * @returns Reversed state changes\r\n   */\r\n  private reverseChanges(changes: Partial<S>): Partial<S> {\r\n    return Object.entries(changes).reduce((reverseChanges: Partial<S>, bunch: [string, any]) => {\r\n      const [changeKey, value] = bunch;\r\n      if (typeof value === typeof true) {\r\n        reverseChanges[changeKey] = !value;\r\n      }\r\n      return reverseChanges;\r\n    }, {});\r\n  }\r\n\r\n  /**\r\n   * Return all the keys in that state and in the store it's bound to, if any.\r\n   * @returns Set of keys\r\n   */\r\n  private getAllKeys(): Set<EntityKey> {\r\n    const storeKeys = this.store ? Array.from(this.store.index.keys()) : [];\r\n    return new Set(Array.from(this.index.keys()).concat(storeKeys));\r\n  }\r\n\r\n  /**\r\n   * Emit 'change' event\r\n   */\r\n  private next() {\r\n    this.change$.next();\r\n  }\r\n\r\n}\r\n","import { BehaviorSubject, Observable, Subscription, combineLatest } from 'rxjs';\r\nimport { debounceTime, map, skip } from 'rxjs/operators';\r\n\r\nimport { ObjectUtils } from '@igo2/utils';\r\nimport {\r\n  EntityFilterClause,\r\n  EntitySortClause,\r\n  EntityJoinClause\r\n} from './entity.interfaces';\r\n\r\n/**\r\n * An entity view streams entities from an observable source. These entities\r\n * can be filtered or sorted without affecting the source. A view can also\r\n * combine data from multiple sources, joined together.\r\n */\r\nexport class EntityView<E extends object, V extends object = E> {\r\n\r\n  /**\r\n   * Observable stream of values\r\n   */\r\n  readonly values$ = new BehaviorSubject<V[]>([]);\r\n\r\n  /**\r\n   * Whether this view has been lifted\r\n   */\r\n  private lifted = false;\r\n\r\n  /**\r\n   * Join clauses\r\n   */\r\n  private joins: EntityJoinClause[] = [];\r\n\r\n  /**\r\n   * Observable of a filter clause\r\n   */\r\n  private filter$ = new BehaviorSubject(undefined);\r\n\r\n  /**\r\n   * Observable of a sort clause\r\n   */\r\n  private sort$ = new BehaviorSubject(undefined);\r\n\r\n  /**\r\n   * Subscription to the source (and joined sources) values\r\n   */\r\n  private values$$: Subscription;\r\n\r\n  /**\r\n   * Number of entities\r\n   */\r\n  readonly count$ = new BehaviorSubject<number>(0);\r\n  get count(): number { return this.count$.value; }\r\n\r\n  /**\r\n   * Whether the store is empty\r\n   */\r\n  readonly empty$ = new BehaviorSubject<boolean>(true);\r\n  get empty(): boolean { return this.empty$.value; }\r\n\r\n  constructor(private source$: BehaviorSubject<E[]>) {}\r\n\r\n  /**\r\n   * Get all the values\r\n   * @returns Array of values\r\n   */\r\n  all(): V[] {\r\n    return this.values$.value;\r\n  }\r\n\r\n  /**\r\n   * Observe all the values\r\n   * @returns Observable of values\r\n   */\r\n  all$(): BehaviorSubject<V[]> {\r\n    return this.values$;\r\n  }\r\n\r\n  /**\r\n   * Get the first value that respects a criteria\r\n   * @returns A value\r\n   */\r\n  firstBy(clause: EntityFilterClause<V>): V {\r\n    return this.values$.value.find(clause);\r\n  }\r\n\r\n  /**\r\n   * Observe the first value that respects a criteria\r\n   * @returns Observable of a value\r\n   */\r\n  firstBy$(clause: EntityFilterClause<V>): Observable<V> {\r\n    return this.values$.pipe(map((values: V[]) => values.find(clause)));\r\n  }\r\n\r\n  /**\r\n   * Get all the values that respect a criteria\r\n   * @returns Array of values\r\n   */\r\n  manyBy(clause: EntityFilterClause<V>): V[] {\r\n    return this.values$.value.filter(clause);\r\n  }\r\n\r\n  /**\r\n   * Observe all the values that respect a criteria\r\n   * @returns Observable of values\r\n   */\r\n  manyBy$(clause: EntityFilterClause<V>): Observable<V[]> {\r\n    return this.values$.pipe(map((values: V[]) => values.filter(clause)));\r\n  }\r\n\r\n  /**\r\n   * Clear the filter and sort and unsubscribe from the source\r\n   */\r\n  clear() {\r\n    this.filter(undefined);\r\n    this.sort(undefined);\r\n  }\r\n\r\n  destroy() {\r\n    if (this.values$$ !== undefined) {\r\n      this.values$$.unsubscribe();\r\n    }\r\n    this.clear();\r\n  }\r\n\r\n  /**\r\n   * Join another source to the stream (chainable)\r\n   * @param clause Join clause\r\n   * @returns The view\r\n   */\r\n  join(clause: EntityJoinClause): EntityView<E, V> {\r\n    if (this.lifted === true) {\r\n      throw new Error('This view has already been lifted, therefore, no join is allowed.');\r\n    }\r\n    this.joins.push(clause);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Filter values (chainable)\r\n   * @param clause Filter clause\r\n   * @returns The view\r\n   */\r\n  filter(clause: EntityFilterClause<V>): EntityView<E, V> {\r\n    this.filter$.next(clause);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Sort values (chainable)\r\n   * @param clauseSort clause\r\n   * @returns The view\r\n   */\r\n  sort(clause: EntitySortClause<V>): EntityView<E, V> {\r\n    this.sort$.next(clause);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Create the final observable\r\n   * @returns Observable\r\n   */\r\n  lift() {\r\n    this.lifted = true;\r\n    const source$ = this.joins.length > 0 ? this.liftJoinedSource() : this.liftSource();\r\n    this.values$$ = combineLatest(source$, this.filter$, this.sort$)\r\n      .pipe(skip(1), debounceTime(25))\r\n      .subscribe((bunch: [V[], EntityFilterClause, EntitySortClause]) => {\r\n        const [_values, filter, sort] = bunch;\r\n        const values = this.processValues(_values, filter, sort);\r\n        this.setValues(values);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Create the source observable when no joins are defined\r\n   * @returns Observable\r\n   */\r\n  private liftSource(): Observable<V[]> {\r\n    return this.source$ as any as Observable<V[]>;\r\n  }\r\n\r\n  /**\r\n   * Create the source observable when joins are defined\r\n   * @returns Observable\r\n   */\r\n  private liftJoinedSource(): Observable<V[]> {\r\n    const sources$ = [this.source$, combineLatest(\r\n      ...this.joins.map((join: EntityJoinClause) => join.source)\r\n    )];\r\n\r\n    return combineLatest(...sources$)\r\n      .pipe(\r\n        map((bunch: [E[], any[]]) => {\r\n          const [entities, joinData] = bunch;\r\n          return entities.reduce((values: V[], entity: E) => {\r\n            const value = this.computeJoinedValue(entity, joinData);\r\n            if (value !== undefined) {\r\n              values.push(value);\r\n            }\r\n            return values;\r\n          }, []);\r\n        })\r\n      );\r\n  }\r\n\r\n  /**\r\n   * Apply joins to a source's entity and return the final value\r\n   * @returns Final value\r\n   */\r\n  private computeJoinedValue(entity: E, joinData: any[]): V | undefined {\r\n    let value = entity as Partial<V>;\r\n    let joinIndex = 0;\r\n    while (value !== undefined && joinIndex < this.joins.length) {\r\n      value = this.joins[joinIndex].reduce(value, joinData[joinIndex]);\r\n      joinIndex += 1;\r\n    }\r\n    return value as V;\r\n  }\r\n\r\n  /**\r\n   * Filter and sort values before streaming them\r\n   * @param values Values\r\n   * @param filter Filter clause\r\n   * @param sort Sort clause\r\n   * @returns Filtered and sorted values\r\n   */\r\n  private processValues(values: V[], filter: EntityFilterClause, sort: EntitySortClause): V[] {\r\n    values = values.slice(0);\r\n    values = this.filterValues(values, filter);\r\n    values = this.sortValues(values, sort);\r\n    return values;\r\n  }\r\n\r\n  /**\r\n   * Filter values\r\n   * @param values Values\r\n   * @param filter Filter clause\r\n   * @returns Filtered values\r\n   */\r\n  private filterValues(values: V[], clause: EntityFilterClause): V[] {\r\n    if (clause === undefined) { return values; }\r\n    return values.filter((value: V) => clause(value));\r\n  }\r\n\r\n  /**\r\n   * Sort values\r\n   * @param values Values\r\n   * @param sort Sort clause\r\n   * @returns Sorted values\r\n   */\r\n  private sortValues(values: V[], clause: EntitySortClause): V[] {\r\n    if (clause === undefined) { return values; }\r\n    return values.sort((v1: V, v2: V) => {\r\n      return ObjectUtils.naturalCompare(\r\n        clause.valueAccessor(v1),\r\n        clause.valueAccessor(v2),\r\n        clause.direction\r\n      );\r\n    });\r\n  }\r\n\r\n  private setValues(values: V[]) {\r\n    this.values$.next(values);\r\n    const count = values.length;\r\n    const empty = count === 0;\r\n    this.count$.next(count);\r\n    this.empty$.next(empty);\r\n  }\r\n}\r\n","import { BehaviorSubject } from 'rxjs';\r\n\r\nimport { EntityStateManager } from './state';\r\nimport { EntityView } from './view';\r\nimport { EntityKey, EntityState, EntityRecord, EntityStoreOptions } from './entity.interfaces';\r\nimport { getEntityId, getEntityProperty } from './entity.utils';\r\n\r\n/**\r\n * An entity store class holds any number of entities\r\n * as well as their state. It can be observed, filtered and sorted and\r\n * provides methods to insert, update or delete entities.\r\n */\r\nexport class EntityStore<E extends object, S extends EntityState = EntityState> {\r\n\r\n  /**\r\n   * Observable of the raw entities\r\n   */\r\n  readonly entities$ = new BehaviorSubject<E[]>([]);\r\n\r\n  /**\r\n   * Number of entities\r\n   */\r\n  readonly count$ = new BehaviorSubject<number>(0);\r\n  get count(): number { return this.count$.value; }\r\n\r\n  /**\r\n   * Whether the store is empty\r\n   */\r\n  readonly empty$ = new BehaviorSubject<boolean>(true);\r\n  get empty(): boolean { return this.empty$.value; }\r\n\r\n  /**\r\n   * Entity store state\r\n   */\r\n  readonly state: EntityStateManager<E, S>;\r\n\r\n  /**\r\n   * View of all the entities\r\n   */\r\n  readonly view: EntityView<E>;\r\n\r\n  /**\r\n   * View of all the entities and their state\r\n   */\r\n  readonly stateView: EntityView<E, EntityRecord<E, S>>;\r\n\r\n  /**\r\n   * Method to get an entity's id\r\n   */\r\n  readonly getKey: (E) => EntityKey;\r\n\r\n  /**\r\n   * Method to get an entity's named property\r\n   */\r\n  readonly getProperty: (E, prop: string) => any;\r\n\r\n  /**\r\n   * Store index\r\n   */\r\n  get index(): Map<EntityKey, E> { return this._index; }\r\n  private _index: Map<EntityKey, E>;\r\n\r\n  /**\r\n   * Store index\r\n   */\r\n  get pristine(): boolean { return this._pristine; }\r\n  private _pristine: boolean = true;\r\n\r\n  constructor(entities: E[], options: EntityStoreOptions = {}) {\r\n    this.getKey = options.getKey ? options.getKey : getEntityId;\r\n    this.getProperty = options.getProperty ? options.getProperty : getEntityProperty;\r\n\r\n    this.state = new EntityStateManager<E, S>({store: this});\r\n    this.view = new EntityView<E>(this.entities$);\r\n    this.stateView = new EntityView<E, EntityRecord<E, S>>(this.view.all$()).join({\r\n      source: this.state.change$,\r\n      reduce: (entity: E): EntityRecord<E, S> => {\r\n        return {entity, state: this.state.get(entity)};\r\n      }\r\n    });\r\n\r\n    this.view.lift();\r\n    this.stateView.lift();\r\n\r\n    if (entities.length > 0) {\r\n      this.load(entities);\r\n    } else {\r\n      this._index = this.generateIndex(entities);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get an entity from the store by key\r\n   * @param key Key\r\n   * @returns Entity\r\n   */\r\n  get(key: EntityKey): E {\r\n    return this.index.get(key);\r\n  }\r\n\r\n  /**\r\n   * Get all entities in the store\r\n   * @returns Array of entities\r\n   */\r\n  all(): E[] {\r\n    return this.entities$.value;\r\n  }\r\n\r\n  /**\r\n   * Set this store's entities\r\n   * @param entities Entities\r\n   */\r\n  load(entities: E[], pristine: boolean = true) {\r\n    this._index = this.generateIndex(entities);\r\n    this._pristine = pristine;\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Clear the store's entities but keep the state and views intact.\r\n   * Views won't return any data but future data will be subject to the\r\n   * current views filter and sort\r\n   */\r\n  softClear() {\r\n    if (this.index && this.index.size > 0) {\r\n      this.index.clear();\r\n      this._pristine = true;\r\n      this.next();\r\n    } else if (this.index) {\r\n      this.updateCount();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear the store's entities, state and views\r\n   */\r\n  clear() {\r\n    this.stateView.clear();\r\n    this.view.clear();\r\n    this.state.clear();\r\n    this.softClear();\r\n  }\r\n\r\n  destroy() {\r\n    this.stateView.destroy();\r\n    this.view.destroy();\r\n    this.clear();\r\n  }\r\n\r\n  /**\r\n   * Insert an entity into the store\r\n   * @param entity Entity\r\n   */\r\n  insert(entity: E) {\r\n    this.insertMany([entity]);\r\n  }\r\n\r\n  /**\r\n   * Insert many entities into the store\r\n   * @param entities Entities\r\n   */\r\n  insertMany(entities: E[]) {\r\n    entities.forEach((entity: E) => this.index.set(this.getKey(entity), entity));\r\n    this._pristine = false;\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Update or insert an entity into the store\r\n   * @param entity Entity\r\n   */\r\n  update(entity: E) {\r\n    this.updateMany([entity]);\r\n  }\r\n\r\n  /**\r\n   * Update or insert many entities into the store\r\n   * @param entities Entities\r\n   */\r\n  updateMany(entities: E[]) {\r\n    entities.forEach((entity: E) => this.index.set(this.getKey(entity), entity));\r\n    this._pristine = false;\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Delete an entity from the store\r\n   * @param entity Entity\r\n   */\r\n  delete(entity: E) {\r\n    this.deleteMany([entity]);\r\n  }\r\n\r\n  /**\r\n   * Delete many entities from the store\r\n   * @param entities Entities\r\n   */\r\n  deleteMany(entities: E[]) {\r\n    entities.forEach((entity: E) => this.index.delete(this.getKey(entity)));\r\n    this._pristine = false;\r\n    this.next();\r\n  }\r\n\r\n  /**\r\n   * Generate a complete index of all the entities\r\n   * @param entities Entities\r\n   * @returns Index\r\n   */\r\n  private generateIndex(entities: E[]): Map<EntityKey, E> {\r\n    const entries = entities.map((entity: E) => [this.getKey(entity), entity]);\r\n    return new Map(entries as [EntityKey, E][]);\r\n  }\r\n\r\n  /**\r\n   * Push the index's entities into the entities$ observable\r\n   */\r\n  private next() {\r\n    this.entities$.next(Array.from(this.index.values()));\r\n    this.updateCount();\r\n  }\r\n\r\n  /**\r\n   * Update the store's count and empty\r\n   */\r\n  private updateCount() {\r\n    const count = this.index.size;\r\n    const empty = count === 0;\r\n    this.count$.next(count);\r\n    this.empty$.next(empty);\r\n  }\r\n\r\n}\r\n","import { ChangeDetectorRef } from '@angular/core';\r\n\r\nimport { Subscription } from 'rxjs';\r\nimport { skip } from 'rxjs/operators';\r\n\r\nimport { ObjectUtils } from '@igo2/utils';\r\nimport { EntityKey } from './entity.interfaces';\r\n\r\nimport { EntityStore } from './store';\r\n\r\n/**\r\n * This class is used to synchronize a component's changes\r\n * detection with an EntityStore changes. For example, it is frequent\r\n * to have a component subscribe to a store's selected entity and, at the same time,\r\n * this component provides a way to select an entity with, let's say, a click.\r\n *\r\n * This class automatically handles those case and triggers the compoent's\r\n * change detection when needed.\r\n *\r\n * Note: If the component observes the store's stateView, a workspace is\r\n * probably not required because the stateView catches any changes to the\r\n * entities and their state.\r\n */\r\nexport class EntityStoreWatcher<E extends object> {\r\n\r\n  /**\r\n   * Component change detector\r\n   */\r\n  private cdRef: ChangeDetectorRef;\r\n\r\n  /**\r\n   * Entity store\r\n   */\r\n  private store: EntityStore<E>;\r\n\r\n  /**\r\n   * Component inner state\r\n   */\r\n  private innerStateIndex = new Map<EntityKey, {[key: string]: any}>();\r\n\r\n  /**\r\n   * Subscription to the store's entities\r\n   */\r\n  private entities$$: Subscription;\r\n\r\n  /**\r\n   * Subscription to the store's state\r\n   */\r\n  private state$$: Subscription;\r\n\r\n  constructor(store?: EntityStore<E>, cdRef?: ChangeDetectorRef) {\r\n    this.setChangeDetector(cdRef);\r\n    this.setStore(store);\r\n  }\r\n\r\n  destroy() {\r\n    this.setChangeDetector(undefined);\r\n    this.setStore(undefined);\r\n  }\r\n\r\n  /**\r\n   * Bind this workspace to a store and start watching for changes\r\n   * @param store Entity store\r\n   */\r\n  setStore(store?: EntityStore<E>) {\r\n    if (store === undefined) {\r\n      this.teardownObservers();\r\n      this.innerStateIndex.clear();\r\n      this.store = undefined;\r\n      return;\r\n    }\r\n\r\n    this.setStore(undefined);\r\n    this.store = store;\r\n    this.setupObservers();\r\n    this.detectChanges();\r\n  }\r\n\r\n  /**\r\n   * Bind this workspace to a component's change detector\r\n   * @param cdRef Change detector\r\n   */\r\n  setChangeDetector(cdRef?: ChangeDetectorRef) {\r\n    this.cdRef = cdRef;\r\n  }\r\n\r\n  /**\r\n   * Set up observers on a store's entities and their state\r\n   * @param store Entity store\r\n   */\r\n  private setupObservers() {\r\n    this.teardownObservers();\r\n\r\n    this.entities$$ = this.store.entities$\r\n      .subscribe((entities: E[]) => this.onEntitiesChange(entities));\r\n\r\n    this.state$$ = this.store.state.change$\r\n      .pipe(skip(1))\r\n      .subscribe(() => this.onStateChange());\r\n  }\r\n\r\n  /**\r\n   * Teardown store observers\r\n   */\r\n  private teardownObservers() {\r\n    if (this.entities$$ !== undefined) {\r\n      this.entities$$.unsubscribe();\r\n    }\r\n    if (this.state$$ !== undefined) {\r\n      this.state$$.unsubscribe();\r\n    }\r\n    this.entities$$ = undefined;\r\n    this.state$$ = undefined;\r\n  }\r\n\r\n  /**\r\n   * When the entities change, always trigger the changes detection\r\n   */\r\n  private onEntitiesChange(entities: E[]) {\r\n    this.detectChanges();\r\n  }\r\n\r\n  /**\r\n   * When the entities state change, trigger the change detection\r\n   * only if the component has not handled these changes yet. For example,\r\n   * the component might have initiated thoses changes itself.\r\n   */\r\n  private onStateChange() {\r\n    let changesDetected = false;\r\n    const storeIndex = this.store.state.index;\r\n    const innerIndex = this.innerStateIndex;\r\n\r\n    if (storeIndex.size !== innerIndex.size) {\r\n      changesDetected = this.detectChanges();\r\n    }\r\n\r\n    const storeKeys = Array.from(storeIndex.keys());\r\n    for (const key of storeKeys) {\r\n      const storeValue = storeIndex.get(key);\r\n      const innerValue = innerIndex.get(key);\r\n      if (changesDetected === false) {\r\n        if (innerValue === undefined) {\r\n          changesDetected = this.detectChanges();\r\n        } else if (!ObjectUtils.objectsAreEquivalent(storeValue, innerValue)) {\r\n          changesDetected = this.detectChanges();\r\n        }\r\n      }\r\n\r\n      this.innerStateIndex.set(key, Object.assign({}, storeValue));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Trigger the change detection of the workspace is bound to a change detector\r\n   */\r\n  private detectChanges() {\r\n    if (this.cdRef !== undefined) {\r\n      this.cdRef.detectChanges();\r\n    }\r\n    return true;\r\n  }\r\n\r\n}\r\n","import { Observable, of } from 'rxjs';\r\nimport { catchError, tap } from 'rxjs/operators';\r\n\r\nimport {\r\n  EntityKey,\r\n  EntityTransactionOptions,\r\n  EntityOperation,\r\n  EntityOperationState\r\n} from './entity.interfaces';\r\nimport { EntityStore } from './store';\r\nimport { EntityOperationType } from './entity.enums';\r\nimport { getEntityId } from './entity.utils';\r\n\r\nexport type EntityTransactionCommitHandler = (\r\n  transaction: EntityTransaction,\r\n  operations: EntityOperation[]\r\n) => Observable<any>;\r\n\r\n/**\r\n * This class holds a reference to the insert, update and delete\r\n * operations performed on a store. This is useful to commit\r\n * these operations in a single pass or to cancel them.\r\n */\r\nexport class EntityTransaction {\r\n\r\n  /**\r\n   * Store holding the operations on another store\r\n   */\r\n  readonly operations: EntityStore<EntityOperation, EntityOperationState>;\r\n\r\n  /**\r\n   * Method to get an entity's id\r\n   */\r\n  readonly getKey: (E) => EntityKey;\r\n\r\n  /**\r\n   * Whether there are pending operations\r\n   */\r\n  get empty(): boolean { return this.operations.entities$.value.length === 0; }\r\n\r\n  /**\r\n   * Whether thise store is in commit phase\r\n   */\r\n  get inCommitPhase(): boolean { return this._inCommitPhase; }\r\n  private _inCommitPhase = false;\r\n\r\n  constructor(options: EntityTransactionOptions = {}) {\r\n    this.getKey = options.getKey ? options.getKey : getEntityId;\r\n    this.operations = new EntityStore<EntityOperation, EntityOperationState>([], {\r\n      getKey: (operation: EntityOperation) => operation.key\r\n    });\r\n  }\r\n\r\n  destroy() {\r\n    this.operations.destroy();\r\n  }\r\n\r\n  /**\r\n   * Insert an entity into a store. If no store is specified, an insert\r\n   * operation is still created but the transaction won't add the new\r\n   * entity to the store.\r\n   * @param current The entity to insert\r\n   * @param store Optional: The store to insert the entity into\r\n   * @param meta Optional: Any metadata on the operation\r\n   */\r\n  insert(current: object, store?: EntityStore<object>, meta?: {[key: string]: any}) {\r\n    const existingOperation = this.getOperationByEntity(current);\r\n    if (existingOperation !== undefined) {\r\n      this.removeOperation(existingOperation);\r\n    }\r\n\r\n    this.doInsert(current, store, meta);\r\n  }\r\n\r\n  /**\r\n   * Update an entity in a store. If no store is specified, an update\r\n   * operation is still created but the transaction won't update the\r\n   * entity into the store.\r\n   * @param previous The entity before update\r\n   * @param current The entity after update\r\n   * @param store Optional: The store to update the entity into\r\n   * @param meta Optional: Any metadata on the operation\r\n   */\r\n  update(previous: object, current: object, store?: EntityStore<object>, meta?: {[key: string]: any}) {\r\n    const existingOperation = this.getOperationByEntity(current);\r\n    if (existingOperation !== undefined) {\r\n      this.removeOperation(existingOperation);\r\n      if (existingOperation.type === EntityOperationType.Insert) {\r\n        this.doInsert(current, store, meta);\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.doUpdate(previous, current, store, meta);\r\n  }\r\n\r\n  /**\r\n   * Delete an entity from a store. If no store is specified, a delete\r\n   * operation is still created but the transaction won't remove the\r\n   * entity from the store.\r\n   * @param previous The entity before delete\r\n   * @param store Optional: The store to delete the entity from\r\n   * @param meta Optional: Any metadata on the operation\r\n   */\r\n  delete(previous: object, store?: EntityStore<object>, meta?: {[key: string]: any}) {\r\n    const existingOperation = this.getOperationByEntity(previous);\r\n    if (existingOperation !== undefined) {\r\n      this.removeOperation(existingOperation);\r\n      if (existingOperation.type === EntityOperationType.Insert) {\r\n        if (store !== undefined) {\r\n          store.delete(previous);\r\n        }\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.doDelete(previous, store, meta);\r\n  }\r\n\r\n  /**\r\n   * Commit operations the transaction. This method doesn't do much\r\n   * in itself. The handler it receives does the hard work and it's\r\n   * implementation is left to the caller. This method simply wraps\r\n   * the handler into an error catching mechanism to update\r\n   * the transaction afterward. The caller needs to subscribe to this\r\n   * method's output (observable) for the commit to be performed.\r\n   * @param operations Operations to commit\r\n   * @param handler Function that handles the commit operation\r\n   * @returns The handler output (observable)\r\n   */\r\n  commit(operations: EntityOperation[], handler: EntityTransactionCommitHandler): Observable<any> {\r\n    this._inCommitPhase = true;\r\n\r\n    return handler(this, operations)\r\n      .pipe(\r\n        catchError(() => of(new Error())),\r\n        tap((result: any) => {\r\n          if (result instanceof Error) {\r\n            this.onCommitError(operations);\r\n          } else {\r\n            this.onCommitSuccess(operations);\r\n          }\r\n        })\r\n      );\r\n  }\r\n\r\n  /**\r\n   * Commit all the operations of the transaction.\r\n   * @param handler Function that handles the commit operation\r\n   * @returns The handler output (observable)\r\n   */\r\n  commitAll(handler: EntityTransactionCommitHandler): Observable<any> {\r\n    const operations = this.getOperationsInCommit();\r\n    return this.commit(operations, handler);\r\n  }\r\n\r\n  /**\r\n   * Rollback this transaction\r\n   */\r\n  rollback() {\r\n    this.rollbackOperations(this.operations.all());\r\n  }\r\n\r\n  /**\r\n   * Rollback specific operations\r\n   */\r\n  rollbackOperations(operations: EntityOperation[]) {\r\n    this.checkInCommitPhase();\r\n\r\n    const operationsFactory = () => new Map([\r\n      [EntityOperationType.Delete, []],\r\n      [EntityOperationType.Update, []],\r\n      [EntityOperationType.Insert, []]\r\n    ]);\r\n    const storesOperations = new Map();\r\n\r\n    // Group operations by store and by operation type.\r\n    // Grouping operations allows us to revert them in bacth, thus, triggering\r\n    // observables only one per operation type.\r\n    for (const operation of operations) {\r\n      const store = operation.store;\r\n      if (operation.store === undefined) { continue; }\r\n\r\n      let storeOperations = storesOperations.get(store);\r\n      if (storeOperations === undefined) {\r\n        storeOperations = operationsFactory();\r\n        storesOperations.set(store, storeOperations);\r\n      }\r\n      storeOperations.get(operation.type).push(operation);\r\n    }\r\n\r\n    Array.from(storesOperations.keys()).forEach((store: EntityStore<object>) => {\r\n      const storeOperations = storesOperations.get(store);\r\n\r\n      const deletes = storeOperations.get(EntityOperationType.Delete);\r\n      store.insertMany(deletes.map((_delete: EntityOperation) => _delete.previous));\r\n\r\n      const updates = storeOperations.get(EntityOperationType.Update);\r\n      store.updateMany(updates.map((_update: EntityOperation) => _update.previous));\r\n\r\n      const inserts = storeOperations.get(EntityOperationType.Insert);\r\n      store.deleteMany(inserts.map((_insert: EntityOperation) => _insert.current));\r\n    });\r\n\r\n    this.operations.deleteMany(operations);\r\n    this._inCommitPhase = false;\r\n  }\r\n\r\n  /**\r\n   * Clear this transaction\r\n   * @todo Raise event and synchronize stores?\r\n   */\r\n  clear() {\r\n    this.operations.clear();\r\n    this._inCommitPhase = false;\r\n  }\r\n\r\n  /**\r\n   * Merge another transaction in this one\r\n   * @param transaction Another transaction\r\n   */\r\n  mergeTransaction(transaction: EntityTransaction) {\r\n    this.checkInCommitPhase();\r\n\r\n    const operations = transaction.operations.all();\r\n    operations.forEach((operation: EntityOperation) => {\r\n      this.addOperation(operation);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create an insert operation and add an entity to the store\r\n   * @param current The entity to insert\r\n   * @param store Optional: The store to insert the entity into\r\n   * @param meta Optional: Any metadata on the operation\r\n   */\r\n  private doInsert(current: object, store?: EntityStore<object>, meta?: {[key: string]: any}) {\r\n    this.addOperation({\r\n      key: this.getKey(current),\r\n      type: EntityOperationType.Insert,\r\n      previous: undefined,\r\n      current,\r\n      store,\r\n      meta\r\n    });\r\n\r\n    if (store !== undefined) {\r\n      store.insert(current);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create an update operation and update an entity into the store\r\n   * @param previous The entity before update\r\n   * @param current The entity after update\r\n   * @param store Optional: The store to update the entity into\r\n   * @param meta Optional: Any metadata on the operation\r\n   */\r\n  private doUpdate(previous: object, current: object, store?: EntityStore<object>, meta?: {[key: string]: any}) {\r\n    this.addOperation({\r\n      key: this.getKey(current),\r\n      type: EntityOperationType.Update,\r\n      previous,\r\n      current,\r\n      store,\r\n      meta\r\n    });\r\n\r\n    if (store !== undefined) {\r\n      store.update(current);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create a delete operation and delete an entity from the store\r\n   * @param previous The entity before delete\r\n   * @param store Optional: The store to delete the entity from\r\n   * @param meta Optional: Any metadata on the operation\r\n   */\r\n  private doDelete(previous: object, store?: EntityStore<object>, meta?: {[key: string]: any}) {\r\n    this.addOperation({\r\n      key: this.getKey(previous),\r\n      type: EntityOperationType.Delete,\r\n      previous,\r\n      current: undefined,\r\n      store,\r\n      meta\r\n    });\r\n\r\n    if (store !== undefined) {\r\n      store.delete(previous);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove committed operations from store\r\n   * @param operations Commited operations\r\n   * @todo Raise event and synchronize stores?\r\n   */\r\n  private resolveOperations(operations: EntityOperation[]) {\r\n    this.operations.deleteMany(operations);\r\n  }\r\n\r\n  /**\r\n   * On commit success, resolve commited operations and exit commit phase\r\n   * @param operations Commited operations\r\n   */\r\n  private onCommitSuccess(operations: EntityOperation[]) {\r\n    this.resolveOperations(operations);\r\n    this._inCommitPhase = false;\r\n  }\r\n\r\n  /**\r\n   * On commit error, abort transaction\r\n   * @param operations Commited operations\r\n   */\r\n  private onCommitError(operations: EntityOperation[]) {\r\n    this._inCommitPhase = false;\r\n  }\r\n\r\n  /**\r\n   * Add an operation to the operations store\r\n   * @param operation Operation to add\r\n   */\r\n  private addOperation(operation: EntityOperation) {\r\n    this.checkInCommitPhase();\r\n\r\n    this.operations.insert(operation);\r\n    this.operations.state.update(operation, {added: true});\r\n  }\r\n\r\n  /**\r\n   * Remove an operation from the operations store\r\n   * @param operation Operation to remove\r\n   */\r\n  private removeOperation(operation: EntityOperation) {\r\n    this.checkInCommitPhase();\r\n\r\n    this.operations.delete(operation);\r\n    this.operations.state.update(operation, {added: false});\r\n  }\r\n\r\n  /**\r\n   * Get the any existing operation an entity\r\n   * @param entity Entity\r\n   * @returns Either an insert, update or delete operation\r\n   */\r\n  private getOperationByEntity(entity: object): EntityOperation {\r\n    return this.operations.get(this.getKey(entity));\r\n  }\r\n\r\n  /**\r\n   * Get all the operations to commit\r\n   * @returns Operations to commit\r\n   */\r\n  private getOperationsInCommit(): EntityOperation[] {\r\n    return this.operations.stateView\r\n      .manyBy((value: {entity: EntityOperation, state: EntityOperationState}) => {\r\n        return value.state.added === true;\r\n      })\r\n      .map((value: {entity: EntityOperation, state: EntityOperationState}) => value.entity);\r\n  }\r\n\r\n  /**\r\n   * Check if the transaction is in the commit phase and throw an error if it is\r\n   */\r\n  private checkInCommitPhase() {\r\n    if (this.inCommitPhase === true) {\r\n      throw new Error('This transaction is in the commit phase. Cannot complete this operation.');\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  OnInit,\r\n  OnDestroy\r\n} from '@angular/core';\r\n\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\n\r\nimport { EntityRecord } from '../shared/entity.interfaces';\r\nimport { EntityStore } from '../shared/store';\r\nimport { EntityStoreWatcher } from '../shared/watcher';\r\nimport { getEntityTitle } from '../shared/entity.utils';\r\n\r\n@Component({\r\n  selector: 'igo-entity-selector',\r\n  templateUrl: './entity-selector.component.html',\r\n  styleUrls: ['./entity-selector.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class EntitySelectorComponent implements OnInit, OnDestroy {\r\n\r\n  /**\r\n   * The selected entity\r\n   * @internal\r\n   */\r\n  selected$ = new BehaviorSubject<object>(undefined);\r\n\r\n  /**\r\n   * The current multi select option text\r\n   * @internal\r\n   */\r\n  multiText$ = new BehaviorSubject<string>(undefined);\r\n\r\n  readonly multiSelectValue = {id: 'IGO_MULTI_SELECT'};\r\n\r\n  /**\r\n   * Subscription to the selected entity\r\n   */\r\n  private selected$$: Subscription;\r\n\r\n  /**\r\n   * Store watcher\r\n   */\r\n  private watcher: EntityStoreWatcher<object>;\r\n\r\n  /**\r\n   * Entity store\r\n   */\r\n  @Input() store: EntityStore<object>;\r\n\r\n  /**\r\n   * Title accessor\r\n   */\r\n  @Input() titleAccessor: (object) => string = getEntityTitle;\r\n\r\n  /**\r\n   * Text to display when nothing is selected\r\n   */\r\n  @Input() emptyText: string = undefined;\r\n\r\n  /**\r\n   * Wheter selecting many entities is allowed\r\n   */\r\n  @Input() multi: boolean = false;\r\n\r\n  /**\r\n   * Text to display for the select all option\r\n   */\r\n  @Input() multiAllText: string = 'All';\r\n\r\n  /**\r\n   * Text to display for the select none option\r\n   */\r\n  @Input() multiNoneText: string = 'None';\r\n\r\n  /**\r\n   * Field placeholder\r\n   */\r\n  @Input() placeholder: string;\r\n\r\n  /**\r\n   * Event emitted when the selection changes\r\n   */\r\n  @Output() selectedChange = new EventEmitter<{\r\n    selected: boolean;\r\n    value: object | object[];\r\n  }>();\r\n\r\n  constructor(private cdRef: ChangeDetectorRef) {}\r\n\r\n  /**\r\n   * Create a store watcher and subscribe to the selected entity\r\n   * @internal\r\n   */\r\n  ngOnInit() {\r\n    this.watcher = new EntityStoreWatcher(this.store, this.cdRef);\r\n\r\n    this.selected$$ = this.store.stateView\r\n      .manyBy$((record: EntityRecord<object>) => record.state.selected === true)\r\n      .subscribe((records: EntityRecord<object>[]) => {\r\n        const entities = records.map((record: EntityRecord<object>) => record.entity);\r\n        this.onSelectFromStore(entities);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Unsubscribe to the selected entity and destroy the store watcher\r\n   * @internal\r\n   */\r\n  ngOnDestroy() {\r\n    this.watcher.destroy();\r\n    this.selected$$.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * On selection change, update the store's state and emit an event\r\n   * @internal\r\n   */\r\n  onSelectionChange(event: {value: object | undefined}) {\r\n    const values = event.value instanceof Array ? event.value : [event.value];\r\n\r\n    const multiSelect = values.find((_value: object) => _value === this.multiSelectValue);\r\n    let entities = values.filter((_value: object) => _value !== this.multiSelectValue);\r\n    if (multiSelect !== undefined) {\r\n      if (entities.length === this.store.count) {\r\n        entities = [];\r\n      } else if (entities.length < this.store.count) {\r\n        entities = this.store.all();\r\n      }\r\n    }\r\n\r\n    if (entities.length === 0) {\r\n      this.store.state.updateAll({selected: false});\r\n    } else {\r\n      this.store.state.updateMany(entities, {selected: true}, true);\r\n    }\r\n\r\n    const value = this.multi ? entities : event.value;\r\n    this.selectedChange.emit({selected: true, value});\r\n  }\r\n\r\n  private onSelectFromStore(entities: object[]) {\r\n    if (this.multi === true) {\r\n      this.selected$.next(entities);\r\n    } else {\r\n      const entity = entities.length > 0 ? entities[0] : undefined;\r\n      this.selected$.next(entity);\r\n    }\r\n\r\n    this.updateMultiToggleWithEntities(entities);\r\n  }\r\n\r\n  private updateMultiToggleWithEntities(entities: object[]) {\r\n    if (entities.length === this.store.count && this.multiText$.value !== this.multiNoneText) {\r\n      this.multiText$.next(this.multiNoneText);\r\n    } else if (entities.length < this.store.count && this.multiText$.value !== this.multiAllText) {\r\n      this.multiText$.next(this.multiAllText);\r\n    }\r\n  }\r\n\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  SimpleChanges,\r\n  OnInit,\r\n  OnDestroy,\r\n  OnChanges\r\n} from '@angular/core';\r\n\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\n\r\nimport {\r\n  EntityRecord,\r\n  EntityStore,\r\n  EntityStoreWatcher,\r\n  EntityTableTemplate,\r\n  EntityTableColumn,\r\n  EntityTableColumnRenderer,\r\n  EntityTableSelectionState,\r\n  EntityTableScrollBehavior\r\n} from '../shared';\r\n\r\n@Component({\r\n  selector: 'igo-entity-table',\r\n  templateUrl: './entity-table.component.html',\r\n  styleUrls: ['./entity-table.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class EntityTableComponent implements OnInit, OnDestroy, OnChanges  {\r\n\r\n  /**\r\n   * Reference to the column renderer types\r\n   * @internal\r\n   */\r\n  entityTableColumnRenderer = EntityTableColumnRenderer;\r\n\r\n  /**\r\n   * Reference to the selection states\r\n   * @internal\r\n   */\r\n  entityTableSelectionState = EntityTableSelectionState;\r\n\r\n  /**\r\n   * Observable of the selection,s state\r\n   * @internal\r\n   */\r\n  selectionState$: BehaviorSubject<EntityTableSelectionState> = new BehaviorSubject(undefined);\r\n\r\n  /**\r\n   * Entity store watcher\r\n   */\r\n  private watcher: EntityStoreWatcher<object>;\r\n\r\n  /**\r\n   * Subscription to the store's selection\r\n   */\r\n  private selection$$: Subscription;\r\n\r\n  /**\r\n   * Entity store\r\n   */\r\n  @Input() store: EntityStore<object>;\r\n\r\n  /**\r\n   * Table template\r\n   */\r\n  @Input() template: EntityTableTemplate;\r\n\r\n  /**\r\n   * Scroll behavior on selection\r\n   */\r\n  @Input()\r\n  scrollBehavior: EntityTableScrollBehavior = EntityTableScrollBehavior.Auto;\r\n\r\n  /**\r\n   * Event emitted when an entity (row) is clicked\r\n   */\r\n  @Output() entityClick = new EventEmitter<object>();\r\n\r\n  /**\r\n   * Event emitted when an entity (row) is selected\r\n   */\r\n  @Output() entitySelectChange = new EventEmitter<{\r\n    added: object[];\r\n  }>();\r\n\r\n  /**\r\n   * Table headers\r\n   * @internal\r\n   */\r\n  get headers(): string[] {\r\n    let columns = this.template.columns\r\n      .filter((column: EntityTableColumn) => column.visible !== false)\r\n      .map((column: EntityTableColumn) => column.name);\r\n\r\n    if (this.selectionCheckbox === true) {\r\n      columns = ['selectionCheckbox'].concat(columns);\r\n    }\r\n\r\n    return columns;\r\n  }\r\n\r\n  /**\r\n   * Data source consumable by the underlying material table\r\n   * @internal\r\n   */\r\n  get dataSource(): BehaviorSubject<object[]> { return this.store.view.all$(); }\r\n\r\n  /**\r\n   * Whether selection is supported\r\n   * @internal\r\n   */\r\n  get selection(): boolean { return this.template.selection || false; }\r\n\r\n  /**\r\n   * Whether a selection checkbox should be displayed\r\n   * @internal\r\n   */\r\n  get selectionCheckbox(): boolean { return this.template.selectionCheckbox || false; }\r\n\r\n  /**\r\n   * Whether selection many entities should eb supported\r\n   * @internal\r\n   */\r\n  get selectMany(): boolean { return this.template.selectMany || false; }\r\n\r\n  /**\r\n   * Whether selection many entities should eb supported\r\n   * @internal\r\n   */\r\n  get fixedHeader(): boolean { return this.template.fixedHeader === undefined ? true : this.template.fixedHeader; }\r\n\r\n  constructor(private cdRef: ChangeDetectorRef) {}\r\n\r\n  /**\r\n   * Track the selection state to properly display the selection checkboxes\r\n   * @internal\r\n   */\r\n  ngOnInit() {\r\n    this.selection$$ = this.store.stateView\r\n      .manyBy$((record: EntityRecord<object>) => record.state.selected === true)\r\n      .subscribe((records: EntityRecord<object>[]) => {\r\n        this.selectionState$.next(this.computeSelectionState(records));\r\n      });\r\n  }\r\n\r\n  /**\r\n   * When the store change, create a new watcher\r\n   * @internal\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    const store = changes.store;\r\n    if (store && store.currentValue !== store.previousValue) {\r\n      if (this.watcher !== undefined) {\r\n        this.watcher.destroy();\r\n      }\r\n      this.watcher = new EntityStoreWatcher(this.store, this.cdRef);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Unbind the store watcher\r\n   * @internal\r\n   */\r\n  ngOnDestroy() {\r\n    if (this.watcher !== undefined) {\r\n      this.watcher.destroy();\r\n    }\r\n    this.selection$$.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Trigger a refresh of thre table. This can be useful when\r\n   * the data source doesn't emit a new value but for some reason\r\n   * the records need an update.\r\n   * @internal\r\n   */\r\n  refresh() {\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n  /**\r\n   * On sort, sort the store\r\n   * @param event Sort event\r\n   * @internal\r\n   */\r\n  onSort(event: {active: string, direction: string}) {\r\n    const direction = event.direction;\r\n    const column = this.template.columns\r\n      .find((c: EntityTableColumn) => c.name === event.active);\r\n\r\n    if (direction === 'asc' || direction === 'desc') {\r\n      this.store.view.sort({\r\n        valueAccessor: (entity: object) => this.getValue(entity, column),\r\n        direction\r\n      });\r\n    } else {\r\n      this.store.view.sort(undefined);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * When an entity is clicked, emit an event\r\n   * @param entity Entity\r\n   * @internal\r\n   */\r\n  onRowClick(entity: object) {\r\n    this.entityClick.emit(entity);\r\n  }\r\n\r\n  /**\r\n   * When an entity is selected, select it in the store and emit an event. Even if\r\n   * \"many\" is set to true, this method always select a single, exclusive row. Selecting\r\n   * multiple rows should be achieved by using the checkboxes.\r\n   * @param entity Entity\r\n   * @internal\r\n   */\r\n  onRowSelect(entity: object) {\r\n    if (this.selection === false) { return; }\r\n\r\n    // Selecting a\r\n    this.store.state.update(entity, {selected: true}, true);\r\n    this.entitySelectChange.emit({added: [entity]});\r\n  }\r\n\r\n  /**\r\n   * Select or unselect all rows at once. On select, emit an event.\r\n   * @param toggle Select or unselect\r\n   * @internal\r\n   */\r\n  onToggleRows(toggle: boolean) {\r\n    if (this.selection === false) { return; }\r\n\r\n    this.store.state.updateAll({selected: toggle});\r\n    if (toggle === true) {\r\n      this.entitySelectChange.emit({added: [this.store.view.all()]});\r\n    }\r\n  }\r\n\r\n  /**\r\n   * When an entity is toggled, select or unselect it in the store. On select,\r\n   * emit an event.\r\n   * @param toggle Select or unselect\r\n   * @param entity Entity\r\n   * @internal\r\n   */\r\n  onToggleRow(toggle: boolean, entity: object) {\r\n    if (this.selection === false) { return; }\r\n\r\n    const exclusive = toggle === true && !this.selectMany;\r\n    this.store.state.update(entity, {selected: toggle}, exclusive);\r\n    if (toggle === true) {\r\n      this.entitySelectChange.emit({added: [entity]});\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Compute the selection state\r\n   * @returns Whether all, some or no rows are selected\r\n   * @internal\r\n   */\r\n  private computeSelectionState(selectedRecords: EntityRecord<object>[]): EntityTableSelectionState {\r\n    const states = EntityTableSelectionState;\r\n    const selectionCount = selectedRecords.length;\r\n    return selectionCount === 0 ?\r\n      states.None :\r\n      (selectionCount === this.store.view.count ? states.All : states.Some);\r\n  }\r\n\r\n  /**\r\n   * Whether a column is sortable\r\n   * @param column Column\r\n   * @returns True if a column is sortable\r\n   * @internal\r\n   */\r\n  columnIsSortable(column: EntityTableColumn): boolean {\r\n    let sortable = column.sort;\r\n    if (sortable === undefined) {\r\n      sortable = this.template.sort === undefined ? false : this.template.sort;\r\n    }\r\n    return sortable;\r\n  }\r\n\r\n  /**\r\n   * Whether a row is should be selected based on the underlying entity state\r\n   * @param entity Entity\r\n   * @returns True if a row should be selected\r\n   * @internal\r\n   */\r\n  rowIsSelected(entity: object): boolean {\r\n    const state = this.store.state.get(entity);\r\n    return state.selected ? state.selected : false;\r\n  }\r\n\r\n  /**\r\n   * Method to access an entity's values\r\n   * @param entity Entity\r\n   * @param column Column\r\n   * @returns Any value\r\n   * @internal\r\n   */\r\n  getValue(entity: object, column: EntityTableColumn): any {\r\n    if (column.valueAccessor !== undefined) {\r\n      return column.valueAccessor(entity);\r\n    }\r\n    if (this.template.valueAccessor !== undefined) {\r\n      return this.template.valueAccessor(entity, column.name);\r\n    }\r\n    return this.store.getProperty(entity, column.name);\r\n  }\r\n\r\n  /**\r\n   * Return the type of renderer of a column\r\n   * @param column Column\r\n   * @returns Renderer type\r\n   * @internal\r\n   */\r\n  getColumnRenderer(column: EntityTableColumn): EntityTableColumnRenderer {\r\n    if (column.renderer !== undefined) {\r\n      return column.renderer;\r\n    }\r\n    return EntityTableColumnRenderer.Default;\r\n  }\r\n\r\n  /**\r\n   * Return the table ngClass\r\n   * @returns ngClass\r\n   * @internal\r\n   */\r\n  getTableClass(): {[key: string]: boolean} {\r\n    return {\r\n      'igo-entity-table-with-selection': this.selection\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Return a header ngClass\r\n   * @returns ngClass\r\n   * @internal\r\n   */\r\n  getHeaderClass(): {[key: string]: boolean} {\r\n    const func = this.template.headerClassFunc;\r\n    if (func instanceof Function) {\r\n      return func();\r\n    }\r\n    return {};\r\n  }\r\n\r\n  /**\r\n   * Return a row ngClass\r\n   * @param entity Entity\r\n   * @returns ngClass\r\n   * @internal\r\n   */\r\n  getRowClass(entity: object): {[key: string]: boolean} {\r\n    const func = this.template.rowClassFunc;\r\n    if (func instanceof Function) {\r\n      return func(entity);\r\n    }\r\n    return {};\r\n  }\r\n\r\n  /**\r\n   * Return a row ngClass\r\n   * @param entity Entity\r\n   * @param column Column\r\n   * @returns ngClass\r\n   * @internal\r\n   */\r\n  getCellClass(entity: object, column: EntityTableColumn): {[key: string]: boolean} {\r\n    const cls = {};\r\n\r\n    const tableFunc = this.template.cellClassFunc;\r\n    if (tableFunc instanceof Function) {\r\n      Object.assign(cls, tableFunc(entity, column));\r\n    }\r\n\r\n    const columnFunc = column.cellClassFunc;\r\n    if (columnFunc instanceof Function) {\r\n      Object.assign(cls, columnFunc(entity));\r\n    }\r\n\r\n    return cls;\r\n  }\r\n\r\n  /**\r\n   * When a button is clicked\r\n   * @param func Function\r\n   * @param entity Entity\r\n   * @internal\r\n   */\r\n  onButtonClick(clickFunc: (entity: object) => void, entity: object) {\r\n    if (typeof clickFunc === 'function') {\r\n      clickFunc(entity);\r\n    }\r\n  }\r\n\r\n}\r\n","export enum ActionbarMode {\r\n  Dock = 'dock',\r\n  Overlay = 'overlay',\r\n  Context = 'context'\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  HostBinding,\r\n  ChangeDetectorRef,\r\n  ChangeDetectionStrategy,\r\n  OnChanges,\r\n  OnDestroy,\r\n  SimpleChanges\r\n} from '@angular/core';\r\n\r\nimport { EntityStoreWatcher } from '../../entity';\r\nimport { Action } from '../shared/action.interfaces';\r\nimport { ActionbarMode } from '../shared/action.enums';\r\nimport { ActionStore } from '../shared/store';\r\nimport { Overlay } from '@angular/cdk/overlay';\r\n\r\n/**\r\n * A list of action buttons.\r\n * This component can be displayed in one of two way: 'dock' or 'overlay'\r\n */\r\n@Component({\r\n  selector: 'igo-actionbar',\r\n  templateUrl: './actionbar.component.html',\r\n  styleUrls: ['./actionbar.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ActionbarComponent implements OnDestroy, OnChanges {\r\n  /**\r\n   * Reference to the ActionbarMode enum for use in the template\r\n   * @internal\r\n   */\r\n  actionbarMode = ActionbarMode;\r\n\r\n  /**\r\n   * Whether the actionbar is collapsed (Dock mode)\r\n   * @internal\r\n   */\r\n  collapsed = false;\r\n\r\n  /**\r\n   * Toggle collapse action (Dock)\r\n   * @internal\r\n   */\r\n  toggleCollapseAction = {\r\n    id: 'actionbar_toggle',\r\n    icon: 'dots-vertical',\r\n    handler: () => {\r\n      this.collapsed = !this.collapsed;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Action store watcher\r\n   * @internal\r\n   */\r\n  private watcher: EntityStoreWatcher<Action>;\r\n\r\n  /**\r\n   * Action store\r\n   */\r\n  @Input() store: ActionStore;\r\n\r\n  /**\r\n   * Actionbar mode\r\n   */\r\n  @Input() mode: ActionbarMode = ActionbarMode.Dock;\r\n\r\n  /**\r\n   * Whether a toggle button should be displayed (Dock mode)\r\n   */\r\n  @Input() withToggleButton = false;\r\n\r\n  /**\r\n   * Whether a the actionbar should display buttons horizontally\r\n   */\r\n  @Input() horizontal = false;\r\n\r\n  /**\r\n   * Color\r\n   */\r\n  @Input() color = 'default';\r\n\r\n  /**\r\n   * Whether action titles are displayed\r\n   */\r\n  @Input() withTitle = true;\r\n\r\n  /**\r\n   * Whether action icons are displayed\r\n   */\r\n  @Input() withIcon = true;\r\n\r\n  /**\r\n   * Overlay X position\r\n   */\r\n  @Input() xPosition = 'before';\r\n\r\n  /**\r\n   * Overlay X position\r\n   */\r\n  @Input() yPosition = 'above';\r\n\r\n  /**\r\n   * Class to add to the actionbar overlay\r\n   */\r\n  @Input()\r\n  set overlayClass(value: string) {\r\n    this._overlayClass = value;\r\n  }\r\n  get overlayClass(): string {\r\n    return [this._overlayClass, 'igo-actionbar-overlay'].join(' ');\r\n  }\r\n  private _overlayClass = '';\r\n\r\n  /**\r\n   * Function to add class to item actionbar\r\n   */\r\n  @Input() itemClassFunc: (action: Action) => { [key: string]: boolean } =\r\n    ActionbarComponent.defaultItemClassFunc;\r\n\r\n  /**\r\n   * @ignore\r\n   */\r\n  @HostBinding('class.with-title')\r\n  get withTitleClass() {\r\n    return this.withTitle;\r\n  }\r\n\r\n  /**\r\n   * @ignore\r\n   */\r\n  @HostBinding('class.with-icon')\r\n  get withIconClass() {\r\n    return this.withIcon;\r\n  }\r\n\r\n  /**\r\n   * @ignore\r\n   */\r\n  @HostBinding('class.horizontal')\r\n  get horizontalClass() {\r\n    return this.horizontal;\r\n  }\r\n\r\n  static defaultItemClassFunc(action: Action) {\r\n    return {};\r\n  }\r\n\r\n  constructor(private cdRef: ChangeDetectorRef, public overlay: Overlay) {}\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    const store = changes.store;\r\n    if (store && store.currentValue !== store.previousValue) {\r\n      if (this.watcher !== undefined) {\r\n        this.watcher.destroy();\r\n      }\r\n      this.watcher = new EntityStoreWatcher(this.store, this.cdRef);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  ngOnDestroy() {\r\n    this.watcher.destroy();\r\n  }\r\n\r\n  /**\r\n   * Invoke the action handler\r\n   * @internal\r\n   */\r\n  onTriggerAction(action: Action) {\r\n    const args = action.args || [];\r\n    action.handler(...args);\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\n\r\nimport { Action } from '../shared/action.interfaces';\r\n\r\n /**\r\n  * An action button\r\n  */\r\n@Component({\r\n  selector: 'igo-actionbar-item',\r\n  templateUrl: './actionbar-item.component.html',\r\n  styleUrls: ['./actionbar-item.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ActionbarItemComponent {\r\n\r\n  /**\r\n   * Action\r\n   */\r\n  @Input() action: Action;\r\n\r\n  /**\r\n   * Color\r\n   */\r\n  @Input() color = 'default';\r\n\r\n  /**\r\n   * Whether the action title is displayed\r\n   */\r\n  @Input() withTitle = true;\r\n\r\n  /**\r\n   * Whether the action icon is displayed\r\n   */\r\n  @Input() withIcon = true;\r\n\r\n  /**\r\n   * Whether the action is disabled\r\n   */\r\n  @Input() disabled = false;\r\n\r\n  /**\r\n   * Event emitted when the action button is clicked\r\n   */\r\n  @Output() trigger: EventEmitter<Action> = new EventEmitter();\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  get title(): string { return this.action.title; }\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  get tooltip(): string { return this.action.tooltip || this.title; }\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  get icon(): string { return this.action.icon; }\r\n\r\n  constructor() {}\r\n\r\n  /**\r\n   * When the action button is clicked, emit the 'trigger' event but don't\r\n   * invoke the action handler. This is handled by the parent component.\r\n   * @internal\r\n   */\r\n  onClick() {\r\n    if (this.disabled === true) {\r\n      return;\r\n    }\r\n    this.trigger.emit(this.action);\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport {\r\n  MatButtonModule,\r\n  MatIconModule,\r\n  MatTooltipModule,\r\n  MatListModule,\r\n  MatMenuModule,\r\n  MatCardModule\r\n} from '@angular/material';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\n\r\nimport { ActionbarComponent } from './actionbar.component';\r\nimport { ActionbarItemComponent } from './actionbar-item.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoLanguageModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatTooltipModule,\r\n    MatMenuModule,\r\n    MatListModule,\r\n    MatCardModule\r\n  ],\r\n  exports: [ActionbarComponent],\r\n  declarations: [ActionbarComponent, ActionbarItemComponent]\r\n})\r\nexport class IgoActionbarModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoActionbarModule } from './actionbar/actionbar.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoActionbarModule\r\n  ],\r\n  exports: [\r\n    IgoActionbarModule\r\n  ],\r\n  declarations: [],\r\n  providers: []\r\n})\r\nexport class IgoActionModule {}\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'igo-backdrop',\r\n  templateUrl: './backdrop.component.html',\r\n  styleUrls: ['./backdrop.component.scss']\r\n})\r\nexport class BackdropComponent {\r\n  @Input()\r\n  get shown(): boolean {\r\n    return this._shown;\r\n  }\r\n  set shown(value: boolean) {\r\n    this._shown = value;\r\n  }\r\n  private _shown: boolean;\r\n\r\n  constructor() {}\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { BackdropComponent } from './backdrop.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  declarations: [BackdropComponent],\r\n  exports: [BackdropComponent]\r\n})\r\nexport class IgoBackdropModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoBackdropModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  ElementRef,\r\n  EventEmitter,\r\n  HostListener,\r\n  Output\r\n} from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[igoClickout]'\r\n})\r\nexport class ClickoutDirective {\r\n  @Output() clickout = new EventEmitter<MouseEvent>();\r\n\r\n  @HostListener('document:click', ['$event', '$event.target'])\r\n  handleMouseClick(event: MouseEvent, target: HTMLElement) {\r\n    if (!target) {\r\n      return;\r\n    }\r\n\r\n    if (!this.el.nativeElement.contains(target)) {\r\n      this.clickout.emit(event);\r\n    }\r\n  }\r\n\r\n  constructor(private el: ElementRef) {}\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { ClickoutDirective } from './clickout.directive';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [ClickoutDirective],\r\n  exports: [ClickoutDirective]\r\n})\r\nexport class IgoClickoutModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoClickoutModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n@Pipe({\r\n  name: 'clone'\r\n})\r\nexport class ClonePipe implements PipeTransform {\r\n  transform(value: any, args?: any): any {\r\n    if (value === undefined) {\r\n      return value;\r\n    }\r\n\r\n    if (value instanceof Array) {\r\n      return value.map(obj => Object.assign(Object.create(obj), obj));\r\n    } else {\r\n      return Object.assign(Object.create(value), value);\r\n    }\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { ClonePipe } from './clone.pipe';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [ClonePipe],\r\n  exports: [ClonePipe]\r\n})\r\nexport class IgoCloneModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoCloneModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  HostListener,\r\n  ElementRef,\r\n  Renderer2\r\n} from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[igoCollapse]'\r\n})\r\nexport class CollapseDirective {\r\n  @Input()\r\n  get target() {\r\n    return this._target;\r\n  }\r\n  set target(value: Element) {\r\n    this._target = value;\r\n  }\r\n  private _target: Element;\r\n\r\n  @Input()\r\n  get collapsed(): boolean {\r\n    return this._collapsed;\r\n  }\r\n  set collapsed(collapsed: boolean) {\r\n    collapsed ? this.collapseTarget() : this.expandTarget();\r\n    this._collapsed = collapsed;\r\n    this.toggle.emit(collapsed);\r\n  }\r\n  private _collapsed = false;\r\n\r\n  @Output() toggle: EventEmitter<boolean> = new EventEmitter();\r\n\r\n  @HostListener('click')\r\n  click() {\r\n    this.collapsed = !this.collapsed;\r\n  }\r\n\r\n  constructor(private renderer: Renderer2, private el: ElementRef) {}\r\n\r\n  private collapseTarget() {\r\n    this.renderer.addClass(this.target, 'igo-collapsed');\r\n    this.renderer.addClass(this.el.nativeElement, 'collapsed');\r\n  }\r\n\r\n  private expandTarget() {\r\n    this.renderer.removeClass(this.target, 'igo-collapsed');\r\n    this.renderer.removeClass(this.el.nativeElement, 'collapsed');\r\n  }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'igo-collapsible',\r\n  templateUrl: './collapsible.component.html',\r\n  styleUrls: ['./collapsible.component.scss']\r\n})\r\nexport class CollapsibleComponent {\r\n  @Input()\r\n  get title() {\r\n    return this._title;\r\n  }\r\n  set title(value: string) {\r\n    this._title = value;\r\n  }\r\n  private _title = '';\r\n\r\n  @Input()\r\n  get collapsed() {\r\n    return this._collapsed;\r\n  }\r\n  set collapsed(value: boolean) {\r\n    this._collapsed = value;\r\n  }\r\n  private _collapsed = false;\r\n\r\n  constructor() {}\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { MatIconModule, MatListModule } from '@angular/material';\r\n\r\nimport { CollapseDirective } from './collapse.directive';\r\nimport { CollapsibleComponent } from './collapsible.component';\r\n\r\n@NgModule({\r\n  imports: [MatIconModule, MatListModule],\r\n  declarations: [CollapsibleComponent, CollapseDirective],\r\n  exports: [CollapsibleComponent, CollapseDirective]\r\n})\r\nexport class IgoCollapsibleModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoCollapsibleModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material';\r\n\r\n@Component({\r\n  selector: 'igo-confirm-dialog',\r\n  templateUrl: './confirm-dialog.component.html',\r\n  styleUrls: ['./confirm-dialog.component.scss']\r\n})\r\nexport class ConfirmDialogComponent {\r\n  public confirmMessage: string;\r\n\r\n  constructor(public dialogRef: MatDialogRef<ConfirmDialogComponent>) {}\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MatDialog } from '@angular/material';\r\n\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { ConfirmDialogComponent } from './confirm-dialog.component';\r\n\r\n@Injectable()\r\nexport class ConfirmDialogService {\r\n  constructor(private dialog: MatDialog) {}\r\n\r\n  public open(message: string): Observable<any> {\r\n    const dialogRef = this.dialog.open(ConfirmDialogComponent, {\r\n      disableClose: false\r\n    });\r\n    dialogRef.componentInstance.confirmMessage = message;\r\n\r\n    return dialogRef.afterClosed();\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { MatButtonModule, MatDialogModule } from '@angular/material';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\n\r\nimport { ConfirmDialogComponent } from './confirm-dialog.component';\r\nimport { ConfirmDialogService } from './confirm-dialog.service';\r\n\r\n@NgModule({\r\n  imports: [MatButtonModule, MatDialogModule, IgoLanguageModule],\r\n  declarations: [ConfirmDialogComponent],\r\n  exports: [ConfirmDialogComponent],\r\n  providers: [ConfirmDialogService],\r\n  entryComponents: [ConfirmDialogComponent]\r\n})\r\nexport class IgoConfirmDialogModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoConfirmDialogModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  ElementRef,\r\n  EventEmitter,\r\n  HostListener,\r\n  Input,\r\n  Output,\r\n  TemplateRef,\r\n  ViewContainerRef\r\n} from '@angular/core';\r\n\r\nimport { TemplatePortal } from '@angular/cdk/portal';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { filter, take } from 'rxjs/operators';\r\nimport { Overlay, OverlayRef } from '@angular/cdk/overlay';\r\n\r\n@Directive({\r\n  selector: '[igoContextMenu]'\r\n})\r\nexport class ContextMenuDirective {\r\n  overlayRef: OverlayRef | null;\r\n  sub: Subscription;\r\n\r\n  @Input('igoContextMenu') menuContext: TemplateRef<any>;\r\n  @Output() menuPosition = new EventEmitter<{ x: number; y: number }>();\r\n\r\n  constructor(\r\n    public overlay: Overlay,\r\n    public viewContainerRef: ViewContainerRef,\r\n    private elementRef: ElementRef\r\n  ) {}\r\n\r\n  @HostListener('contextmenu', ['$event'])\r\n  public onContextMenu({ x, y }: MouseEvent): void {\r\n    this.close();\r\n    event.preventDefault();\r\n    this.menuPosition.emit({ x, y });\r\n    this.overlayRef = null;\r\n    const positionStrategy = this.overlay\r\n      .position()\r\n      .flexibleConnectedTo({ x, y })\r\n      .withPositions([\r\n        {\r\n          originX: 'end',\r\n          originY: 'bottom',\r\n          overlayX: 'start',\r\n          overlayY: 'top'\r\n        }\r\n      ]);\r\n    this.overlayRef = this.overlay.create({\r\n      positionStrategy,\r\n      scrollStrategy: this.overlay.scrollStrategies.close()\r\n    });\r\n    this.overlayRef.attach(\r\n      new TemplatePortal(this.menuContext, this.viewContainerRef, {\r\n        $implicit: undefined\r\n      })\r\n    );\r\n\r\n    this.sub = fromEvent<MouseEvent>(document, 'click')\r\n      .pipe(\r\n        filter(event => {\r\n          const clickTarget = event.target as HTMLElement;\r\n          this.close();\r\n          return (\r\n            !!this.overlayRef &&\r\n            !this.overlayRef.overlayElement.contains(clickTarget)\r\n          );\r\n        }),\r\n        take(1)\r\n      )\r\n      .subscribe(() => this.close());\r\n\r\n    this.sub = fromEvent<MouseEvent>(document, 'contextmenu')\r\n      .pipe(\r\n        filter(event => {\r\n          const clickTarget = event.target as HTMLElement;\r\n          if (\r\n            clickTarget &&\r\n            !this.elementRef.nativeElement.contains(clickTarget) &&\r\n            !this.overlayRef.overlayElement.contains(clickTarget)\r\n          ) {\r\n            return true;\r\n          } else {\r\n            event.preventDefault();\r\n          }\r\n        }),\r\n        take(1)\r\n      )\r\n      .subscribe(() => this.close());\r\n  }\r\n  close() {\r\n    if (this.overlayRef) {\r\n      this.overlayRef.dispose();\r\n      this.overlayRef = null;\r\n    }\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { ContextMenuDirective } from './context-menu.directive';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [ContextMenuDirective],\r\n  exports: [ContextMenuDirective]\r\n})\r\nexport class IgoContextMenuModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoContextMenuModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'igo-custom-html',\r\n  templateUrl: './custom-html.component.html',\r\n  styleUrls: ['./custom-html.component.scss']\r\n})\r\nexport class CustomHtmlComponent {\r\n  @Input()\r\n  get html(): string {\r\n    return this._html;\r\n  }\r\n  set html(value: string) {\r\n    this._html = value;\r\n  }\r\n  private _html = '';\r\n\r\n  constructor() {}\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer, SafeHtml } from '@angular/platform-browser';\r\n\r\n@Pipe({ name: 'sanitizeHtml' })\r\nexport class SanitizeHtmlPipe implements PipeTransform {\r\n  constructor(private _sanitizer: DomSanitizer) {\r\n  }\r\n  transform(v: string): SafeHtml {\r\n    return this._sanitizer.bypassSecurityTrustHtml(v);\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport {\r\n  MatIconModule,\r\n  MatTooltipModule,\r\n  MatInputModule,\r\n  MatButtonModule\r\n} from '@angular/material';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\n\r\nimport { CustomHtmlComponent } from './custom-html.component';\r\nimport { SanitizeHtmlPipe } from './custom-html.pipe';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    MatTooltipModule,\r\n    MatInputModule,\r\n    MatButtonModule,\r\n    IgoLanguageModule\r\n  ],\r\n  exports: [SanitizeHtmlPipe, CustomHtmlComponent],\r\n  declarations: [SanitizeHtmlPipe, CustomHtmlComponent]\r\n})\r\nexport class IgoCustomHtmlModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoCustomHtmlModule\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  HostListener,\r\n  HostBinding,\r\n  EventEmitter,\r\n  Output,\r\n  Input\r\n} from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[igoDragAndDrop]'\r\n})\r\nexport class DragAndDropDirective {\r\n\r\n  @Input() allowedExtensions: Array<string> = [];\r\n\r\n  @Output() protected filesDropped: EventEmitter<File[]> = new EventEmitter();\r\n\r\n  @Output() protected filesInvalid: EventEmitter<File[]> = new EventEmitter();\r\n\r\n  @HostBinding('style.background') private background = 'inherit';\r\n\r\n  @HostListener('dragover', ['$event'])\r\n  public onDragOver(evt) {\r\n    evt.preventDefault();\r\n    evt.stopPropagation();\r\n    this.background = '#999';\r\n  }\r\n\r\n  @HostListener('dragleave', ['$event'])\r\n  public onDragLeave(evt) {\r\n    evt.preventDefault();\r\n    evt.stopPropagation();\r\n    this.background = 'inherit';\r\n  }\r\n\r\n  @HostListener('drop', ['$event'])\r\n  public onDrop(evt) {\r\n    evt.preventDefault();\r\n    evt.stopPropagation();\r\n    this.background = 'inherit';\r\n    const filesObj = this.validExtensions(evt);\r\n    if (filesObj.valid.length) {\r\n      this.filesDropped.emit(filesObj.valid);\r\n    }\r\n    if (filesObj.invalid.length) {\r\n      this.filesInvalid.emit(filesObj.invalid);\r\n    }\r\n  }\r\n\r\n  private validExtensions(evt) {\r\n    const files = evt.dataTransfer.files;\r\n    const filesObj = {\r\n      valid: [],\r\n      invalid: []\r\n    };\r\n    if (files.length > 0) {\r\n      for (const file of files) {\r\n        const ext = file.name.split('.')[file.name.split('.').length - 1];\r\n        if (\r\n          this.allowedExtensions.length === 0 ||\r\n          (\r\n            this.allowedExtensions.lastIndexOf(ext) !== -1 &&\r\n            file.size !== 0\r\n          )\r\n        ) {\r\n          filesObj.valid.push(file);\r\n        } else {\r\n          filesObj.invalid.push(file);\r\n        }\r\n      }\r\n    }\r\n\r\n    return filesObj;\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { DragAndDropDirective } from './drag-drop.directive';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [DragAndDropDirective],\r\n  exports: [DragAndDropDirective]\r\n})\r\nexport class IgoDrapDropModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoDrapDropModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import {\r\n  ComponentFactory,\r\n  ComponentRef,\r\n  ViewContainerRef\r\n} from '@angular/core';\r\n\r\nimport { Subscription } from 'rxjs';\r\n\r\n/**\r\n * This class is used in the DynamicComponentOutlet component. It holds\r\n * a reference to a component factory and can render that component\r\n * in a target element on demand. It's also possible to set inputs\r\n * and to subscribe to outputs.\r\n */\r\nexport class DynamicComponent<C> {\r\n\r\n  /**\r\n   * Component reference\r\n   */\r\n  private componentRef: ComponentRef<C>;\r\n\r\n  /**\r\n   * Subscriptions to the component's outputs. Those need\r\n   * to be unsubscribed when the component is destroyed.\r\n   */\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  /**\r\n   * Component target element\r\n   */\r\n  private target: ViewContainerRef;\r\n\r\n  /**\r\n   * Component inputs\r\n   */\r\n  private inputs: {[key: string]: any} = {};\r\n\r\n  /**\r\n   * Subscribers to the component's outputs\r\n   */\r\n  private subscribers: {[key: string]: (event: any) => void} = {};\r\n\r\n  constructor(private componentFactory: ComponentFactory<C>) {}\r\n\r\n  /**\r\n   * Render the component to a target element.\r\n   * Set it's inputs and subscribe to it's outputs.\r\n   * @param target Target element\r\n   */\r\n  setTarget(target: ViewContainerRef) {\r\n    this.target = target;\r\n    this.componentRef = target.createComponent(this.componentFactory);\r\n    this.updateInputs(this.inputs);\r\n    this.updateSubscribers(this.subscribers);\r\n  }\r\n\r\n  /**\r\n   * Destroy this component. That means, removing from it's target\r\n   * element and unsubscribing to it's outputs.\r\n   */\r\n  destroy() {\r\n    if (this.target !== undefined) {\r\n      this.target.clear();\r\n    }\r\n    if (this.componentRef !== undefined) {\r\n      this.componentRef.destroy();\r\n      this.componentRef = undefined;\r\n    }\r\n    this.unsubscribeAll();\r\n  }\r\n\r\n  /**\r\n   * Update the component inputs. This is an update so any\r\n   * key not defined won't be overwritten.\r\n   */\r\n  updateInputs(inputs: {[key: string]: any}) {\r\n    this.inputs = inputs;\r\n    if (this.componentRef === undefined) {\r\n      return;\r\n    }\r\n\r\n    const instance = this.componentRef.instance;\r\n    const allowedInputs = this.componentFactory.inputs;\r\n    allowedInputs.forEach((value: {propName: string; templateName: string; }) => {\r\n      const key = value.propName;\r\n      if (inputs.hasOwnProperty(key)) {\r\n        instance[key] = inputs[key];\r\n      }\r\n    });\r\n\r\n    if (typeof (instance as any).onUpdateInputs === 'function') {\r\n      (instance as any).onUpdateInputs();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the component subscribers. This is an update so any\r\n   * key not defined won't be overwritten.\r\n   */\r\n  updateSubscribers(subscribers: {[key: string]: (event: any) => void}) {\r\n    this.subscribers = subscribers;\r\n    if (this.componentRef === undefined) {\r\n      return;\r\n    }\r\n\r\n    const instance = this.componentRef.instance;\r\n    const allowedSubscribers = this.componentFactory.outputs;\r\n    allowedSubscribers.forEach((value: {propName: string; templateName: string; }) => {\r\n      const key = value.propName;\r\n      if (subscribers.hasOwnProperty(key)) {\r\n        const emitter = instance[key];\r\n        const subscriber = subscribers[key];\r\n        if (Array.isArray(subscriber)) {\r\n          subscriber.forEach((_subscriber) => {\r\n            this.subscriptions.push(emitter.subscribe(_subscriber));\r\n          });\r\n        } else {\r\n          this.subscriptions.push(emitter.subscribe(subscriber));\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Unsubscribe to all outputs.\r\n   */\r\n  private unsubscribeAll() {\r\n    this.subscriptions.forEach((s: Subscription) => s.unsubscribe());\r\n    this.subscriptions = [];\r\n  }\r\n\r\n}\r\n","import {\r\n  ComponentFactoryResolver,\r\n  Injectable\r\n} from '@angular/core';\r\n\r\nimport { DynamicComponent } from './dynamic-component';\r\n\r\n/**\r\n * Service to creates DynamicComponent instances from base component classes\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class DynamicComponentService {\r\n\r\n  constructor(private resolver: ComponentFactoryResolver) {}\r\n\r\n  /**\r\n   * Creates a DynamicComponent instance from a base component class\r\n   * @param componentCls The component class\r\n   * @returns DynamicComponent instance\r\n   */\r\n  create(componentCls: any): DynamicComponent<any> {\r\n    const factory = this.resolver.resolveComponentFactory(componentCls as any);\r\n    return new DynamicComponent<typeof componentCls>(factory);\r\n  }\r\n}\r\n","import {\r\n  Input,\r\n  ChangeDetectorRef,\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  OnChanges,\r\n  OnDestroy,\r\n  SimpleChanges,\r\n  ViewContainerRef,\r\n  ViewChild\r\n} from '@angular/core';\r\n\r\nimport { ObjectUtils } from '@igo2/utils';\r\n\r\nimport { DynamicComponent } from '../shared/dynamic-component';\r\nimport { DynamicComponentService } from '../shared/dynamic-component.service';\r\n\r\n@Component({\r\n  selector: 'igo-dynamic-outlet',\r\n  templateUrl: 'dynamic-outlet.component.html',\r\n  styleUrls: ['dynamic-outlet.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class DynamicOutletComponent implements OnChanges, OnDestroy {\r\n  /**\r\n   * The dynamic component base class or the dynamic component itself\r\n   */\r\n  @Input() component: DynamicComponent<any> | any;\r\n\r\n  /**\r\n   * The dynamic component inputs\r\n   */\r\n  @Input() inputs: { [key: string]: any } = {};\r\n\r\n  /**\r\n   * The subscribers to the dynamic component outputs\r\n   */\r\n  @Input() subscribers: { [key: string]: (event: any) => void } = {};\r\n\r\n  /**\r\n   * The dynamic component\r\n   */\r\n  private dynamicComponent: DynamicComponent<any>;\r\n\r\n  /**\r\n   * The view element to render the component to\r\n   * @ignore\r\n   */\r\n  @ViewChild('target', { read: ViewContainerRef })\r\n  private target: ViewContainerRef;\r\n\r\n  constructor(\r\n    private dynamicComponentService: DynamicComponentService,\r\n    private cdRef: ChangeDetectorRef\r\n  ) {}\r\n\r\n  /**\r\n   * If the dynamic component changes, create it.\r\n   * If the inputs or subscribers change, update the current component's\r\n   * inputs or subscribers.\r\n   * @internal\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    const component = changes.component;\r\n    const inputs = changes.inputs;\r\n    const subscribers = changes.subscribers;\r\n    const eq = ObjectUtils.objectsAreEquivalent;\r\n\r\n    if (component && component.currentValue !== component.previousValue) {\r\n      this.createComponent(component.currentValue);\r\n    } else {\r\n      const inputsAreEquivalents =\r\n        inputs && eq(inputs.currentValue || {}, inputs.previousValue || {});\r\n      const subscribersAreEquivalents =\r\n        subscribers &&\r\n        eq(subscribers.currentValue || {}, subscribers.previousValue || {});\r\n\r\n      if (inputsAreEquivalents === false) {\r\n        this.updateInputs();\r\n      }\r\n\r\n      if (subscribersAreEquivalents === false) {\r\n        this.updateSubscribers();\r\n      }\r\n    }\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n  /**\r\n   * Destroy the dynamic component and all it's subscribers\r\n   * @internal\r\n   */\r\n  ngOnDestroy() {\r\n    if (this.dynamicComponent) {\r\n      this.dynamicComponent.destroy();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create a  DynamicComponent out of the component class and render it.\r\n   * @internal\r\n   */\r\n  private createComponent(component: DynamicComponent<any> | any) {\r\n    if (this.dynamicComponent !== undefined) {\r\n      this.dynamicComponent.destroy();\r\n    }\r\n    this.dynamicComponent =\r\n      component instanceof DynamicComponent\r\n        ? component\r\n        : this.dynamicComponentService.create(component);\r\n    this.renderComponent();\r\n  }\r\n\r\n  /**\r\n   * Create and render the dynamic component. Set it's inputs and subscribers\r\n   * @internal\r\n   */\r\n  private renderComponent() {\r\n    this.updateInputs();\r\n    this.updateSubscribers();\r\n    this.dynamicComponent.setTarget(this.target);\r\n  }\r\n\r\n  /**\r\n   * Update the dynamic component inputs. This is an update so any\r\n   * key not defined won't be overwritten.\r\n   * @internal\r\n   */\r\n  private updateInputs() {\r\n    this.dynamicComponent.updateInputs(this.inputs);\r\n  }\r\n\r\n  /**\r\n   * Update the dynamic component subscribers. This is an update so any\r\n   * key not defined won't be overwritten.\r\n   * @internal\r\n   */\r\n  private updateSubscribers() {\r\n    this.dynamicComponent.updateSubscribers(this.subscribers);\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { DynamicOutletComponent } from './dynamic-outlet.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [\r\n    DynamicOutletComponent\r\n  ],\r\n  declarations: [\r\n    DynamicOutletComponent\r\n  ]\r\n})\r\nexport class IgoDynamicOutletModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoDynamicOutletModule } from './dynamic-outlet/dynamic-outlet.module';\r\nimport { DynamicComponentService } from './shared/dynamic-component.service';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoDynamicOutletModule\r\n  ],\r\n  exports: [\r\n    IgoDynamicOutletModule\r\n  ],\r\n  providers: [\r\n    DynamicComponentService\r\n  ]\r\n})\r\nexport class IgoDynamicComponentModule {}\r\n","import { Component, OnInit, Input, ViewChild, ElementRef } from '@angular/core';\r\n\r\nimport { Media, MediaService } from '@igo2/core';\r\n\r\nimport { FlexibleState, FlexibleDirection } from './flexible.type';\r\n\r\n@Component({\r\n  selector: 'igo-flexible',\r\n  templateUrl: './flexible.component.html',\r\n  styleUrls: ['./flexible.component.scss']\r\n})\r\nexport class FlexibleComponent implements OnInit {\r\n  static transitionTime = 250;\r\n\r\n  @ViewChild('flexibleMain') main;\r\n\r\n  @Input()\r\n  get initial(): string {\r\n    return this._initial;\r\n  }\r\n  set initial(value: string) {\r\n    this._initial = value;\r\n  }\r\n  private _initial = '0';\r\n\r\n  @Input()\r\n  get collapsed(): string {\r\n    return this._collapsed;\r\n  }\r\n  set collapsed(value: string) {\r\n    this._collapsed = value;\r\n  }\r\n  private _collapsed = '0';\r\n\r\n  @Input()\r\n  get expanded(): string {\r\n    return this._expanded;\r\n  }\r\n  set expanded(value: string) {\r\n    this._expanded = value;\r\n  }\r\n  private _expanded = '100%';\r\n\r\n  @Input()\r\n  get initialMobile(): string {\r\n    return this._initialMobile;\r\n  }\r\n  set initialMobile(value: string) {\r\n    this._initialMobile = value;\r\n  }\r\n  private _initialMobile: string = this.expanded;\r\n\r\n  @Input()\r\n  get collapsedMobile(): string {\r\n    return this._collapsedMobile;\r\n  }\r\n  set collapsedMobile(value: string) {\r\n    this._collapsedMobile = value;\r\n  }\r\n  private _collapsedMobile: string = this.collapsed;\r\n\r\n  @Input()\r\n  get expandedMobile(): string {\r\n    return this._expandedMobile;\r\n  }\r\n  set expandedMobile(value: string) {\r\n    this._expandedMobile = value;\r\n  }\r\n  private _expandedMobile: string = this.expanded;\r\n\r\n  @Input()\r\n  get direction(): FlexibleDirection {\r\n    return this._direction;\r\n  }\r\n  set direction(value: FlexibleDirection) {\r\n    this._direction = value;\r\n  }\r\n  private _direction: FlexibleDirection = 'column';\r\n\r\n  @Input()\r\n  get state(): FlexibleState {\r\n    return this._state;\r\n  }\r\n  set state(value: FlexibleState) {\r\n    const sizes = {\r\n      initial: this.initial,\r\n      collapsed: this.collapsed,\r\n      expanded: this.expanded\r\n    };\r\n\r\n    const media = this.mediaService.media$.value;\r\n    if (media === 'mobile') {\r\n      Object.assign(sizes, {\r\n        initial: this.initialMobile,\r\n        collapsed: this.collapsedMobile,\r\n        expanded: this.expandedMobile\r\n      });\r\n    }\r\n\r\n    const size = sizes[value];\r\n    if (size !== undefined) {\r\n      this.setSize(size);\r\n      setTimeout(() => {\r\n        this._state = value;\r\n      }, FlexibleComponent.transitionTime);\r\n    }\r\n  }\r\n  private _state: FlexibleState = 'initial';\r\n\r\n  constructor(private el: ElementRef, private mediaService: MediaService) {}\r\n\r\n  ngOnInit() {\r\n    this.el.nativeElement.className += this.direction;\r\n\r\n    // Since this component supports different sizes\r\n    // on mobile, force a redraw when the media changes\r\n    this.mediaService.media$.subscribe(\r\n      (media: Media) => (this.state = this.state)\r\n    );\r\n  }\r\n\r\n  private setSize(size: string) {\r\n    this._state = 'transition';\r\n\r\n    if (this.direction === 'column') {\r\n      this.main.nativeElement.style.height = size;\r\n    } else if (this.direction === 'row') {\r\n      this.main.nativeElement.style.width = size;\r\n    }\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { FlexibleComponent } from './flexible.component';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [FlexibleComponent],\r\n  exports: [FlexibleComponent]\r\n})\r\nexport class IgoFlexibleModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoFlexibleModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import { AbstractControl } from '@angular/forms';\r\n\r\nimport { Form, FormField, FormFieldGroup } from './form.interfaces';\r\n\r\nexport function formControlIsRequired(control: AbstractControl): boolean {\r\n  if (control.validator) {\r\n    const validator = control.validator({} as AbstractControl);\r\n    if (validator && validator.required) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  if ((control as any).controls) {\r\n    const requiredControl = Object.keys((control as any).controls).find((key: string) => {\r\n      return formControlIsRequired((control as any).controls[key]);\r\n    });\r\n    return requiredControl !== undefined;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function getDefaultErrorMessages(): {[key: string]: string} {\r\n  return {\r\n    required: 'igo.common.form.errors.required'\r\n  };\r\n}\r\n\r\nexport function getControlErrorMessage(control: AbstractControl, messages: {[key: string]: string}): string {\r\n  const errors = control.errors || {};\r\n  const errorKeys = Object.keys(errors);\r\n  const errorMessages = errorKeys\r\n    .map((key: string) => messages[key])\r\n    .filter((message: string) => message !== undefined);\r\n  return errorMessages.length > 0 ? errorMessages[0] : '';\r\n}\r\n\r\nexport function getAllFormFields(form: Form): FormField[] {\r\n  return form.groups.reduce((acc: FormField[], group: FormFieldGroup) => {\r\n    return acc.concat(group.fields);\r\n  }, [].concat(form.fields));\r\n\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  OnChanges,\r\n  SimpleChanges,\r\n  ChangeDetectionStrategy,\r\n  ViewChild,\r\n  ElementRef\r\n} from '@angular/core';\r\n\r\nimport t from 'typy';\r\n\r\nimport { Form, FormField, FormFieldGroup } from '../shared/form.interfaces';\r\nimport { getAllFormFields } from '../shared/form.utils';\r\n\r\n/**\r\n * A configurable form\r\n */\r\n@Component({\r\n  selector: 'igo-form',\r\n  templateUrl: './form.component.html',\r\n  styleUrls: ['./form.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FormComponent implements OnChanges {\r\n\r\n  /**\r\n   * Form\r\n   */\r\n  @Input() form: Form;\r\n\r\n  /**\r\n   * Input data\r\n   */\r\n  @Input() formData: { [key: string]: any};\r\n\r\n  /**\r\n   * Event emitted when the form is submitted\r\n   */\r\n  @Output() submitForm = new EventEmitter<{[key: string]: any}>();\r\n\r\n  @ViewChild('buttons') buttons: ElementRef;\r\n\r\n  get hasButtons(): boolean {\r\n    return this.buttons.nativeElement.children.length !== 0;\r\n  }\r\n\r\n  constructor() {}\r\n\r\n  /**\r\n   * Is the entity or the template change, recreate the form or repopulate it.\r\n   * @internal\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    const formData = changes.formData;\r\n    if (formData && formData.currentValue !== formData.previousValue) {\r\n      if (formData.currentValue === undefined) {\r\n        this.clear();\r\n      } else {\r\n        this.setData(formData.currentValue);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Transform the form data to a feature and emit an event\r\n   * @param event Form submit event\r\n   * @internal\r\n   */\r\n  onSubmit() {\r\n    this.submitForm.emit(this.getData());\r\n  }\r\n\r\n  private setData(data: {[key: string]: any}) {\r\n    this.form.fields.forEach((field: FormField) => {\r\n      field.control.setValue(t(data, field.name).safeObject);\r\n    });\r\n\r\n    this.form.groups.forEach((group: FormFieldGroup) => {\r\n      group.fields.forEach((field: FormField) => {\r\n        field.control.setValue(t(data, field.name).safeObject);\r\n      });\r\n    });\r\n  }\r\n\r\n  private getData(): { [key: string]: any} {\r\n    const data = {};\r\n    getAllFormFields(this.form).forEach((field: FormField) => {\r\n      this.updateDataWithFormField(data, field);\r\n    });\r\n    return data;\r\n  }\r\n\r\n  private updateDataWithFormField(data: { [key: string]: any}, field: FormField) {\r\n    const control = field.control;\r\n    if (!control.disabled) {\r\n      data[field.name] = control.value;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear form\r\n   */\r\n  private clear() {\r\n    this.form.control.reset();\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\nimport { FormComponent } from './form.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule\r\n  ],\r\n  exports: [\r\n    FormComponent,\r\n    FormsModule,\r\n    ReactiveFormsModule\r\n  ],\r\n  declarations: [\r\n    FormComponent\r\n  ]\r\n})\r\nexport class IgoFormFormModule {}\r\n","import { Injectable } from '@angular/core';\r\n\r\n/**\r\n * Service where all available form fields are registered.\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class FormFieldService {\r\n\r\n  static fields: {[key: string]: any} = {};\r\n\r\n  static register(type: string, component: any) {\r\n    FormFieldService.fields[type] = component;\r\n  }\r\n\r\n  constructor() {}\r\n\r\n  /**\r\n   * Return field component by type\r\n   * @param type Field type\r\n   * @returns Field component\r\n   */\r\n  getFieldByType(type: string): any {\r\n    return FormFieldService.fields[type];\r\n  }\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FormBuilder } from '@angular/forms';\r\n\r\nimport {\r\n  Form,\r\n  FormField,\r\n  FormFieldConfig,\r\n  FormFieldGroup,\r\n  FormFieldGroupConfig\r\n} from './form.interfaces';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class FormService {\r\n\r\n  constructor(private formBuilder: FormBuilder) {}\r\n\r\n  form(fields: FormField[], groups: FormFieldGroup[]): Form {\r\n    const control = this.formBuilder.group({});\r\n    fields.forEach((field: FormField) => {\r\n      control.addControl(field.name, field.control);\r\n    });\r\n    groups.forEach((group: FormFieldGroup) => {\r\n      control.addControl(group.name, group.control);\r\n    });\r\n\r\n    return {fields, groups, control};\r\n  }\r\n\r\n  group(config: FormFieldGroupConfig, fields: FormField[]): FormFieldGroup {\r\n    const options = config.options || {};\r\n    const control = this.formBuilder.group({});\r\n    fields.forEach((field: FormField) => {\r\n      control.addControl(field.name, field.control);\r\n    });\r\n    control.setValidators(options.validator);\r\n\r\n    return Object.assign({}, config, {fields, control}) as FormFieldGroup;\r\n  }\r\n\r\n  field(config: FormFieldConfig): FormField {\r\n    const options = config.options || {};\r\n    const state = Object.assign({value: ''}, {\r\n      disabled: options.disabled\r\n    });\r\n    const control = this.formBuilder.control(state);\r\n    control.setValidators(options.validator);\r\n\r\n    return Object.assign({type: 'text'}, config, {control}) as FormField;\r\n  }\r\n\r\n  extendFieldConfig(config: FormFieldConfig, partial: Partial<FormFieldConfig>): FormFieldConfig {\r\n    const options = Object.assign({}, config.options || {}, partial.options || {});\r\n    const inputs = Object.assign({}, config.inputs || {}, partial.inputs || {});\r\n    const subscribers = Object.assign({}, config.subscribers || {}, partial.subscribers || {});\r\n    return Object.assign({}, config, {options, inputs, subscribers});\r\n  }\r\n\r\n}\r\n","import { FormFieldService } from './form-field.service';\r\n\r\nexport function FormFieldComponent(type: string): (cls: any) => any {\r\n  return (compType: any) => {\r\n    FormFieldService.register(type, compType);\r\n  };\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\n\r\nimport { FormField, FormFieldInputs, FormFieldOptions } from '../shared/form.interfaces';\r\nimport { FormFieldService } from '../shared/form-field.service';\r\nimport { getDefaultErrorMessages } from '../shared';\r\n\r\n/**\r\n * This component renders the proper form input based on\r\n * the field configuration it receives.\r\n */\r\n@Component({\r\n  selector: 'igo-form-field',\r\n  templateUrl: './form-field.component.html',\r\n  styleUrls: ['./form-field.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FormFieldComponent {\r\n\r\n  /**\r\n   * Field configuration\r\n   */\r\n  @Input() field: FormField;\r\n\r\n  get fieldOptions(): FormFieldOptions {\r\n    return this.field.options || {};\r\n  }\r\n\r\n  constructor(private formFieldService: FormFieldService) {}\r\n\r\n  getFieldComponent(): any {\r\n    return this.formFieldService.getFieldByType(this.field.type || 'text');\r\n  }\r\n\r\n  getFieldInputs(): FormFieldInputs {\r\n    const errors = this.fieldOptions.errors || {};\r\n    return Object.assign(\r\n      {\r\n        placeholder: this.field.title,\r\n        disableSwitch: this.fieldOptions.disableSwitch || false\r\n      },\r\n      Object.assign({}, this.field.inputs || {}),\r\n      {\r\n        formControl: this.field.control,\r\n        errors: Object.assign({}, getDefaultErrorMessages(), errors)\r\n      }\r\n    );\r\n  }\r\n\r\n  getFieldSubscribers(): {[key: string]: ({field: FormField, control: FormControl}) => void } {\r\n    return Object.assign({}, this.field.subscribers || {});\r\n  }\r\n}\r\n","import {\r\n  Input,\r\n  Component,\r\n  ChangeDetectionStrategy,\r\n  OnInit\r\n} from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\n\r\nimport { BehaviorSubject, Observable, of } from 'rxjs';\r\n\r\nimport { formControlIsRequired, getControlErrorMessage } from '../shared/form.utils';\r\nimport { FormFieldSelectChoice } from '../shared/form.interfaces';\r\nimport { FormFieldComponent } from '../shared/form-field-component';\r\n\r\n/**\r\n * This component renders a select field\r\n */\r\n@FormFieldComponent('select')\r\n@Component({\r\n  selector: 'igo-form-field-select',\r\n  templateUrl: './form-field-select.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FormFieldSelectComponent implements OnInit {\r\n\r\n  choices$: Observable<FormFieldSelectChoice[]>;\r\n\r\n  disabled$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n\r\n  /**\r\n   * The field's form control\r\n   */\r\n  @Input() formControl: FormControl;\r\n\r\n  /**\r\n   * Field placeholder\r\n   */\r\n  @Input() placeholder: string;\r\n\r\n  /**\r\n   * Select input choices\r\n   */\r\n  @Input()\r\n  set choices(value: Observable<FormFieldSelectChoice[]> | FormFieldSelectChoice[]) {\r\n    if (value instanceof Observable) {\r\n      this.choices$ = value;\r\n    } else {\r\n      this.choices$ = of(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Field placeholder\r\n   */\r\n  @Input() errors: {[key: string]: string};\r\n\r\n  /**\r\n   * Wheter a disable switch should be available\r\n   */\r\n  @Input() disableSwitch: boolean = false;\r\n\r\n  /**\r\n   * Whether the field is required\r\n   */\r\n  get required(): boolean {\r\n    return formControlIsRequired(this.formControl);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.disabled$.next(this.formControl.disabled);\r\n  }\r\n\r\n  /**\r\n   * Get error message\r\n   */\r\n  getErrorMessage(): string {\r\n    return getControlErrorMessage(this.formControl, this.errors);\r\n  }\r\n\r\n  onDisableSwitchClick() {\r\n    this.toggleDisabled();\r\n  }\r\n\r\n  private toggleDisabled() {\r\n    const disabled = !this.disabled$.value;\r\n    if (disabled === true) {\r\n      this.formControl.disable();\r\n    } else {\r\n      this.formControl.enable();\r\n    }\r\n    this.disabled$.next(disabled);\r\n  }\r\n\r\n}\r\n","import {\r\n  Input,\r\n  Component,\r\n  ChangeDetectionStrategy,\r\n  OnInit\r\n} from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\n\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport {\r\n  formControlIsRequired,\r\n  getControlErrorMessage\r\n} from '../shared/form.utils';\r\nimport { FormFieldComponent } from '../shared/form-field-component';\r\n\r\n/**\r\n * This component renders a text field\r\n */\r\n@FormFieldComponent('text')\r\n@Component({\r\n  selector: 'igo-form-field-text',\r\n  templateUrl: './form-field-text.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FormFieldTextComponent implements OnInit {\r\n\r\n  disabled$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n\r\n  /**\r\n   * The field's form control\r\n   */\r\n  @Input() formControl: FormControl;\r\n\r\n  /**\r\n   * Field placeholder\r\n   */\r\n  @Input() placeholder: string;\r\n\r\n  /**\r\n   * Field placeholder\r\n   */\r\n  @Input() errors: {[key: string]: string};\r\n\r\n  /**\r\n   * Wheter a disable switch should be available\r\n   */\r\n  @Input() disableSwitch: boolean = false;\r\n\r\n  /**\r\n   * Whether the field is required\r\n   */\r\n  get required(): boolean {\r\n    return formControlIsRequired(this.formControl);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.disabled$.next(this.formControl.disabled);\r\n  }\r\n\r\n  /**\r\n   * Get error message\r\n   */\r\n  getErrorMessage(): string {\r\n    return getControlErrorMessage(this.formControl, this.errors);\r\n  }\r\n\r\n  onDisableSwitchClick() {\r\n    this.toggleDisabled();\r\n  }\r\n\r\n  private toggleDisabled() {\r\n    const disabled = !this.disabled$.value;\r\n    if (disabled === true) {\r\n      this.formControl.disable();\r\n    } else {\r\n      this.formControl.enable();\r\n    }\r\n    this.disabled$.next(disabled);\r\n  }\r\n\r\n}\r\n","import {\r\n  Input,\r\n  Component,\r\n  ChangeDetectionStrategy,\r\n  OnInit\r\n} from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\n\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport { formControlIsRequired, getControlErrorMessage } from '../shared/form.utils';\r\nimport { FormFieldComponent } from '../shared/form-field-component';\r\n\r\n/**\r\n * This component renders a textarea field\r\n */\r\n@FormFieldComponent('textarea')\r\n@Component({\r\n  selector: 'igo-form-field-textarea',\r\n  templateUrl: './form-field-textarea.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FormFieldTextareaComponent implements OnInit {\r\n\r\n  disabled$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n\r\n  /**\r\n   * The field's form control\r\n   */\r\n  @Input() formControl: FormControl;\r\n\r\n  /**\r\n   * Field placeholder\r\n   */\r\n  @Input() placeholder: string;\r\n\r\n  /**\r\n   * Field placeholder\r\n   */\r\n  @Input() errors: {[key: string]: string};\r\n\r\n  /**\r\n   * Wheter a disable switch should be available\r\n   */\r\n  @Input() disableSwitch: boolean = false;\r\n\r\n  /**\r\n   * Whether the field is required\r\n   */\r\n  get required(): boolean {\r\n    return formControlIsRequired(this.formControl);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.disabled$.next(this.formControl.disabled);\r\n  }\r\n\r\n  /**\r\n   * Get error message\r\n   */\r\n  getErrorMessage(): string {\r\n    return getControlErrorMessage(this.formControl, this.errors);\r\n  }\r\n\r\n  onDisableSwitchClick() {\r\n    this.toggleDisabled();\r\n  }\r\n\r\n  private toggleDisabled() {\r\n    const disabled = !this.disabled$.value;\r\n    if (disabled === true) {\r\n      this.formControl.disable();\r\n    } else {\r\n      this.formControl.enable();\r\n    }\r\n    this.disabled$.next(disabled);\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport {\r\n  MatIconModule,\r\n  MatFormFieldModule,\r\n  MatInputModule,\r\n  MatSelectModule\r\n} from '@angular/material';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { IgoDynamicOutletModule } from '../../dynamic-component/dynamic-outlet/dynamic-outlet.module';\r\n\r\nimport { FormFieldComponent } from './form-field.component';\r\nimport { FormFieldSelectComponent } from './form-field-select.component';\r\nimport { FormFieldTextComponent } from './form-field-text.component';\r\nimport { FormFieldTextareaComponent } from './form-field-textarea.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    MatIconModule,\r\n    MatFormFieldModule,\r\n    MatInputModule,\r\n    MatSelectModule,\r\n    IgoLanguageModule,\r\n    IgoDynamicOutletModule\r\n  ],\r\n  exports: [\r\n    FormFieldComponent,\r\n    FormFieldSelectComponent,\r\n    FormFieldTextComponent,\r\n    FormFieldTextareaComponent\r\n  ],\r\n  declarations: [\r\n    FormFieldComponent,\r\n    FormFieldSelectComponent,\r\n    FormFieldTextComponent,\r\n    FormFieldTextareaComponent\r\n  ]\r\n})\r\nexport class IgoFormFieldModule {}\r\n","import {\r\n  Component,\r\n  Input,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\n\r\nimport { getControlErrorMessage } from '../shared/form.utils';\r\nimport { FormField, FormFieldGroup } from '../shared/form.interfaces';\r\n\r\n/**\r\n * A configurable form, optionnally bound to an entity\r\n * (for example in case of un update). Submitting that form\r\n * emits an event with the form data but no other operation is performed.\r\n */\r\n@Component({\r\n  selector: 'igo-form-group',\r\n  templateUrl: './form-group.component.html',\r\n  styleUrls: ['./form-group.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FormGroupComponent {\r\n\r\n  /**\r\n   * Form field group\r\n   */\r\n  @Input() group: FormFieldGroup;\r\n\r\n  /**\r\n   * Field placeholder\r\n   */\r\n  @Input() errors: {[key: string]: string};\r\n\r\n  /**\r\n   * Form group control\r\n   */\r\n  get formControl(): FormGroup { return this.group.control; }\r\n\r\n  constructor() {}\r\n\r\n  /**\r\n   * Return the number of columns a field should occupy.\r\n   * The maximum allowed is 2, even if the field config says more.\r\n   * @param field Field\r\n   * @returns Number of columns\r\n   * @internal\r\n   */\r\n  getFieldColSpan(field: FormField): number {\r\n    let colSpan = 2;\r\n    const options = field.options || {};\r\n    if (options.cols && options.cols > 0) {\r\n      colSpan = Math.min(options.cols, 2);\r\n    }\r\n\r\n    return colSpan;\r\n  }\r\n\r\n  /**\r\n   * Return the number of columns a field should occupy.\r\n   * The maximum allowed is 2, even if the field config says more.\r\n   * @param field Field\r\n   * @returns Number of columns\r\n   * @internal\r\n   */\r\n  getFieldNgClass(field: FormField): {[key: string]: boolean} {\r\n    const colspan = this.getFieldColSpan(field);\r\n    return {[`igo-form-field-colspan-${colspan}`]: true};\r\n  }\r\n\r\n  /**\r\n   * Get error message\r\n   */\r\n  getErrorMessage(): string {\r\n    const options = this.group.options || {};\r\n    return getControlErrorMessage(this.formControl, options.errors || {});\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatFormFieldModule } from '@angular/material';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\n\r\nimport { IgoFormFieldModule } from '../form-field/form-field.module';\r\nimport { FormGroupComponent } from './form-group.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatFormFieldModule,\r\n    IgoLanguageModule,\r\n    IgoFormFieldModule\r\n  ],\r\n  exports: [\r\n    FormGroupComponent\r\n  ],\r\n  declarations: [\r\n    FormGroupComponent\r\n  ]\r\n})\r\nexport class IgoFormGroupModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoFormFormModule } from './form/form.module';\r\nimport { IgoFormGroupModule } from './form-group/form-group.module';\r\nimport { IgoFormFieldModule } from './form-field/form-field.module';\r\nimport { FormFieldSelectComponent } from './form-field/form-field-select.component';\r\nimport { FormFieldTextComponent } from './form-field/form-field-text.component';\r\nimport { FormFieldTextareaComponent } from './form-field/form-field-textarea.component';\r\nimport { FormService } from './shared/form.service';\r\nimport { FormFieldService } from './shared/form-field.service';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoFormGroupModule,\r\n    IgoFormFieldModule\r\n  ],\r\n  exports: [\r\n    IgoFormFormModule,\r\n    IgoFormGroupModule,\r\n    IgoFormFieldModule\r\n  ],\r\n  declarations: [],\r\n  providers: [\r\n    FormService,\r\n    FormFieldService\r\n  ],\r\n  entryComponents: [\r\n    FormFieldSelectComponent,\r\n    FormFieldTextComponent,\r\n    FormFieldTextareaComponent\r\n  ]\r\n})\r\nexport class IgoFormModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { MatSelectModule } from '@angular/material';\r\n\r\nimport { EntitySelectorComponent } from './entity-selector.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    MatSelectModule\r\n  ],\r\n  exports: [EntitySelectorComponent],\r\n  declarations: [EntitySelectorComponent]\r\n})\r\nexport class IgoEntitySelectorModule {}\r\n","import { Directive, HostListener } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[igoStopDropPropagation]'\r\n})\r\nexport class StopDropPropagationDirective {\r\n  @HostListener('drop', ['$event'])\r\n  public onDrop(event: any): void {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n  }\r\n}\r\n","import { Directive, HostListener } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[igoStopPropagation]'\r\n})\r\nexport class StopPropagationDirective {\r\n  @HostListener('click', ['$event'])\r\n  public onClick(event: any): void {\r\n    event.stopPropagation();\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { StopDropPropagationDirective } from './stop-drop-propagation.directive';\r\nimport { StopPropagationDirective } from './stop-propagation.directive';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [StopDropPropagationDirective, StopPropagationDirective],\r\n  exports: [StopDropPropagationDirective, StopPropagationDirective]\r\n})\r\nexport class IgoStopPropagationModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoStopPropagationModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  Input,\r\n  ElementRef,\r\n  Renderer2,\r\n  EventEmitter,\r\n  Output,\r\n  HostListener\r\n} from '@angular/core';\r\n\r\nimport { EntityTableScrollBehavior } from '../shared/entity.enums';\r\n\r\n/**\r\n * Directive that handles an entity table row click and selection.\r\n */\r\n@Directive({\r\n  selector: '[igoEntityTableRow]'\r\n})\r\nexport class EntityTableRowDirective {\r\n\r\n  /**\r\n   * Class added to a selected row\r\n   */\r\n  static selectedCls = 'igo-entity-table-row-selected';\r\n\r\n  /**\r\n   * Class added to a highlighted row\r\n   */\r\n  static highlightedCls = 'igo-entity-table-row-highlighted';\r\n\r\n  /**\r\n   * Whether a row supports selection\r\n   */\r\n  @Input() selection = false;\r\n\r\n  /**\r\n   * Whether clicking a row should select it (if selection is true)\r\n   */\r\n  @Input() selectOnClick: boolean = true;\r\n\r\n  /**\r\n   * Whether the selected row should be highlighted\r\n   */\r\n  @Input()\r\n  highlightSelection: boolean = true;\r\n\r\n  /**\r\n   * Whether a row is selected\r\n   */\r\n  @Input()\r\n  set selected(value: boolean) {\r\n    if (this.selection === false) { return; }\r\n    if (value === this._selected) { return; }\r\n\r\n    this.toggleSelected(value);\r\n    this.scroll();\r\n  }\r\n  get selected(): boolean {\r\n    return this._selected;\r\n  }\r\n  private _selected = false;\r\n\r\n  /**\r\n   * Scroll behavior on selection\r\n   */\r\n  @Input()\r\n  scrollBehavior: EntityTableScrollBehavior = EntityTableScrollBehavior.Auto;\r\n\r\n  /**\r\n   * Event emitted when a row is selected\r\n   */\r\n  @Output() select = new EventEmitter<EntityTableRowDirective>();\r\n\r\n  /**\r\n   * When a row is clicked, select it if it's supported\r\n   * @ignore\r\n   */\r\n  @HostListener('click')\r\n  onClick() {\r\n    if (this.selection === false || this.selectOnClick === false) {\r\n      return;\r\n    }\r\n\r\n    this.toggleSelected(true);\r\n    this.select.emit(this);\r\n  }\r\n\r\n  constructor(private renderer: Renderer2, private el: ElementRef) {}\r\n\r\n  /**\r\n   * Select a row and add or remove the selected class from it\r\n   * @param selected Whether the row should be selected\r\n   */\r\n  private toggleSelected(selected: boolean) {\r\n    this._selected = selected;\r\n    if (selected === true) {\r\n      this.addCls(EntityTableRowDirective.selectedCls);\r\n      if (this.highlightSelection === true) {\r\n        this.addCls(EntityTableRowDirective.highlightedCls);\r\n      }\r\n    } else {\r\n      this.removeCls(EntityTableRowDirective.selectedCls);\r\n      this.removeCls(EntityTableRowDirective.highlightedCls);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Scroll to the selected row\r\n   */\r\n  private scroll() {\r\n    if (this._selected === true) {\r\n      this.el.nativeElement.scrollIntoView({\r\n        behavior: this.scrollBehavior,\r\n        block: 'center',\r\n        inline: 'center'\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add the selected CSS class\r\n   */\r\n  private addCls(cls: string) {\r\n    this.renderer.addClass(this.el.nativeElement, cls);\r\n  }\r\n\r\n  /**\r\n   * Remove the selected CSS class\r\n   */\r\n  private removeCls(cls: string) {\r\n    this.renderer.removeClass(this.el.nativeElement, cls);\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport {\r\n  MatTableModule,\r\n  MatSortModule,\r\n  MatIconModule,\r\n  MatButtonModule,\r\n  MatCheckboxModule\r\n} from '@angular/material';\r\n\r\nimport { IgoStopPropagationModule } from '../../stop-propagation/stop-propagation.module';\r\nimport { IgoCustomHtmlModule } from '../../custom-html/custom-html.module';\r\nimport { EntityTableRowDirective } from './entity-table-row.directive';\r\nimport { EntityTableComponent } from './entity-table.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatTableModule,\r\n    MatSortModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    MatCheckboxModule,\r\n    IgoStopPropagationModule,\r\n    IgoCustomHtmlModule\r\n  ],\r\n  exports: [\r\n    EntityTableComponent\r\n  ],\r\n  declarations: [\r\n    EntityTableComponent,\r\n    EntityTableRowDirective\r\n  ]\r\n})\r\nexport class IgoEntityTableModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoEntitySelectorModule } from './entity-selector/entity-selector.module';\r\nimport { IgoEntityTableModule } from './entity-table/entity-table.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [\r\n    IgoEntitySelectorModule,\r\n    IgoEntityTableModule\r\n  ],\r\n  declarations: []\r\n})\r\nexport class IgoEntityModule {}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\nimport { Observable } from 'rxjs';\r\nimport { switchMap } from 'rxjs/operators';\r\n\r\n@Pipe({\r\n  name: 'secureImage'\r\n})\r\nexport class SecureImagePipe implements PipeTransform {\r\n  constructor(private http: HttpClient) {}\r\n\r\n  transform(url: string) {\r\n    return this.http\r\n      .get(url, {\r\n        headers: {\r\n          activityInterceptor: 'false'\r\n        },\r\n        responseType: 'blob'\r\n      })\r\n      .pipe(\r\n        switchMap(blob => {\r\n          return new Observable(observer => {\r\n            const reader = new FileReader();\r\n            reader.readAsDataURL(blob);\r\n            reader.onloadend = () => {\r\n              observer.next(reader.result);\r\n            };\r\n          });\r\n        })\r\n      );\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { SecureImagePipe } from './secure-image.pipe';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [SecureImagePipe],\r\n  exports: [SecureImagePipe]\r\n})\r\nexport class IgoImageModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoImageModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n@Pipe({\r\n  name: 'keyvalue'\r\n})\r\nexport class KeyValuePipe implements PipeTransform {\r\n  transform(value: any, args?: any): any {\r\n    const keyValues = [];\r\n    Object.getOwnPropertyNames(value).forEach((key: string) =>\r\n      keyValues.push({ key, value: value[key] })\r\n    );\r\n\r\n    return keyValues;\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { KeyValuePipe } from './keyvalue.pipe';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [KeyValuePipe],\r\n  exports: [KeyValuePipe]\r\n})\r\nexport class IgoKeyValueModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoKeyValueModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material';\r\n\r\n@Component({\r\n  selector: 'igo-json-dialog',\r\n  templateUrl: './json-dialog.component.html'\r\n})\r\nexport class JsonDialogComponent {\r\n  public title: string;\r\n  public data: any;\r\n  public ignoreKeys: string[];\r\n\r\n  constructor(public dialogRef: MatDialogRef<JsonDialogComponent>) {}\r\n\r\n  isObject(val) {\r\n    return typeof val === 'object' && !Array.isArray(val);\r\n  }\r\n\r\n  getKey(baseKey, key) {\r\n    return (baseKey ? baseKey + '.' : '') + key;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MatDialog } from '@angular/material';\r\n\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { JsonDialogComponent } from './json-dialog.component';\r\n\r\n@Injectable()\r\nexport class JsonDialogService {\r\n  constructor(private dialog: MatDialog) {}\r\n\r\n  public open(title: any, data, ignoreKeys?: string[]): Observable<any> {\r\n    const dialogRef = this.dialog.open(JsonDialogComponent, {\r\n      disableClose: false\r\n    });\r\n    dialogRef.componentInstance.data = data;\r\n    dialogRef.componentInstance.title = title;\r\n    dialogRef.componentInstance.ignoreKeys = ignoreKeys;\r\n\r\n    return dialogRef.afterClosed();\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatButtonModule, MatDialogModule } from '@angular/material';\r\n\r\nimport { IgoKeyValueModule } from '../keyvalue/keyvalue.module';\r\n\r\nimport { JsonDialogComponent } from './json-dialog.component';\r\nimport { JsonDialogService } from './json-dialog.service';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, MatButtonModule, MatDialogModule, IgoKeyValueModule],\r\n  exports: [JsonDialogComponent],\r\n  declarations: [JsonDialogComponent],\r\n  entryComponents: [JsonDialogComponent],\r\n  providers: [JsonDialogService]\r\n})\r\nexport class IgoJsonDialogModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoJsonDialogModule\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  Input,\r\n  Output,\r\n  ElementRef,\r\n  Renderer2,\r\n  HostListener,\r\n  EventEmitter\r\n} from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[igoListItem]'\r\n})\r\nexport class ListItemDirective {\r\n\r\n  static selectedCls = 'igo-list-item-selected';\r\n  static disabledCls = 'igo-list-item-disabled';\r\n\r\n  @Input()\r\n  get color() {\r\n    return this._color;\r\n  }\r\n  set color(value: string) {\r\n    this._color = value;\r\n  }\r\n  private _color = 'primary';\r\n\r\n  @Input()\r\n  get focused() {\r\n    return this._focused;\r\n  }\r\n  set focused(value: boolean) {\r\n    if (value === this._focused) {\r\n      return;\r\n    }\r\n    if (this.disabled) {\r\n      return;\r\n    }\r\n\r\n    value ? this.beforeFocus.emit(this) : this.beforeUnfocus.emit(this);\r\n\r\n    this._focused = value;\r\n    this.toggleSelectedClass();\r\n\r\n    value ? this.focus.emit(this) : this.unfocus.emit(this);\r\n  }\r\n  private _focused = false;\r\n\r\n  @Input()\r\n  get selected() {\r\n    return this._selected;\r\n  }\r\n  set selected(value: boolean) {\r\n    if (value === this._selected) {\r\n      return;\r\n    }\r\n    if (this.disabled) {\r\n      return;\r\n    }\r\n\r\n    value ? this.beforeSelect.emit(this) : this.beforeUnselect.emit(this);\r\n\r\n    this._selected = value;\r\n    this._focused = value;\r\n    this.toggleSelectedClass();\r\n\r\n    value ? this.select.emit(this) : this.unselect.emit(this);\r\n  }\r\n  private _selected = false;\r\n\r\n  @Input()\r\n  get disabled() {\r\n    return this._disabled;\r\n  }\r\n  set disabled(value: boolean) {\r\n    if (value === this._disabled) {\r\n      return;\r\n    }\r\n\r\n    if (value === true) {\r\n      this.selected = false;\r\n    }\r\n\r\n    value ? this.beforeDisable.emit(this) : this.beforeEnable.emit(this);\r\n\r\n    this._disabled = value;\r\n    this.toggleDisabledClass();\r\n\r\n    value ? this.disable.emit(this) : this.enable.emit(this);\r\n  }\r\n  private _disabled = false;\r\n\r\n  @Output() beforeSelect = new EventEmitter<ListItemDirective>();\r\n  @Output() beforeFocus = new EventEmitter<ListItemDirective>();\r\n  @Output() beforeUnselect = new EventEmitter<ListItemDirective>();\r\n  @Output() beforeUnfocus = new EventEmitter<ListItemDirective>();\r\n  @Output() beforeDisable = new EventEmitter<ListItemDirective>();\r\n  @Output() beforeEnable = new EventEmitter<ListItemDirective>();\r\n  @Output() focus = new EventEmitter<ListItemDirective>();\r\n  @Output() unfocus = new EventEmitter<ListItemDirective>();\r\n  @Output() select = new EventEmitter<ListItemDirective>();\r\n  @Output() unselect = new EventEmitter<ListItemDirective>();\r\n  @Output() disable = new EventEmitter<ListItemDirective>();\r\n  @Output() enable = new EventEmitter<ListItemDirective>();\r\n\r\n  @HostListener('click')\r\n  onClick() {\r\n    this.selected = true;\r\n  }\r\n\r\n  constructor(public renderer: Renderer2, private el: ElementRef) {}\r\n\r\n  getOffsetTop(): number {\r\n    const padding = 5;\r\n\r\n    return this.el.nativeElement.offsetTop - padding;\r\n  }\r\n\r\n  private toggleSelectedClass() {\r\n    if (this.focused || this.selected) {\r\n      this.addCls(ListItemDirective.selectedCls);\r\n    } else {\r\n      this.removeCls(ListItemDirective.selectedCls);\r\n    }\r\n  }\r\n\r\n  private toggleDisabledClass() {\r\n    if (this.disabled) {\r\n      this.addCls(ListItemDirective.disabledCls);\r\n    } else {\r\n      this.removeCls(ListItemDirective.disabledCls);\r\n    }\r\n  }\r\n\r\n  private addCls(cls: string) {\r\n    this.renderer.addClass(this.el.nativeElement, cls);\r\n  }\r\n\r\n  private removeCls(cls: string) {\r\n    this.renderer.removeClass(this.el.nativeElement, cls);\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  AfterViewInit,\r\n  OnInit,\r\n  OnDestroy,\r\n  QueryList,\r\n  Input,\r\n  ContentChildren,\r\n  HostListener,\r\n  ElementRef\r\n} from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { ListItemDirective } from './list-item.directive';\r\n\r\n@Component({\r\n  selector: 'igo-list',\r\n  templateUrl: './list.component.html',\r\n  styleUrls: ['./list.component.scss']\r\n})\r\nexport class ListComponent implements AfterViewInit, OnInit, OnDestroy {\r\n  @Input()\r\n  get navigation() {\r\n    return this._navigation;\r\n  }\r\n  set navigation(value: boolean) {\r\n    this._navigation = value;\r\n  }\r\n  private _navigation = true;\r\n\r\n  @Input()\r\n  get selection() {\r\n    return this._selection;\r\n  }\r\n  set selection(value: boolean) {\r\n    this._selection = value;\r\n  }\r\n  private _selection = true;\r\n\r\n  get selectedItem() {\r\n    return this._selectedItem;\r\n  }\r\n  set selectedItem(value: ListItemDirective) {\r\n    this.focusedItem = value;\r\n    this._selectedItem = value;\r\n  }\r\n  private _selectedItem: ListItemDirective;\r\n\r\n  get focusedItem() {\r\n    return this._focusedItem;\r\n  }\r\n  set focusedItem(value: ListItemDirective) {\r\n    this._focusedItem = value;\r\n  }\r\n  private _focusedItem: ListItemDirective;\r\n\r\n  private navigationEnabled: boolean;\r\n  private listItems$$: Subscription;\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  @ContentChildren(ListItemDirective, { descendants: true })\r\n  listItems: QueryList<ListItemDirective>;\r\n\r\n  @HostListener('document:keydown', ['$event'])\r\n  handleKeyboardEvent(event: KeyboardEvent) {\r\n    // It would be nice to be able to unsubscribe to the event\r\n    // completely but until ES7 this won't be possible because\r\n    // document events are not observables\r\n    if (this.navigationEnabled) {\r\n      if (event.keyCode === 38 || event.keyCode === 40) {\r\n        event.preventDefault();\r\n        this.navigate(event.keyCode);\r\n      } else if (event.keyCode === 13) {\r\n        this.select(this.focusedItem);\r\n      }\r\n    }\r\n  }\r\n\r\n  constructor(private el: ElementRef) {}\r\n\r\n  ngOnInit() {\r\n    this.enableNavigation();\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    if (this.listItems.length) {\r\n      this.init();\r\n    }\r\n\r\n    this.listItems$$ = this.listItems.changes.subscribe(\r\n      (items: ListItemDirective[]) => this.init()\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.listItems$$.unsubscribe();\r\n  }\r\n\r\n  focus(item?: ListItemDirective) {\r\n    if (!this.selection) {\r\n      return;\r\n    }\r\n\r\n    this.unfocus();\r\n\r\n    // We need to make this check because dynamic\r\n    // lists such as in the search results list may fail\r\n    if (item !== undefined) {\r\n      item.focused = true;\r\n    }\r\n  }\r\n\r\n  unfocus() {\r\n    if (this.focusedItem !== undefined) {\r\n      this.focusedItem.focused = false;\r\n    }\r\n\r\n    this.focusedItem = undefined;\r\n  }\r\n\r\n  focusNext() {\r\n    const items = this.listItems.toArray();\r\n    let item;\r\n    let disabled = true;\r\n    let index = this.getFocusedIndex();\r\n    if (index === undefined) {\r\n      index = -1;\r\n    }\r\n\r\n    while (disabled && index < items.length - 1) {\r\n      index += 1;\r\n      item = items[index];\r\n      disabled = item.disabled;\r\n    }\r\n\r\n    if (item !== undefined) {\r\n      this.focus(item);\r\n    }\r\n  }\r\n\r\n  focusPrevious() {\r\n    const items = this.listItems.toArray();\r\n    let item;\r\n    let disabled = true;\r\n    let index = this.getFocusedIndex();\r\n\r\n    while (disabled && index > 0) {\r\n      index -= 1;\r\n      item = items[index];\r\n      disabled = item.disabled;\r\n    }\r\n\r\n    if (item !== undefined) {\r\n      this.focus(item);\r\n    }\r\n  }\r\n\r\n  select(item?: ListItemDirective) {\r\n    if (!this.selection) {\r\n      return;\r\n    }\r\n\r\n    this.unselect();\r\n\r\n    if (item !== undefined) {\r\n      item.selected = true;\r\n    }\r\n  }\r\n\r\n  unselect() {\r\n    this.unfocus();\r\n\r\n    if (this.selectedItem !== undefined) {\r\n      this.selectedItem.selected = false;\r\n    }\r\n\r\n    this.selectedItem = undefined;\r\n  }\r\n\r\n  enableNavigation() {\r\n    if (this.navigation) {\r\n      this.navigationEnabled = true;\r\n    }\r\n  }\r\n\r\n  disableNavigation() {\r\n    this.navigationEnabled = false;\r\n  }\r\n\r\n  scrollToItem(item: ListItemDirective) {\r\n    this.el.nativeElement.scrollTop = item.getOffsetTop();\r\n  }\r\n\r\n  private init() {\r\n    this.subscribe();\r\n\r\n    this.selectedItem = this.findSelectedItem();\r\n    this.focusedItem = this.findFocusedItem();\r\n\r\n    this.enableNavigation();\r\n  }\r\n\r\n  private subscribe() {\r\n    this.unsubscribe();\r\n\r\n    this.listItems.toArray().forEach(item => {\r\n      this.subscriptions.push(\r\n        item.beforeSelect.subscribe((item2: ListItemDirective) =>\r\n          this.handleItemBeforeSelect(item2)\r\n        )\r\n      );\r\n\r\n      this.subscriptions.push(\r\n        item.select.subscribe((item2: ListItemDirective) =>\r\n          this.handleItemSelect(item2)\r\n        )\r\n      );\r\n\r\n      this.subscriptions.push(\r\n        item.beforeFocus.subscribe((item2: ListItemDirective) =>\r\n          this.handleItemBeforeFocus(item2)\r\n        )\r\n      );\r\n\r\n      this.subscriptions.push(\r\n        item.focus.subscribe((item2: ListItemDirective) =>\r\n          this.handleItemFocus(item2)\r\n        )\r\n      );\r\n    }, this);\r\n  }\r\n\r\n  private unsubscribe() {\r\n    this.subscriptions.forEach((sub: Subscription) => sub.unsubscribe());\r\n    this.subscriptions = [];\r\n  }\r\n\r\n  private handleItemBeforeFocus(item: ListItemDirective) {\r\n    if (item !== this.focusedItem) {\r\n      this.unselect();\r\n    }\r\n  }\r\n\r\n  private handleItemFocus(item: ListItemDirective) {\r\n    this.focusedItem = item;\r\n  }\r\n\r\n  private handleItemBeforeSelect(item: ListItemDirective) {\r\n    if (item !== this.focusedItem) {\r\n      this.unselect();\r\n    }\r\n  }\r\n\r\n  private handleItemSelect(item: ListItemDirective) {\r\n    this.selectedItem = item;\r\n  }\r\n\r\n  private findSelectedItem() {\r\n    return this.listItems.toArray().find(item => item.selected);\r\n  }\r\n\r\n  private findFocusedItem() {\r\n    return this.listItems.toArray().find(item => item.focused);\r\n  }\r\n\r\n  private getFocusedIndex() {\r\n    return this.listItems\r\n      .toArray()\r\n      .findIndex(item => item === this.focusedItem);\r\n  }\r\n\r\n  private navigate(key: number) {\r\n    switch (key) {\r\n      case 38:\r\n        this.focusPrevious();\r\n        break;\r\n      case 40:\r\n        this.focusNext();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatIconModule, MatListModule } from '@angular/material';\r\n\r\nimport { IgoClickoutModule } from '../clickout/clickout.module';\r\n\r\nimport { ListItemDirective } from './list-item.directive';\r\nimport { ListComponent } from './list.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, MatIconModule, MatListModule, IgoClickoutModule],\r\n  declarations: [ListItemDirective, ListComponent],\r\n  exports: [ListItemDirective, ListComponent]\r\n})\r\nexport class IgoListModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoListModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  ChangeDetectionStrategy,\r\n  HostBinding\r\n} from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'igo-panel',\r\n  templateUrl: './panel.component.html',\r\n  styleUrls: ['./panel.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class PanelComponent {\r\n\r\n  @Input()\r\n  get title() {\r\n    return this._title;\r\n  }\r\n  set title(value: string) {\r\n    this._title = value;\r\n  }\r\n  private _title: string;\r\n\r\n  @Input()\r\n  @HostBinding('class.igo-panel-with-header')\r\n  get withHeader(): boolean {\r\n    return this._withHeader;\r\n  }\r\n  set withHeader(value: boolean) {\r\n    this._withHeader = value;\r\n  }\r\n  private _withHeader = true;\r\n\r\n  constructor() {}\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { PanelComponent } from './panel.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [\r\n    PanelComponent\r\n  ],\r\n  declarations: [\r\n    PanelComponent\r\n  ]\r\n})\r\nexport class IgoPanelModule {}\r\n","import { Directive, Self, HostListener, Renderer2 } from '@angular/core';\r\nimport { MatSidenav } from '@angular/material';\r\n\r\n/**\r\n * <igoSidenavShim> directive.\r\n *\r\n * This directive prevents a material sidenav with mode=\"side\"\r\n * from focusing an element after it's closed\r\n */\r\n@Directive({\r\n  selector: '[igoSidenavShim]'\r\n})\r\nexport class SidenavShimDirective {\r\n  private focusedElement: HTMLElement;\r\n  private blurElement: HTMLElement;\r\n\r\n  @HostListener('open', ['$event'])\r\n  onOpen() {\r\n    this.focusedElement = document.activeElement as HTMLElement;\r\n  }\r\n\r\n  @HostListener('close-start', ['$event'])\r\n  onCloseStart() {\r\n    const focusedElement = document.activeElement as HTMLElement;\r\n    if (focusedElement !== this.focusedElement) {\r\n      this.blurElement = this.focusedElement;\r\n    } else {\r\n      this.blurElement = undefined;\r\n    }\r\n  }\r\n\r\n  @HostListener('close', ['$event'])\r\n  onClose() {\r\n    if (this.blurElement) {\r\n      this.renderer.selectRootElement(this.blurElement).blur();\r\n    }\r\n\r\n    this.blurElement = undefined;\r\n    this.focusedElement = undefined;\r\n  }\r\n\r\n  constructor(@Self() component: MatSidenav, private renderer: Renderer2) {}\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { SidenavShimDirective } from './sidenav-shim.directive';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [SidenavShimDirective],\r\n  exports: [SidenavShimDirective]\r\n})\r\nexport class IgoSidenavModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoSidenavModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\n\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'igo-spinner',\r\n  templateUrl: './spinner.component.html',\r\n  styleUrls: ['./spinner.component.scss']\r\n})\r\nexport class SpinnerComponent {\r\n\r\n  public shown$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n\r\n  @Input()\r\n  set shown(value: boolean) { this.shown$.next(value); }\r\n  get shown(): boolean { return this.shown$.value; }\r\n\r\n  constructor() {}\r\n\r\n  show() {\r\n    this.shown = true;\r\n  }\r\n\r\n  hide() {\r\n    this.shown = false;\r\n  }\r\n}\r\n","import { Directive, Self, OnInit, OnDestroy } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime } from 'rxjs/operators';\r\n\r\nimport { ActivityService } from '@igo2/core';\r\nimport { SpinnerComponent } from './spinner.component';\r\n\r\n/**\r\n * A directive to bind a SpinnerComponent to the activity service.\r\n * The activity service tracks any HTTP request and this directive\r\n * will display the spinner it's attached to when the activity counter\r\n * is greater than 0.\r\n */\r\n@Directive({\r\n  selector: '[igoSpinnerActivity]',\r\n  providers: [SpinnerComponent]\r\n})\r\nexport class SpinnerActivityDirective implements OnInit, OnDestroy {\r\n  /**\r\n   * Subscription to the activity service counter\r\n   */\r\n  private counter$$: Subscription;\r\n\r\n  constructor(\r\n    @Self() private spinner: SpinnerComponent,\r\n    private activityService: ActivityService\r\n  ) {}\r\n\r\n  /**\r\n   * Subscribe to the activity service counter and display the spinner\r\n   * when it's is greater than 0.\r\n   * @internal\r\n   */\r\n  ngOnInit() {\r\n    this.counter$$ = this.activityService.counter$\r\n      .pipe(debounceTime(50))\r\n      .subscribe((count: number) => {\r\n        count > 0 ? this.spinner.show() : this.spinner.hide();\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Unsubcribe to the activity service counter.\r\n   * @internal\r\n   */\r\n  ngOnDestroy() {\r\n    this.counter$$.unsubscribe();\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatProgressSpinnerModule } from '@angular/material';\r\n\r\nimport { SpinnerActivityDirective } from './spinner-activity.directive';\r\nimport { SpinnerComponent } from './spinner.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, MatProgressSpinnerModule],\r\n  declarations: [SpinnerActivityDirective, SpinnerComponent],\r\n  exports: [SpinnerActivityDirective, SpinnerComponent]\r\n})\r\nexport class IgoSpinnerModule {}\r\n","import { DataSource } from '@angular/cdk/table';\r\nimport { MatSort } from '@angular/material';\r\n\r\nimport { Observable, BehaviorSubject, merge } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { ObjectUtils } from '@igo2/utils';\r\n\r\nimport { TableDatabase, TableModel } from './index';\r\n\r\nexport class TableDataSource extends DataSource<any> {\r\n  get filter(): string {\r\n    return this._filterChange.value;\r\n  }\r\n  set filter(filter: string) {\r\n    this._filterChange.next(filter);\r\n  }\r\n  private _filterChange = new BehaviorSubject('');\r\n\r\n  constructor(\r\n    private _database: TableDatabase,\r\n    private _model: TableModel,\r\n    private _sort: MatSort\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  // Connect function called by the table to retrieve one stream containing\r\n  // the data to render.\r\n  connect(): Observable<any[]> {\r\n    if (!this._database) {\r\n      return merge([]);\r\n    }\r\n    const displayDataChanges = [\r\n      this._database.dataChange,\r\n      this._filterChange,\r\n      this._sort.sortChange\r\n    ];\r\n\r\n    return merge(...displayDataChanges).pipe(\r\n      map(() => {\r\n        return this.getFilteredData(this._database.data);\r\n      }),\r\n      map(data => {\r\n        return this.getSortedData(data);\r\n      })\r\n    );\r\n  }\r\n\r\n  disconnect() {}\r\n\r\n  getFilteredData(data): any[] {\r\n    if (!this.filter) {\r\n      return data;\r\n    }\r\n    return data.slice().filter((item: any) => {\r\n      const searchStr: string = this._model.columns\r\n        .filter(c => c.filterable)\r\n        .map(c => ObjectUtils.resolve(item, c.name))\r\n        .join(' ')\r\n        .toLowerCase();\r\n\r\n      return searchStr.indexOf(this.filter.toLowerCase()) !== -1;\r\n    });\r\n  }\r\n\r\n  getSortedData(data): any[] {\r\n    if (!this._sort.active || this._sort.direction === '') {\r\n      return data;\r\n    }\r\n\r\n    return data.sort((a, b) => {\r\n      const propertyA: number | string = ObjectUtils.resolve(\r\n        a,\r\n        this._sort.active\r\n      );\r\n      const propertyB: number | string = ObjectUtils.resolve(\r\n        b,\r\n        this._sort.active\r\n      );\r\n\r\n      return ObjectUtils.naturalCompare(\r\n        propertyB,\r\n        propertyA,\r\n        this._sort.direction\r\n      );\r\n    });\r\n  }\r\n}\r\n","export enum TableActionColor {\r\n  primary,\r\n  accent,\r\n  warn\r\n}\r\n","import {\r\n  Component,\r\n  ElementRef,\r\n  ViewChild,\r\n  Input,\r\n  Output,\r\n  OnChanges,\r\n  OnInit,\r\n  AfterViewInit,\r\n  EventEmitter\r\n} from '@angular/core';\r\nimport { MatSort } from '@angular/material';\r\nimport { SelectionModel } from '@angular/cdk/collections';\r\n\r\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\r\nimport { fromEvent } from 'rxjs';\r\n\r\nimport { ObjectUtils } from '@igo2/utils';\r\n\r\nimport { TableModel } from './table-model.interface';\r\nimport { TableDatabase } from './table-database';\r\nimport { TableDataSource } from './table-datasource';\r\nimport { TableActionColor } from './table-action-color.enum';\r\n\r\n@Component({\r\n  selector: 'igo-table',\r\n  templateUrl: './table.component.html',\r\n  styleUrls: ['./table.component.scss']\r\n})\r\nexport class TableComponent implements OnChanges, OnInit, AfterViewInit {\r\n  @Input()\r\n  get database(): TableDatabase {\r\n    return this._database;\r\n  }\r\n  set database(value: TableDatabase) {\r\n    this._database = value;\r\n  }\r\n  private _database: TableDatabase;\r\n\r\n  @Input()\r\n  get model(): TableModel {\r\n    return this._model;\r\n  }\r\n  set model(value: TableModel) {\r\n    this._model = value;\r\n  }\r\n  private _model: TableModel;\r\n\r\n  @Input()\r\n  get hasFilterInput(): boolean {\r\n    return this._hasFIlterInput;\r\n  }\r\n  set hasFilterInput(value: boolean) {\r\n    this._hasFIlterInput = value;\r\n  }\r\n  private _hasFIlterInput = true;\r\n\r\n  public displayedColumns;\r\n  public dataSource: TableDataSource | null;\r\n  public selection = new SelectionModel<any>(true, []);\r\n\r\n  @Output()\r\n  select = new EventEmitter<{\r\n    added: any[];\r\n    removed: any[];\r\n    source: SelectionModel<any>;\r\n  }>();\r\n\r\n  @ViewChild('filter') filter: ElementRef;\r\n  @ViewChild(MatSort) sort: MatSort;\r\n\r\n  ngOnInit() {\r\n    this.dataSource = new TableDataSource(this.database, this.model, this.sort);\r\n\r\n    if (this.model) {\r\n      this.displayedColumns = this.model.columns\r\n        .filter(c => c.displayed !== false)\r\n        .map(c => c.name);\r\n\r\n      if (this.model.selectionCheckbox) {\r\n        this.displayedColumns.unshift('selectionCheckbox');\r\n      }\r\n      if (this.model.actions && this.model.actions.length) {\r\n        this.displayedColumns.push('action');\r\n      }\r\n    }\r\n\r\n    this.selection.changed.subscribe(e => this.select.emit(e));\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    if (this.filter) {\r\n      fromEvent(this.filter.nativeElement, 'keyup')\r\n        .pipe(\r\n          debounceTime(150),\r\n          distinctUntilChanged()\r\n        )\r\n        .subscribe(() => {\r\n          if (!this.dataSource) {\r\n            return;\r\n          }\r\n          this.dataSource.filter = this.filter.nativeElement.value;\r\n        });\r\n    }\r\n  }\r\n\r\n  ngOnChanges(change) {\r\n    if (change.database) {\r\n      this.dataSource = new TableDataSource(\r\n        this.database,\r\n        this.model,\r\n        this.sort\r\n      );\r\n      this.selection.clear();\r\n    }\r\n  }\r\n\r\n  getActionColor(colorId: number): string {\r\n    return TableActionColor[colorId];\r\n  }\r\n\r\n  getValue(row, key) {\r\n    return ObjectUtils.resolve(row, key);\r\n  }\r\n\r\n  /** Whether the number of selected elements matches the total number of rows. */\r\n  isAllSelected() {\r\n    const numSelected = this.selection.selected.length;\r\n    const numRows = this.database.data.length;\r\n    return numSelected === numRows;\r\n  }\r\n\r\n  /** Selects all rows if they are not all selected; otherwise clear selection. */\r\n  masterToggle() {\r\n    this.isAllSelected()\r\n      ? this.selection.clear()\r\n      : this.database.data.forEach(row => this.selection.select(row));\r\n  }\r\n\r\n  handleClickAction(event, action, row) {\r\n    event.stopPropagation();\r\n    action.click(row);\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { CdkTableModule } from '@angular/cdk/table';\r\nimport {\r\n  MatIconModule,\r\n  MatButtonModule,\r\n  MatTableModule,\r\n  MatFormFieldModule,\r\n  MatInputModule,\r\n  MatSortModule,\r\n  MatCheckboxModule\r\n} from '@angular/material';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\n\r\nimport { TableComponent } from './table.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    CdkTableModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    MatTableModule,\r\n    MatFormFieldModule,\r\n    MatInputModule,\r\n    MatSortModule,\r\n    MatCheckboxModule,\r\n    IgoLanguageModule\r\n  ],\r\n  declarations: [TableComponent],\r\n  exports: [TableComponent]\r\n})\r\nexport class IgoTableModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoTableModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\nimport { Tool } from './tool.interface';\r\n\r\n/**\r\n * Service where runtime tool configurations are registered\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ToolService {\r\n\r\n  static tools: {[key: string]: Tool} = {};\r\n\r\n  static register(tool: Tool) {\r\n    ToolService.tools[tool.name] = tool;\r\n  }\r\n\r\n  constructor() {}\r\n\r\n  /**\r\n   * Return a tool\r\n   * @param name Tool name\r\n   * @returns tool Tool\r\n   */\r\n  getTool(name: string): Tool {\r\n    return ToolService.tools[name];\r\n  }\r\n\r\n  /**\r\n   * Return all tools\r\n   * @returns tTols\r\n   */\r\n  getTools(): Tool[] {\r\n    return Object.values(ToolService.tools);\r\n  }\r\n\r\n}\r\n","import { EntityStore } from '../../entity';\r\nimport { Action } from './action.interfaces';\r\n\r\n/**\r\n * The class is a specialized version of an EntityStore that stores\r\n * actions.\r\n */\r\nexport class ActionStore extends EntityStore<Action> {\r\n\r\n  /**\r\n   * Update actions availability. That means disabling or enabling some\r\n   * actions based on the conditions they define.\r\n   */\r\n  updateActionsAvailability() {\r\n    const availables = [];\r\n    const unavailables = [];\r\n\r\n    this.entities$.value.forEach((action: Action) => {\r\n      const conditions = action.conditions || [];\r\n      const args = action.conditionArgs || [];\r\n      const available = conditions.every((condition: (...args: any[]) => boolean) => {\r\n        return condition(...args);\r\n      });\r\n      available ? availables.push(action) : unavailables.push(action);\r\n    });\r\n\r\n    if (unavailables.length > 0) {\r\n      this.state.updateMany(unavailables, {\r\n        disabled: true,\r\n        active: false\r\n      });\r\n    }\r\n\r\n    if (availables.length > 0) {\r\n      this.state.updateMany(availables, {\r\n        disabled: false\r\n      });\r\n    }\r\n  }\r\n\r\n}\r\n","import {\r\n  trigger,\r\n  state,\r\n  style,\r\n  transition,\r\n  animate,\r\n  AnimationTriggerMetadata\r\n} from '@angular/animations';\r\n\r\nexport function toolSlideInOut(\r\n  speed = '300ms',\r\n  type = 'ease-in-out'\r\n): AnimationTriggerMetadata {\r\n  return trigger('toolSlideInOut', [\r\n    state(\r\n      'enter',\r\n      style({\r\n        transform: 'translate3d(0, 0, 0)'\r\n      })\r\n    ),\r\n    transition('void => enter', animate(speed + ' ' + type))\r\n  ]);\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\n\r\nimport { Subscription, BehaviorSubject } from 'rxjs';\r\n\r\nimport { Action, ActionStore } from '../../action';\r\nimport { Tool } from '../shared/tool.interface';\r\nimport { Toolbox } from '../shared/toolbox';\r\nimport { toolSlideInOut } from './toolbox.animation';\r\n\r\n@Component({\r\n  selector: 'igo-toolbox',\r\n  templateUrl: 'toolbox.component.html',\r\n  styleUrls: ['toolbox.component.scss'],\r\n  animations: [toolSlideInOut()],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ToolboxComponent implements OnInit, OnDestroy {\r\n  /**\r\n   * Observable of the active tool\r\n   */\r\n  activeTool$: BehaviorSubject<Tool> = new BehaviorSubject(undefined);\r\n\r\n  /**\r\n   * Store of actions that toggle tools\r\n   */\r\n  actionStore: ActionStore = new ActionStore([]);\r\n\r\n  /**\r\n   * Observable of he anmation state\r\n   */\r\n  animation$: BehaviorSubject<string> = new BehaviorSubject('none');\r\n\r\n  /**\r\n   * Observable of the toolbar\r\n   */\r\n  toolbar$: BehaviorSubject<string[]> = new BehaviorSubject([]);\r\n\r\n  /**\r\n   * Subscription to the active tool\r\n   */\r\n  private activeTool$$: Subscription;\r\n\r\n  /**\r\n   * Subscription to the toolbar\r\n   */\r\n  private toolbar$$: Subscription;\r\n\r\n  /**\r\n   * Observable of the ongoing animation. This is useful when\r\n   * multiple animations are triggered at once i.e. when the user clicks\r\n   * too fast on different actions\r\n   */\r\n  private animating$ = new BehaviorSubject<boolean>(false);\r\n\r\n  /**\r\n   * Subscription to the ongoing animation\r\n   */\r\n  private animating$$: Subscription;\r\n\r\n  /**\r\n   * Toolbox\r\n   */\r\n  @Input() toolbox: Toolbox;\r\n\r\n  /**\r\n   * Whether the toolbox should animate the first tool entering\r\n   */\r\n  @Input() animate: boolean = false;\r\n\r\n  /**\r\n   * Whether the Toolbar should display actions' titles\r\n   */\r\n  get toolbarWithTitle(): boolean {\r\n    return this.activeTool$.value === undefined;\r\n  }\r\n\r\n  /**\r\n   * Initialize the toolbar and subscribe to the active tool\r\n   * @internal\r\n   */\r\n  ngOnInit() {\r\n    this.toolbar$$ = this.toolbox.toolbar$.subscribe((toolbar: string[]) =>\r\n      this.onToolbarChange(toolbar)\r\n    );\r\n    this.activeTool$$ = this.toolbox.activeTool$.subscribe((tool: Tool) =>\r\n      this.onActiveToolChange(tool)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Unsubscribe to the active tool and destroy the action store\r\n   * @internal\r\n   */\r\n  ngOnDestroy() {\r\n    this.toolbar$$.unsubscribe();\r\n    this.activeTool$$.unsubscribe();\r\n    this.actionStore.destroy();\r\n  }\r\n\r\n  /**\r\n   * Track the starting animation\r\n   * @internal\r\n   */\r\n  onAnimationStart() {\r\n    this.animating$.next(true);\r\n  }\r\n\r\n  /**\r\n   * Untrack the completed animation\r\n   * @internal\r\n   */\r\n  onAnimationComplete() {\r\n    this.animating$.next(false);\r\n  }\r\n\r\n  /**\r\n   * Return a tool's inputs\r\n   * @param tool Tool\r\n   * @returns Tool inputs\r\n   * @internal\r\n   */\r\n  getToolInputs(tool: Tool): { [key: string]: any } {\r\n    return tool.options || {};\r\n  }\r\n\r\n  /**\r\n   * Get Action bar item class function\r\n   * @internal\r\n   */\r\n  get actionBarItemClassFunc() {\r\n    return (tool: Tool) => {\r\n      if (!this.toolbox.activeTool$.value) {\r\n        return;\r\n      }\r\n      return { 'tool-actived': tool.id === this.toolbox.activeTool$.value.name };\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Initialize an action store\r\n   * @param toolbar Toolbar\r\n   */\r\n  private onToolbarChange(toolbar: string[]) {\r\n    this.setToolbar(toolbar);\r\n  }\r\n\r\n  /**\r\n   * Activate a tool and trigger an animation or not\r\n   * @param tool Tool to activate\r\n   */\r\n  private onActiveToolChange(tool: Tool) {\r\n    if (!this.animate) {\r\n      this.setActiveTool(tool);\r\n      return;\r\n    }\r\n    this.onAnimate(() => this.setActiveTool(tool));\r\n  }\r\n\r\n  /**\r\n   * Set the active tool\r\n   * @param tool Tool to activate\r\n   */\r\n  private setActiveTool(tool: Tool | undefined) {\r\n    if (tool === undefined) {\r\n      this.actionStore.state.updateAll({ active: false });\r\n    } else {\r\n      const action = this.actionStore.get(tool.name);\r\n      if (action !== undefined) {\r\n        this.actionStore.state.update(action, { active: true }, true);\r\n      }\r\n    }\r\n\r\n    this.activeTool$.next(tool);\r\n    if (this.animate) {\r\n      this.animation$.next('enter');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize the toolbar\r\n   */\r\n  private setToolbar(toolbar: string[]) {\r\n    const actions = toolbar.reduce((acc: Action[], toolName: string) => {\r\n      const tool = this.toolbox.getTool(toolName);\r\n      if (tool === undefined) {\r\n        return acc;\r\n      }\r\n\r\n      acc.push({\r\n        id: tool.name,\r\n        title: tool.title,\r\n        icon: tool.icon,\r\n        // iconImage: tool.iconImage,\r\n        tooltip: tool.tooltip,\r\n        args: [tool, this.toolbox],\r\n        handler: (_tool: Tool, _toolbox: Toolbox) => {\r\n          _toolbox.activateTool(_tool.name);\r\n        }\r\n      });\r\n      return acc;\r\n    }, []);\r\n    this.actionStore.load(actions);\r\n    this.toolbar$.next(toolbar);\r\n  }\r\n\r\n  /**\r\n   * Observe the ongoing animation and ignore any incoming animation\r\n   * while one is still ongoing.\r\n   * @param callback Callback to execute when the animation completes\r\n   */\r\n  private onAnimate(callback: () => void) {\r\n    this.unAnimate();\r\n    this.animating$$ = this.animating$.subscribe((animation: boolean) => {\r\n      if (!animation) {\r\n        callback.call(this);\r\n        this.unAnimate();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Stop observing an animation when it's complete\r\n   */\r\n  private unAnimate() {\r\n    if (this.animating$$) {\r\n      this.animating$$.unsubscribe();\r\n    }\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoActionModule } from '../../action/action.module';\r\nimport {\r\n    IgoDynamicComponentModule\r\n} from '../../dynamic-component/dynamic-component.module';\r\n\r\nimport { ToolboxComponent } from './toolbox.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoActionModule,\r\n    IgoDynamicComponentModule\r\n  ],\r\n  exports: [\r\n    ToolboxComponent\r\n  ],\r\n  declarations: [\r\n    ToolboxComponent\r\n  ]\r\n})\r\nexport class IgoToolboxModule {}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { ToolService } from './shared/tool.service';\r\nimport { IgoToolboxModule } from './toolbox/toolbox.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [\r\n    IgoToolboxModule\r\n  ],\r\n  declarations: []\r\n})\r\nexport class IgoToolModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: IgoToolModule,\r\n      providers: [\r\n        ToolService\r\n      ]\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy,\r\n  OnDestroy\r\n} from '@angular/core';\r\n\r\nimport { DynamicComponent } from '../../dynamic-component';\r\n\r\nimport { WidgetComponent } from '../shared/widget.interfaces';\r\n\r\n/**\r\n * This component dynamically renders a widget. It also subscribes\r\n * to the widget's 'cancel' and 'complete' events and destroys it\r\n * when any of those event is emitted.\r\n */\r\n@Component({\r\n  selector: 'igo-widget-outlet',\r\n  templateUrl: './widget-outlet.component.html',\r\n  styleUrls: ['./widget-outlet.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class WidgetOutletComponent implements OnDestroy {\r\n\r\n  /**\r\n   * Widget subscribers to 'cancel' and 'complete'\r\n   * @internal\r\n   */\r\n  private baseSubscribers = {\r\n    cancel: (event: any) => this.onCancel(event),\r\n    complete: (event: any) => this.onComplete(event)\r\n  };\r\n\r\n  /**\r\n   * Widget\r\n   */\r\n  @Input() widget: DynamicComponent<WidgetComponent>;\r\n\r\n  /**\r\n   * Widget inputs\r\n   */\r\n  @Input() inputs: {[key: string]: any};\r\n\r\n  /**\r\n   * Widget subscribers\r\n   */\r\n  @Input() subscribers: {[key: string]: (event: any) => void} = {};\r\n\r\n  /**\r\n   * Event emitted when the widget emits 'complete'\r\n   */\r\n  @Output() complete = new EventEmitter<any>();\r\n\r\n  /**\r\n   * Event emitted when the widget emits 'cancel'\r\n   */\r\n  @Output() cancel = new EventEmitter<any>();\r\n\r\n  constructor() {}\r\n\r\n  /**\r\n   * Destroy the current widget and all it's inner subscriptions\r\n   * @internal\r\n   */\r\n  ngOnDestroy() {\r\n    this.destroyWidget();\r\n  }\r\n\r\n  /**\r\n   * Get the effective subscribers. That means a combination of the base\r\n   * subscribers and any subscriber given as input.\r\n   * @returns Combined subscribers\r\n   * @internal\r\n   */\r\n  getEffectiveSubscribers(): {[key: string]: (event: any) => void} {\r\n    const subscribers = Object.assign({}, this.subscribers);\r\n\r\n    // Base subscribers\r\n    Object.keys(this.baseSubscribers).forEach((key: string) => {\r\n      const subscriber = subscribers[key];\r\n      const baseSubscriber = this.baseSubscribers[key];\r\n      if (subscriber !== undefined) {\r\n        subscribers[key] = (event: any) => {\r\n          subscriber(event);\r\n          baseSubscriber(event);\r\n        };\r\n      } else {\r\n        subscribers[key] = baseSubscriber;\r\n      }\r\n    });\r\n\r\n    return subscribers;\r\n  }\r\n\r\n  /**\r\n   * When the widget emits 'cancel', propagate that event and destroy\r\n   * the widget\r\n   */\r\n  private onCancel(event: any) {\r\n    this.cancel.emit(event);\r\n    this.destroyWidget();\r\n  }\r\n\r\n  /**\r\n   * When the widget emits 'complete', propagate that event and destroy\r\n   * the widget\r\n   */\r\n  private onComplete(event: any) {\r\n    this.complete.emit(event);\r\n    this.destroyWidget();\r\n  }\r\n\r\n  /**\r\n   * Destroy the current widget\r\n   */\r\n  private destroyWidget() {\r\n    if (this.widget !== undefined) {\r\n      this.widget.destroy();\r\n    }\r\n    this.widget = undefined;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport {\r\n  IgoDynamicComponentModule\r\n} from '../../dynamic-component/dynamic-component.module';\r\n\r\nimport { WidgetOutletComponent } from './widget-outlet.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoDynamicComponentModule\r\n  ],\r\n  exports: [\r\n    WidgetOutletComponent\r\n  ],\r\n  declarations: [\r\n    WidgetOutletComponent\r\n  ]\r\n})\r\nexport class IgoWidgetOutletModule {}\r\n","import { Injectable } from '@angular/core';\r\n\r\nimport { DynamicComponentService } from '../../dynamic-component/shared/dynamic-component.service';\r\n\r\nimport { Widget } from './widget';\r\nimport { WidgetComponent } from './widget.interfaces';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class WidgetService {\r\n\r\n  constructor(private dynamicComponentService: DynamicComponentService) {}\r\n\r\n  create(widgetCls: any): Widget {\r\n    return this.dynamicComponentService.create(widgetCls as WidgetComponent);\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoWidgetOutletModule } from './widget-outlet/widget-outlet.module';\r\nimport { WidgetService } from './shared/widget.service';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoWidgetOutletModule\r\n  ],\r\n  exports: [\r\n    IgoWidgetOutletModule\r\n  ],\r\n  declarations: [],\r\n  providers: [\r\n    WidgetService\r\n  ]\r\n})\r\nexport class IgoWidgetModule {}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\n\r\nimport { getEntityTitle } from '../../entity';\r\nimport { Workspace } from '../shared/workspace';\r\nimport { WorkspaceStore } from '../shared/store';\r\n\r\n/**\r\n * Drop list that activates the selected workspace emit an event.\r\n */\r\n@Component({\r\n  selector: 'igo-workspace-selector',\r\n  templateUrl: './workspace-selector.component.html',\r\n  styleUrls: ['./workspace-selector.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class WorkspaceSelectorComponent {\r\n\r\n  /**\r\n   * Store that holds the available workspaces.\r\n   */\r\n  @Input() store: WorkspaceStore;\r\n\r\n  /**\r\n   * Event emitted when an workspace is selected or unselected\r\n   */\r\n  @Output() selectedChange = new EventEmitter<{\r\n    selected: boolean;\r\n    value: Workspace;\r\n  }>();\r\n\r\n  /**\r\n   * @internal\r\n   */\r\n  getWorkspaceTitle(workspace: Workspace): string {\r\n    return getEntityTitle(workspace);\r\n  }\r\n\r\n  /**\r\n   * When an workspace is manually selected, select it into the\r\n   * store and emit an event.\r\n   * @internal\r\n   * @param event The selection change event\r\n   */\r\n  onSelectedChange(event: {value: Workspace}) {\r\n    const workspace = event.value;\r\n    this.store.activateWorkspace(workspace);\r\n    this.selectedChange.emit({selected: true, value: workspace});\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoEntitySelectorModule } from '../../entity/entity-selector/entity-selector.module';\r\nimport { WorkspaceSelectorComponent } from './workspace-selector.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoEntitySelectorModule\r\n  ],\r\n  exports: [\r\n    WorkspaceSelectorComponent\r\n  ],\r\n  declarations: [\r\n    WorkspaceSelectorComponent\r\n  ]\r\n})\r\nexport class IgoWorkspaceSelectorModule {}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\n\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport { Widget } from '../../widget';\r\nimport { Workspace } from '../shared/workspace';\r\n\r\n/**\r\n * This component dynamically render an Workspace's active widget.\r\n * It also deactivate that widget whenever the widget's component\r\n * emit the 'cancel' or 'complete' event.\r\n */\r\n@Component({\r\n  selector: 'igo-workspace-widget-outlet',\r\n  templateUrl: './workspace-widget-outlet.component.html',\r\n  styleUrls: ['./workspace-widget-outlet.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class WorkspaceWidgetOutletComponent {\r\n\r\n  /**\r\n   * Workspace\r\n   */\r\n  @Input() workspace: Workspace;\r\n\r\n  /**\r\n   * Event emitted when a widget is deactivate which happens\r\n   * when the widget's component emits the 'cancel' or 'complete' event.\r\n   */\r\n  @Output() deactivateWidget = new EventEmitter<Widget>();\r\n\r\n  /**\r\n   * Observable of the workspace's active widget\r\n   * @internal\r\n   */\r\n  get widget$(): BehaviorSubject<Widget> { return this.workspace.widget$; }\r\n\r\n  /**\r\n   * Observable of the workspace's widget inputs\r\n   * @internal\r\n   */\r\n  get widgetInputs$(): BehaviorSubject<{[key: string]: any}> {\r\n    return this.workspace.widgetInputs$;\r\n  }\r\n\r\n  /**\r\n   * Observable of the workspace's widget inputs\r\n   * @internal\r\n   */\r\n  get widgetSubscribers$(): BehaviorSubject<{[key: string]: (event: any) => void}> {\r\n    return this.workspace.widgetSubscribers$;\r\n  }\r\n\r\n  constructor() {}\r\n\r\n  /**\r\n   * When a widget's component emit the 'cancel' event,\r\n   * deactivate that widget and emit the 'deactivateWidget' event.\r\n   * @param widget Widget\r\n   * @internal\r\n   */\r\n  onWidgetCancel(widget: Widget) {\r\n    this.workspace.deactivateWidget();\r\n    this.deactivateWidget.emit(widget);\r\n  }\r\n\r\n  /**\r\n   * When a widget's component emit the 'cancel' event,\r\n   * deactivate that widget and emit the 'deactivateWidget' event.\r\n   * @param widget Widget\r\n   * @internal\r\n   */\r\n  onWidgetComplete(widget: Widget) {\r\n    this.workspace.deactivateWidget();\r\n    this.deactivateWidget.emit(widget);\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoWidgetOutletModule } from '../../widget/widget-outlet/widget-outlet.module';\r\n\r\nimport { WorkspaceWidgetOutletComponent } from './workspace-widget-outlet.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    IgoWidgetOutletModule\r\n  ],\r\n  exports: [\r\n    WorkspaceWidgetOutletComponent\r\n  ],\r\n  declarations: [\r\n    WorkspaceWidgetOutletComponent\r\n  ]\r\n})\r\nexport class IgoWorkspaceWidgetOutletModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoWorkspaceSelectorModule } from './workspace-selector/workspace-selector.module';\r\nimport { IgoWorkspaceWidgetOutletModule } from './workspace-widget-outlet/workspace-widget-outlet.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [\r\n    IgoWorkspaceSelectorModule,\r\n    IgoWorkspaceWidgetOutletModule\r\n  ],\r\n  declarations: []\r\n})\r\nexport class IgoWorkspaceModule {}\r\n","import { BehaviorSubject } from 'rxjs';\r\n\r\nexport class TableDatabase {\r\n  /** Stream that emits whenever the data has been modified. */\r\n  dataChange: BehaviorSubject<any[]> = new BehaviorSubject<any[]>([]);\r\n  get data(): any[] {\r\n    return this.dataChange.value;\r\n  }\r\n\r\n  constructor(data?) {\r\n    if (data) {\r\n      this.dataChange.next(data);\r\n    }\r\n  }\r\n\r\n  set(data) {\r\n    this.dataChange.next(data);\r\n  }\r\n\r\n  add(item) {\r\n    const copiedData = this.data.slice();\r\n    copiedData.push(item);\r\n    this.set(copiedData);\r\n  }\r\n\r\n  remove(item) {\r\n    const copiedData = this.data.slice();\r\n    const index = copiedData.indexOf(item);\r\n    copiedData.splice(index, 1);\r\n    this.set(copiedData);\r\n  }\r\n}\r\n","import { EntityRecord, EntityStore } from '../../entity';\r\nimport { Tool, ToolboxOptions } from './tool.interface';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\n\r\n/**\r\n * Service where all available tools and their component are registered.\r\n */\r\nexport class Toolbox {\r\n  /**\r\n   * Observable of the active tool\r\n   */\r\n  activeTool$: BehaviorSubject<Tool> = new BehaviorSubject(undefined);\r\n\r\n  /**\r\n   * Ordered list of tool names to display in a toolbar\r\n   */\r\n  toolbar$: BehaviorSubject<string[]> = new BehaviorSubject([]);\r\n\r\n  /**\r\n   * Observable of the active tool\r\n   */\r\n  private activeTool$$: Subscription;\r\n\r\n  /**\r\n   * Active tool history. Useful for activating the previous tool.\r\n   */\r\n  private activeToolHistory: string[] = [];\r\n\r\n  /**\r\n   * Tool store\r\n   */\r\n  private store = new EntityStore<Tool>([], {\r\n    getKey: (tool: Tool) => tool.name\r\n  });\r\n\r\n  get tools$(): BehaviorSubject<Tool[]> {\r\n    return this.store.entities$;\r\n  }\r\n\r\n  constructor(private options: ToolboxOptions = {}) {\r\n    this.setToolbar(options.toolbar);\r\n    this.initStore();\r\n  }\r\n\r\n  /**\r\n   * Destroy the toolbox\r\n   */\r\n  destroy() {\r\n    this.activeTool$$.unsubscribe();\r\n    this.store.destroy();\r\n  }\r\n\r\n  /**\r\n   * Return a tool\r\n   * @param name Tool name\r\n   * @returns tool Tool\r\n   */\r\n  getTool(name: string): Tool {\r\n    return this.store.get(name);\r\n  }\r\n\r\n  /**\r\n   * Return all tools\r\n   * @returns Array of tools\r\n   */\r\n  getTools(): Tool[] {\r\n    return this.store.all();\r\n  }\r\n\r\n  /**\r\n   * Set tool configurations\r\n   * @param tools Tools\r\n   */\r\n  setTools(tools: Tool[]) {\r\n    this.store.load(tools);\r\n  }\r\n\r\n  /**\r\n   * Set toolbar\r\n   * @param toolbar A list of tool names\r\n   */\r\n  setToolbar(toolbar: string[]) {\r\n    this.toolbar$.next(toolbar || []);\r\n  }\r\n\r\n  /**\r\n   * Activate a tool (and deactivate other tools)\r\n   * @param name Tool name\r\n   * @param options Tool options\r\n   */\r\n  activateTool(name: string, options: { [key: string]: any } = {}) {\r\n    const tool = this.getTool(name);\r\n    if (tool === undefined) {\r\n      return;\r\n    }\r\n\r\n    this.store.state.update(tool, { active: true, options }, true);\r\n  }\r\n\r\n  /**\r\n   * Activate the previous tool, if any\r\n   */\r\n  activatePreviousTool() {\r\n    if (this.activeToolHistory.length <= 1) {\r\n      this.deactivateTool();\r\n      return;\r\n    }\r\n    const [previous, current] = this.activeToolHistory.splice(-2, 2);\r\n    this.activateTool(previous);\r\n  }\r\n\r\n  /**\r\n   * Deactivate the active tool\r\n   */\r\n  deactivateTool() {\r\n    this.clearActiveToolHistory();\r\n    this.store.state.updateAll({ active: false });\r\n  }\r\n\r\n  /**\r\n   * Initialize the tool store and start observing the active tool\r\n   */\r\n  private initStore() {\r\n    this.store = new EntityStore<Tool>([], {\r\n      getKey: (entity: Tool) => entity.name\r\n    });\r\n\r\n    this.activeTool$$ = this.store.stateView\r\n      .firstBy$((record: EntityRecord<Tool>) => record.state.active === true)\r\n      .subscribe((record: EntityRecord<Tool>) => {\r\n        if (record === undefined) {\r\n          this.setActiveTool(undefined);\r\n          return;\r\n        }\r\n\r\n        const tool = record.entity;\r\n        const options = Object.assign(\r\n          {},\r\n          tool.options || {},\r\n          record.state.options || {}\r\n        );\r\n        this.setActiveTool(Object.assign({}, tool, { options }));\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Set the active tool and update the tool history\r\n   * @param tool Tool\r\n   */\r\n  private setActiveTool(tool: Tool | undefined) {\r\n    this.activeTool$.next(tool);\r\n    if (tool === undefined) {\r\n      this.clearActiveToolHistory();\r\n    } else {\r\n      this.activeToolHistory = this.activeToolHistory\r\n        .filter((name: string) => name !== tool.name)\r\n        .concat([tool.name]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear the tool history\r\n   */\r\n  private clearActiveToolHistory() {\r\n    this.activeToolHistory = [];\r\n  }\r\n}\r\n","import { DynamicComponent } from '../../dynamic-component/shared/dynamic-component';\r\nimport { WidgetComponent } from './widget.interfaces';\r\n\r\nexport class Widget extends DynamicComponent<WidgetComponent> {}\r\n","import { EntityStore } from '../../entity';\r\nimport { Workspace } from './workspace';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n/**\r\n * The class is a specialized version of an EntityStore that stores\r\n * workspaces.\r\n */\r\nexport class WorkspaceStore extends EntityStore<Workspace> {\r\n\r\n  activeWorkspace$: BehaviorSubject<Workspace> = new BehaviorSubject(undefined);\r\n\r\n  /**\r\n   * Activate the an workspace workspace and deactivate the one currently active\r\n   * @param workspace Workspace\r\n   */\r\n  activateWorkspace(workspace: Workspace) {\r\n    const active = this.activeWorkspace$.value;\r\n    if (active !== undefined) {\r\n      active.deactivate();\r\n    }\r\n\r\n    this.deactivateWorkspace();\r\n    if (workspace !== undefined) {\r\n      this.state.update(workspace, {active: true, selected: true}, true);\r\n      this.activeWorkspace$.next(workspace);\r\n      workspace.activate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Deactivate the current workspace\r\n   * @param workspace Workspace\r\n   */\r\n  deactivateWorkspace() {\r\n    const active = this.activeWorkspace$.value;\r\n    if (active !== undefined) {\r\n      active.deactivate();\r\n      this.activeWorkspace$.next(undefined);\r\n    }\r\n  }\r\n\r\n}\r\n","import { Subscription, BehaviorSubject, Subject } from 'rxjs';\r\nimport { debounceTime } from 'rxjs/operators';\r\n\r\nimport { ActionStore } from '../../action';\r\nimport { Widget } from '../../widget';\r\nimport { EntityRecord, EntityStore } from '../../entity';\r\n\r\nimport { WorkspaceOptions } from './workspace.interfaces';\r\n\r\n/**\r\n * This class is responsible of managing the relations between\r\n * entities and the actions that consume them. It also defines an\r\n * entity table template that may be used by an entity table component.\r\n */\r\nexport class Workspace<E extends object = object> {\r\n\r\n  /**\r\n   * Observable of the selected widget\r\n   */\r\n  readonly widget$ = new BehaviorSubject<Widget>(undefined);\r\n\r\n  /**\r\n   * Observable of the selected widget's inputs\r\n   */\r\n  readonly widgetInputs$ = new BehaviorSubject<{[key: string]: any}>({});\r\n\r\n  /**\r\n   * Observable of the selected widget's subscribers\r\n   */\r\n  readonly widgetSubscribers$ = new BehaviorSubject<{[key: string]: (event: any) => void}>({});\r\n\r\n  /**\r\n   * Subscription to the selected entity\r\n   */\r\n  private entities$$: Subscription;\r\n\r\n  /**\r\n   * Whether this workspace is active\r\n   */\r\n  private active: boolean = false;\r\n\r\n  /**\r\n   * State change that trigger an update of the actions availability\r\n   */\r\n  private change: Subject<void> = new Subject();\r\n\r\n  /**\r\n   * Subscription to state changes\r\n   */\r\n  private change$: Subscription;\r\n\r\n  /**\r\n   * Workspace id\r\n   */\r\n  get id(): string { return this.options.id; }\r\n\r\n  /**\r\n   * Workspace title\r\n   */\r\n  get title(): string { return this.options.title; }\r\n\r\n  /**\r\n   * Workspace title\r\n   */\r\n  get meta(): {[key: string]: any} { return this.options.meta || {}; }\r\n\r\n  /**\r\n   * Entities store\r\n   */\r\n  get entityStore(): EntityStore<E> { return this.options.entityStore as EntityStore<E>; }\r\n\r\n  /**\r\n   * Actions store (some actions activate a widget)\r\n   */\r\n  get actionStore(): ActionStore { return this.options.actionStore; }\r\n\r\n  /**\r\n   * Selected widget\r\n   */\r\n  get widget(): Widget { return this.widget$.value; }\r\n\r\n  /**\r\n   * Whether a widget is selected\r\n   */\r\n  get hasWidget(): boolean { return this.widget !== undefined; }\r\n\r\n  constructor(protected options: WorkspaceOptions) {}\r\n\r\n  /**\r\n   * Whether this workspace is active\r\n   */\r\n  isActive(): boolean { return this.active; }\r\n\r\n  /**\r\n   * Activate the workspace. By doing that, the workspace will observe\r\n   * the selected entity (from the store) and update the actions availability.\r\n   * For example, some actions require an entity to be selected.\r\n   */\r\n  activate() {\r\n    if (this.active === true) {\r\n      this.deactivate();\r\n    }\r\n    this.active = true;\r\n\r\n    if (this.entityStore !== undefined) {\r\n      this.entities$$ = this.entityStore.stateView.all$()\r\n        .subscribe(() => this.onStateChange());\r\n    }\r\n\r\n    if (this.actionStore !== undefined) {\r\n      this.change$ = this.change\r\n        .pipe(debounceTime(35))\r\n        .subscribe(() => this.actionStore.updateActionsAvailability());\r\n    }\r\n\r\n    this.change.next();\r\n  }\r\n\r\n  /**\r\n   * Deactivate the workspace. Unsubcribe to the selected entity.\r\n   */\r\n  deactivate() {\r\n    this.active = false;\r\n    this.deactivateWidget();\r\n\r\n    if (this.entities$$ !== undefined) {\r\n      this.entities$$.unsubscribe();\r\n    }\r\n    if (this.change$ !== undefined) {\r\n      this.change$.unsubscribe();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Activate a widget. In itself, activating a widget doesn't render it but,\r\n   * if an WorkspaceWidgetOutlet component is bound to this workspace, the widget will\r\n   * show up.\r\n   * @param widget Widget\r\n   * @param inputs Inputs the widget will receive\r\n   */\r\n  activateWidget(\r\n    widget: Widget,\r\n    inputs: {[key: string]: any} = {},\r\n    subscribers: {[key: string]: (event: any) => void} = {}\r\n  ) {\r\n    this.widget$.next(widget);\r\n    this.widgetInputs$.next(inputs);\r\n    this.widgetSubscribers$.next(subscribers);\r\n    this.change.next();\r\n  }\r\n\r\n  /**\r\n   * Deactivate a widget.\r\n   */\r\n  deactivateWidget() {\r\n    this.widget$.next(undefined);\r\n    this.change.next();\r\n  }\r\n\r\n  /**\r\n   * When the state changes, update the actions availability.\r\n   */\r\n  private onStateChange() {\r\n    this.change.next();\r\n  }\r\n\r\n}\r\n","import { Tool } from './tool.interface';\r\nimport { ToolService } from './tool.service';\r\n\r\nexport function ToolComponent(tool: Partial<Tool>): (cls: any) => any {\r\n  return (compType: any) => {\r\n    ToolService.register(Object.assign({}, tool, {\r\n      component: compType\r\n    } as Tool));\r\n  };\r\n}\r\n"]}