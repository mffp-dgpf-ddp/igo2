!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("bowser"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@igo2/utils",["exports","bowser","rxjs","rxjs/operators"],t):t((e.igo2=e.igo2||{},e.igo2.utils={}),e.bowser,e.rxjs,e.rxjs.operators)}(this,function(e,s,t,i){"use strict";var n=(r.getByte=function(e,t){return e.charCodeAt(t)},r.getByte64=function(e,t){return this.ALPHA.indexOf(e.charAt(t))},r.decode=function(e){var t,n,r=0,i=e.length,s=[];if(e=String(e),0===i)return e;for(e.charAt(i-1)===this.PADCHAR&&(r=1,e.charAt(i-2)===this.PADCHAR&&(r=2),i-=4),t=0;t<i;t+=4)n=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6|this.getByte64(e,t+3),s.push(String.fromCharCode(n>>16,n>>8&255,255&n));switch(r){case 1:n=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6,s.push(String.fromCharCode(n>>16,n>>8&255));break;case 2:n=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12,s.push(String.fromCharCode(n>>16))}return s.join("")},r.encode=function(e){var t,n,r=[],i=(e=String(e)).length-e.length%3;if(0===e.length)return e;for(t=0;t<i;t+=3)n=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8|this.getByte(e,t+2),r.push(this.ALPHA.charAt(n>>18)),r.push(this.ALPHA.charAt(n>>12&63)),r.push(this.ALPHA.charAt(n>>6&63)),r.push(this.ALPHA.charAt(63&n));switch(e.length-i){case 1:n=this.getByte(e,t)<<16,r.push(this.ALPHA.charAt(n>>18)+this.ALPHA.charAt(n>>12&63)+this.PADCHAR+this.PADCHAR);break;case 2:n=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8,r.push(this.ALPHA.charAt(n>>18)+this.ALPHA.charAt(n>>12&63)+this.ALPHA.charAt(n>>6&63)+this.PADCHAR)}return r.join("")},r.PADCHAR="=",r.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r);function r(){}var o=(a.copy=function(e){var t=!1;if("string"==typeof e){var n=a.createTextArea(e);a.selectText(n),t=a.copyTextToClipboard(),a.destroyTextArea(n)}else a.selectText(e),t=a.copyTextToClipboard();return t},a.createTextArea=function(e){var t=document.createElement("textArea");return t.value=e,document.body.appendChild(t),t},a.destroyTextArea=function(e){document.body.removeChild(e)},a.selectText=function(e){if(s.ios){var t=e.contentEditable,n=e.readOnly,r=document.createRange(),i=window.getSelection();e.contenteditable=!0,e.readonly=!1,r.selectNodeContents(e),i.removeAllRanges(),i.addRange(r),e.setSelectionRange(0,999999),e.contentEditable=t,e.readOnly=n}else e.select()},a.copyTextToClipboard=function(){return!(s.ios&&s.version<10)&&document.execCommand("copy")},a);function a(){}function h(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function g(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(r=s.next()).done;)o.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=s["return"])&&n.call(s)}finally{if(i)throw i.error}}return o}function d(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}var f=(y.diff=function(e,t,n){if(void 0===n&&(n=4),!e&&!t)return"";if(!e)return'<span class="inserted">'+t+"</span>";if(!t)return'<span class="deleted">'+e+"</span>";e=e.toString(),t=t.toString();var r=y.getChanges(e,t,"",n),i=t.slice(r.mtc.length+r.ins.length+r.sbs.length),s=e.slice(r.mtc.length+r.del.length+r.sbs.length),o="";return 0<r.del.length&&(r.del='<span class="deleted">'+r.del+"</span>"),0<r.ins.length&&(r.ins='<span class="inserted">'+r.ins+"</span>"),o=r.mtc+r.del+r.ins+r.sbs,o+=""!==s||""!==i?y.diff(s,i,n):""},y.getMatchingSubstring=function(e,t,n){for(var r=0,i=!1,s=e.length,o={fis:s,mtc:n,sbs:""};r<s;)t[r]===e[r]?i?o.sbs+=e[r]:(i=!0,o.fis=r,o.sbs=e[r]):r=i?s:r,++r;return o},y.getChanges=function(e,t,n,r){for(var i,s=e.length>=e.length,o=g(s?[e,t]:[t,e],2),a=o[0],c=o[1],u=0;c[u]===a[u]&&u<c.length;)++u;a=a.split("").slice(u),c=c.slice(u);var f=a.length,l={fis:c.length,fil:f,sbs:"",mtc:n+t.slice(0,u)},h={sbs:""};if(""!==c)for(var d=0;d<f&&h.sbs.length<r;d++)(h=y.getMatchingSubstring(c,y.rotateArray(a,d),l.mtc)).fil=d<f-h.fis?h.fis+d:h.fis-f+d,h.sbs.length>l.sbs.length&&(l=h);return i=g(s?[a.slice(0,l.fil).join(""),c.slice(0,l.fis)]:[c.slice(0,l.fis),a.slice(0,l.fil).join("")],2),l.del=i[0],l.ins=i[1],-1===l.del.indexOf(" ")||-1===l.ins.indexOf(" ")||""===l.del||""===l.ins||""===l.sbs?l:y.getChanges(l.del,l.ins,l.mtc,r)},y.rotateArray=function(e,t){var n=e.length,r=new Array(e.length);if(t%n==0)return e.slice();for(var i=0;i<n;i++)r[i]=e[(i+(n+t%n))%n];return r},y);function y(){}var p={ADDED:"added",DELETED:"deleted",MODIFIED:"modified"},c=(b.findChanges=function(e,t,o){var n,r;void 0===o&&(o=[]);var a={added:[],deleted:[],modified:[]};if(!e||!t)return a;function i(t){var e=c.findIndex(function(e){return e.id===t.id});if(-1===e)return a.deleted.push({change:{type:p.DELETED},value:t}),"continue";var n=c.splice(e,1)[0],r=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(n)),s=b.compareObject(r,i,undefined,o);s.length&&a.modified.push({change:{type:p.MODIFIED,keysChanged:s},value:r,oldValue:t,newValue:n})}var s=d(e),c=d(t);try{for(var u=h(s),f=u.next();!f.done;f=u.next())i(f.value)}catch(l){n={error:l}}finally{try{f&&!f.done&&(r=u["return"])&&r.call(u)}finally{if(n)throw n.error}}return a.added=c.map(function(e){return{change:{type:p.ADDED},value:e}}),a},b.compareObject=function(n,r,i,s){var o=this;void 0===s&&(s=[]);var a=JSON.parse(JSON.stringify(n)),c=JSON.parse(JSON.stringify(r)),e=new Set(d(Object.keys(n),Object.keys(r))),u=[];return e.forEach(function(e){var t=i?i+"."+e:e;-1===s.indexOf(t)&&(Array.isArray(n[e])&&(n[e]=n[e].join(",<br>")),Array.isArray(r[e])&&(r[e]=r[e].join(",<br>")),"object"==typeof n[e]&&"object"==typeof r[e]&&null!==n[e]&&null!==r[e]?u=u.concat(o.compareObject(n[e],r[e],t)):n[e]!==r[e]&&(u.push({key:t,oldValue:a[e],newValue:c[e]}),n[e]=f.diff(n[e],r[e])))}),u},b);function b(){}var u=(l.resolve=function(e,t){for(var n=t.replace(/\[/g,".").replace(/\]/g,"").split("."),r=e;n.length;){if("object"!=typeof r)return undefined;r=r[n.shift()]}return r},l.isObject=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e&&!(e instanceof Date)},l.mergeDeep=function(r,i,s){void 0===s&&(s=!1);var o=Object.assign({},r);return l.isObject(r)&&l.isObject(i)&&Object.keys(i).filter(function(e){return!s||i[e]!==undefined}).forEach(function(e){var t,n;l.isObject(i[e])?e in r?o[e]=l.mergeDeep(r[e],i[e],s):Object.assign(o,((t={})[e]=i[e],t)):Object.assign(o,((n={})[e]=i[e],n))}),o},l.removeUndefined=function(t){var n={};return l.isObject(t)?(Object.keys(t).filter(function(e){return t[e]!==undefined}).forEach(function(e){l.isObject(t[e])||Array.isArray(t[e])?n[e]=l.removeUndefined(t[e]):n[e]=t[e]}),n):Array.isArray(t)?t.map(function(e){return l.removeUndefined(e)}):t},l.removeNull=function(t){var n={};return l.isObject(t)?(Object.keys(t).filter(function(e){return null!==t[e]}).forEach(function(e){l.isObject(t[e])||Array.isArray(t[e])?n[e]=l.removeNull(t[e]):n[e]=t[e]}),n):Array.isArray(t)?t.map(function(e){return l.removeNull(e)}):t},l.naturalCompare=function(e,t,n,r){if(void 0===n&&(n="asc"),void 0===r&&(r=!1),"desc"===n&&(t=[e,e=t][0]),e===undefined||null===e||""===e)return"desc"===n?r?-1:1:r?1:-1;if(t===undefined||null===t||""===t)return"desc"===n?r?1:-1:r?-1:1;var i=[],s=[];for(t=""+t,(e=""+e).replace(/(\d+)|(\D+)/g,function(e,t,n){i.push([t||Infinity,n||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,n){s.push([t||Infinity,n||""])});i.length&&s.length;){var o=i.shift(),a=s.shift(),c=o[0]-a[0]||o[1].localeCompare(a[1]);if(c)return c}return i.length-s.length},l.objectsAreEquivalent=function(e,t){var n,r;if(e===t)return!0;var i=Object.getOwnPropertyNames(e),s=Object.getOwnPropertyNames(t);if(i.length!==s.length)return!1;try{for(var o=h(i),a=o.next();!a.done;a=o.next()){var c=a.value;if(e[c]!==t[c])return!1}}catch(u){n={error:u}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(n)throw n.error}}return!0},l.removeKeys=function(n,t){return Object.keys(n).filter(function(e){return t.indexOf(e)<0}).reduce(function(e,t){return e[t]=n[t],e},{})},l);function l(){}function v(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var A={Error:0,Done:1,Working:2,Waiting:3};A[A.Error]="Error",A[A.Done]="Done",A[A.Working]="Working",A[A.Waiting]="Waiting";var m=(Object.defineProperty(j.prototype,"status",{get:function(){return this._status},set:function(e){this._status=e,this.status$.next(e)},enumerable:!0,configurable:!0}),j.prototype.subscribe=function(t,n){var r=this;this.watch(),this.status$$=this.status$.pipe(i.distinctUntilChanged()).subscribe(function(e){r.handleStatusChange(e),t.call(n,r)})},j.prototype.unsubscribe=function(){this.unwatch(),this.status$$!==undefined&&(this.status$$.unsubscribe(),this.status$$=undefined),this.status=A.Waiting},j.prototype.handleStatusChange=function(e){},j);function j(){this.status$=new t.Subject}e.Base64=n,e.Clipboard=o,e.ChangeUtils=c,e.ChangeType=p,e.ObjectUtils=u,e.strEnum=function O(e){return e.reduce(function(e,t){return e[t]=t,e},Object.create(null))},e.StringUtils=f,e.S4=v,e.uuid=function x(){return(""+v()+v()+"-"+v()+"-"+v()+"-"+v()+"-"+v()+v()+v()).toLowerCase()},e.SubjectStatus=A,e.Watcher=m,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=igo2-utils.umd.min.js.map